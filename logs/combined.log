{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-03 14:40:01"}
{"level":"info","message":"Database info: Starting a postgresql pool with 5 connections.","service":"payment-service","timestamp":"2025-03-03 14:40:01"}
{"level":"info","message":"Successfully connected to the database","service":"payment-service","timestamp":"2025-03-03 14:40:02"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-03 14:40:14"}
{"level":"info","message":"Database info: Starting a postgresql pool with 5 connections.","service":"payment-service","timestamp":"2025-03-03 14:40:14"}
{"level":"info","message":"Successfully connected to the database","service":"payment-service","timestamp":"2025-03-03 14:40:14"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-03 14:41:37"}
{"level":"info","message":"Database info: Starting a postgresql pool with 5 connections.","service":"payment-service","timestamp":"2025-03-03 14:41:37"}
{"level":"info","message":"Successfully connected to the database","service":"payment-service","timestamp":"2025-03-03 14:41:37"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-03 14:59:38"}
{"level":"info","message":"Database info: Starting a postgresql pool with 5 connections.","service":"payment-service","timestamp":"2025-03-03 14:59:38"}
{"level":"info","message":"Successfully connected to the database","service":"payment-service","timestamp":"2025-03-03 14:59:38"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-03 15:00:18"}
{"level":"info","message":"Database info: Starting a postgresql pool with 5 connections.","service":"payment-service","timestamp":"2025-03-03 15:00:19"}
{"level":"info","message":"Successfully connected to the database","service":"payment-service","timestamp":"2025-03-03 15:00:19"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-03 15:08:59"}
{"level":"info","message":"Database info: Starting a postgresql pool with 5 connections.","service":"payment-service","timestamp":"2025-03-03 15:08:59"}
{"level":"info","message":"Successfully connected to the database","service":"payment-service","timestamp":"2025-03-03 15:08:59"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-03 15:11:38"}
{"level":"info","message":"Database info: Starting a postgresql pool with 5 connections.","service":"payment-service","timestamp":"2025-03-03 15:11:38"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-03 15:11:57"}
{"level":"info","message":"Database info: Starting a postgresql pool with 5 connections.","service":"payment-service","timestamp":"2025-03-03 15:11:57"}
{"level":"info","message":"Successfully connected to the database","service":"payment-service","timestamp":"2025-03-03 15:11:58"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-03 15:12:10"}
{"level":"info","message":"Database info: Starting a postgresql pool with 5 connections.","service":"payment-service","timestamp":"2025-03-03 15:12:10"}
{"level":"info","message":"Successfully connected to the database","service":"payment-service","timestamp":"2025-03-03 15:12:10"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-04 14:28:45"}
{"level":"info","message":"Database info: Starting a postgresql pool with 5 connections.","service":"payment-service","timestamp":"2025-03-04 14:28:45"}
{"level":"info","message":"Successfully connected to the database","service":"payment-service","timestamp":"2025-03-04 14:28:46"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-04 14:28:54"}
{"level":"info","message":"Database info: Starting a postgresql pool with 5 connections.","service":"payment-service","timestamp":"2025-03-04 14:28:54"}
{"level":"info","message":"Successfully connected to the database","service":"payment-service","timestamp":"2025-03-04 14:28:55"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-04 14:28:57"}
{"level":"info","message":"Database info: Starting a postgresql pool with 5 connections.","service":"payment-service","timestamp":"2025-03-04 14:28:57"}
{"level":"info","message":"Successfully connected to the database","service":"payment-service","timestamp":"2025-03-04 14:28:57"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-04 14:29:05"}
{"level":"info","message":"Database info: Starting a postgresql pool with 5 connections.","service":"payment-service","timestamp":"2025-03-04 14:29:05"}
{"level":"info","message":"Successfully connected to the database","service":"payment-service","timestamp":"2025-03-04 14:29:05"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-04 14:30:02"}
{"level":"info","message":"Database info: Starting a postgresql pool with 5 connections.","service":"payment-service","timestamp":"2025-03-04 14:30:02"}
{"level":"info","message":"Successfully connected to the database","service":"payment-service","timestamp":"2025-03-04 14:30:02"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-04 15:06:57"}
{"level":"info","message":"Database info: Starting a postgresql pool with 5 connections.","service":"payment-service","timestamp":"2025-03-04 15:06:57"}
{"level":"info","message":"Successfully connected to the database","service":"payment-service","timestamp":"2025-03-04 15:06:58"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-04 15:07:30"}
{"level":"info","message":"Database info: Starting a postgresql pool with 5 connections.","service":"payment-service","timestamp":"2025-03-04 15:07:30"}
{"level":"info","message":"Successfully connected to the database","service":"payment-service","timestamp":"2025-03-04 15:07:31"}
{"eventId":"evt_3QyvEHDxY1cZtFZH0HNROhfA","level":"info","message":"Processing webhook event: charge.succeeded","service":"payment-service","timestamp":"2025-03-04 15:09:51"}
{"level":"info","message":"Charge succeeded: ch_3QyvEHDxY1cZtFZH0BCsKpKD","service":"payment-service","timestamp":"2025-03-04 15:09:51"}
{"level":"info","message":"::1 - - [04/Mar/2025:13:09:51 +0000] \"POST /api/webhooks/stripe HTTP/1.1\" 200 17 \"-\" \"Stripe/1.0 (+https://stripe.com/docs/webhooks)\"","service":"payment-service","timestamp":"2025-03-04 15:09:51"}
{"eventId":"evt_3QyvEHDxY1cZtFZH0H3ZVYIy","level":"info","message":"Processing webhook event: payment_intent.succeeded","service":"payment-service","timestamp":"2025-03-04 15:09:51"}
{"level":"info","message":"Payment intent succeeded: pi_3QyvEHDxY1cZtFZH0MdhM88N","service":"payment-service","timestamp":"2025-03-04 15:09:51"}
{"level":"info","message":"::1 - - [04/Mar/2025:13:09:51 +0000] \"POST /api/webhooks/stripe HTTP/1.1\" 200 17 \"-\" \"Stripe/1.0 (+https://stripe.com/docs/webhooks)\"","service":"payment-service","timestamp":"2025-03-04 15:09:51"}
{"eventId":"evt_3QyvEHDxY1cZtFZH0jLLJqwo","level":"info","message":"Processing webhook event: payment_intent.created","service":"payment-service","timestamp":"2025-03-04 15:09:51"}
{"level":"info","message":"Ignoring unhandled webhook event type: payment_intent.created","service":"payment-service","timestamp":"2025-03-04 15:09:51"}
{"level":"info","message":"::1 - - [04/Mar/2025:13:09:51 +0000] \"POST /api/webhooks/stripe HTTP/1.1\" 200 17 \"-\" \"Stripe/1.0 (+https://stripe.com/docs/webhooks)\"","service":"payment-service","timestamp":"2025-03-04 15:09:51"}
{"level":"warn","message":"No matching transaction found for payment intent pi_3QyvEHDxY1cZtFZH0MdhM88N","service":"payment-service","timestamp":"2025-03-04 15:09:51"}
{"level":"warn","message":"No matching transaction found for charge ch_3QyvEHDxY1cZtFZH0BCsKpKD","service":"payment-service","timestamp":"2025-03-04 15:09:51"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-04 15:31:12"}
{"level":"info","message":"Database info: Starting a postgresql pool with 5 connections.","service":"payment-service","timestamp":"2025-03-04 15:31:12"}
{"level":"info","message":"Successfully connected to the database","service":"payment-service","timestamp":"2025-03-04 15:31:12"}
{"error":{"clientVersion":"6.4.1","errorCode":"P1012","name":"PrismaClientInitializationError"},"level":"error","message":"Failed to connect to the database: \u001b[1;91merror\u001b[0m: \u001b[1mError validating datasource `db`: the URL must start with the protocol `postgresql://` or `postgres://`.\u001b[0m\n  \u001b[1;94m-->\u001b[0m  \u001b[4mschema.prisma:9\u001b[0m\n\u001b[1;94m   | \u001b[0m\n\u001b[1;94m 8 | \u001b[0m  provider = \"postgresql\"\n\u001b[1;94m 9 | \u001b[0m  url      = \u001b[1;91menv(\"DATABASE_URL\")\u001b[0m\n\u001b[1;94m   | \u001b[0m\n\nValidation Error Count: 1","service":"payment-service","timestamp":"2025-03-05 12:40:42"}
{"error":{"clientVersion":"6.4.1","errorCode":"P1012","name":"PrismaClientInitializationError"},"level":"error","message":"Failed to connect to the database: \u001b[1;91merror\u001b[0m: \u001b[1mError validating datasource `db`: the URL must start with the protocol `postgresql://` or `postgres://`.\u001b[0m\n  \u001b[1;94m-->\u001b[0m  \u001b[4mschema.prisma:9\u001b[0m\n\u001b[1;94m   | \u001b[0m\n\u001b[1;94m 8 | \u001b[0m  provider = \"postgresql\"\n\u001b[1;94m 9 | \u001b[0m  url      = \u001b[1;91menv(\"DATABASE_URL\")\u001b[0m\n\u001b[1;94m   | \u001b[0m\n\nValidation Error Count: 1","service":"payment-service","timestamp":"2025-03-05 12:43:29"}
{"error":{"clientVersion":"6.4.1","errorCode":"P1012","name":"PrismaClientInitializationError"},"level":"error","message":"Failed to connect to the database: \u001b[1;91merror\u001b[0m: \u001b[1mError validating datasource `db`: the URL must start with the protocol `postgresql://` or `postgres://`.\u001b[0m\n  \u001b[1;94m-->\u001b[0m  \u001b[4mschema.prisma:9\u001b[0m\n\u001b[1;94m   | \u001b[0m\n\u001b[1;94m 8 | \u001b[0m  provider = \"postgresql\"\n\u001b[1;94m 9 | \u001b[0m  url      = \u001b[1;91menv(\"DATABASE_URL\")\u001b[0m\n\u001b[1;94m   | \u001b[0m\n\nValidation Error Count: 1","service":"payment-service","timestamp":"2025-03-05 12:44:12"}
{"error":{"clientVersion":"6.4.1","errorCode":"P1012","name":"PrismaClientInitializationError"},"level":"error","message":"Failed to connect to the database: \u001b[1;91merror\u001b[0m: \u001b[1mError validating datasource `db`: the URL must start with the protocol `postgresql://` or `postgres://`.\u001b[0m\n  \u001b[1;94m-->\u001b[0m  \u001b[4mschema.prisma:9\u001b[0m\n\u001b[1;94m   | \u001b[0m\n\u001b[1;94m 8 | \u001b[0m  provider = \"postgresql\"\n\u001b[1;94m 9 | \u001b[0m  url      = \u001b[1;91menv(\"DATABASE_URL\")\u001b[0m\n\u001b[1;94m   | \u001b[0m\n\nValidation Error Count: 1","service":"payment-service","timestamp":"2025-03-05 12:57:14"}
{"error":{"clientVersion":"6.4.1","errorCode":"P1012","name":"PrismaClientInitializationError"},"level":"error","message":"Failed to connect to the database: \u001b[1;91merror\u001b[0m: \u001b[1mError validating datasource `db`: the URL must start with the protocol `postgresql://` or `postgres://`.\u001b[0m\n  \u001b[1;94m-->\u001b[0m  \u001b[4mschema.prisma:9\u001b[0m\n\u001b[1;94m   | \u001b[0m\n\u001b[1;94m 8 | \u001b[0m  provider = \"postgresql\"\n\u001b[1;94m 9 | \u001b[0m  url      = \u001b[1;91menv(\"DATABASE_URL\")\u001b[0m\n\u001b[1;94m   | \u001b[0m\n\nValidation Error Count: 1","service":"payment-service","timestamp":"2025-03-05 12:57:14"}
{"error":{"clientVersion":"6.4.1","errorCode":"P1012","name":"PrismaClientInitializationError"},"level":"error","message":"Failed to connect to the database: \u001b[1;91merror\u001b[0m: \u001b[1mError validating datasource `db`: the URL must start with the protocol `postgresql://` or `postgres://`.\u001b[0m\n  \u001b[1;94m-->\u001b[0m  \u001b[4mschema.prisma:9\u001b[0m\n\u001b[1;94m   | \u001b[0m\n\u001b[1;94m 8 | \u001b[0m  provider = \"postgresql\"\n\u001b[1;94m 9 | \u001b[0m  url      = \u001b[1;91menv(\"DATABASE_URL\")\u001b[0m\n\u001b[1;94m   | \u001b[0m\n\nValidation Error Count: 1","service":"payment-service","timestamp":"2025-03-05 13:00:52"}
{"error":{"clientVersion":"6.4.1","errorCode":"P1012","name":"PrismaClientInitializationError"},"level":"error","message":"Failed to connect to the database: \u001b[1;91merror\u001b[0m: \u001b[1mError validating datasource `db`: the URL must start with the protocol `postgresql://` or `postgres://`.\u001b[0m\n  \u001b[1;94m-->\u001b[0m  \u001b[4mschema.prisma:9\u001b[0m\n\u001b[1;94m   | \u001b[0m\n\u001b[1;94m 8 | \u001b[0m  provider = \"postgresql\"\n\u001b[1;94m 9 | \u001b[0m  url      = \u001b[1;91menv(\"DATABASE_URL\")\u001b[0m\n\u001b[1;94m   | \u001b[0m\n\nValidation Error Count: 1","service":"payment-service","timestamp":"2025-03-05 13:00:52"}
{"error":{"clientVersion":"6.4.1","errorCode":"P1012","name":"PrismaClientInitializationError"},"level":"error","message":"Failed to connect to the database: \u001b[1;91merror\u001b[0m: \u001b[1mError validating datasource `db`: the URL must start with the protocol `postgresql://` or `postgres://`.\u001b[0m\n  \u001b[1;94m-->\u001b[0m  \u001b[4mschema.prisma:9\u001b[0m\n\u001b[1;94m   | \u001b[0m\n\u001b[1;94m 8 | \u001b[0m  provider = \"postgresql\"\n\u001b[1;94m 9 | \u001b[0m  url      = \u001b[1;91menv(\"DATABASE_URL\")\u001b[0m\n\u001b[1;94m   | \u001b[0m\n\nValidation Error Count: 1","service":"payment-service","timestamp":"2025-03-05 13:01:37"}
{"error":{"clientVersion":"6.4.1","errorCode":"P1012","name":"PrismaClientInitializationError"},"level":"error","message":"Failed to connect to the database: \u001b[1;91merror\u001b[0m: \u001b[1mError validating datasource `db`: the URL must start with the protocol `postgresql://` or `postgres://`.\u001b[0m\n  \u001b[1;94m-->\u001b[0m  \u001b[4mschema.prisma:9\u001b[0m\n\u001b[1;94m   | \u001b[0m\n\u001b[1;94m 8 | \u001b[0m  provider = \"postgresql\"\n\u001b[1;94m 9 | \u001b[0m  url      = \u001b[1;91menv(\"DATABASE_URL\")\u001b[0m\n\u001b[1;94m   | \u001b[0m\n\nValidation Error Count: 1","service":"payment-service","timestamp":"2025-03-05 13:01:38"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-05 13:13:32"}
{"level":"info","message":"Successfully connected to the database","service":"payment-service","timestamp":"2025-03-05 13:13:32"}
{"level":"warn","message":"401 - Authentication token is missing","method":"POST","params":{},"path":"/api/payments","service":"payment-service","timestamp":"2025-03-05 13:20:53"}
{"level":"info","message":"::ffff:127.0.0.1 - - [05/Mar/2025:11:20:53 +0000] \"POST /api/payments HTTP/1.1\" 401 1562 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-05 13:20:53"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-05 13:31:51"}
{"level":"info","message":"Successfully connected to the database","service":"payment-service","timestamp":"2025-03-05 13:31:51"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-05 13:31:56"}
{"level":"info","message":"Successfully connected to the database","service":"payment-service","timestamp":"2025-03-05 13:31:56"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-05 13:32:01"}
{"level":"info","message":"Successfully connected to the database","service":"payment-service","timestamp":"2025-03-05 13:32:02"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-05 13:32:05"}
{"level":"info","message":"Successfully connected to the database","service":"payment-service","timestamp":"2025-03-05 13:32:05"}
{"level":"warn","message":"401 - Authentication token is missing","method":"POST","params":{},"path":"/api/payments","service":"payment-service","timestamp":"2025-03-05 13:33:19"}
{"level":"info","message":"::ffff:127.0.0.1 - - [05/Mar/2025:11:33:19 +0000] \"POST /api/payments HTTP/1.1\" 401 1562 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-05 13:33:19"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-05 13:36:12"}
{"level":"info","message":"Successfully connected to the database","service":"payment-service","timestamp":"2025-03-05 13:36:12"}
{"level":"warn","message":"401 - Authentication token is missing","method":"POST","params":{},"path":"/api/payments","service":"payment-service","timestamp":"2025-03-05 13:36:24"}
{"level":"info","message":"::ffff:127.0.0.1 - - [05/Mar/2025:11:36:24 +0000] \"POST /api/payments HTTP/1.1\" 401 61 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-05 13:36:24"}
{"level":"error","message":"Auth service unavailable: connect ECONNREFUSED ::1:5000","service":"payment-service","timestamp":"2025-03-05 13:40:56"}
{"body":{"amount":99.99,"courseId":"course123","educatorId":"educator456","paymentMethodId":"pm_card_visa"},"error":"Error: Authentication service unavailable\n    at validateToken (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\middleware\\auth.js:40:21)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","level":"error","message":"503 - Authentication service unavailable","method":"POST","params":{},"path":"/api/payments","query":{},"service":"payment-service","timestamp":"2025-03-05 13:40:56"}
{"level":"info","message":"::ffff:127.0.0.1 - - [05/Mar/2025:11:40:56 +0000] \"POST /api/payments HTTP/1.1\" 503 64 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-05 13:40:56"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-05 13:46:45"}
{"level":"info","message":"Successfully connected to the database","service":"payment-service","timestamp":"2025-03-05 13:46:45"}
{"level":"error","message":"Auth service unavailable: connect ECONNREFUSED ::1:5000","service":"payment-service","timestamp":"2025-03-05 13:46:58"}
{"body":{"amount":99.99,"courseId":"course123","educatorId":"educator456","paymentMethodId":"pm_card_visa"},"error":"Error: Authentication service unavailable\n    at validateToken (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\middleware\\auth.js:40:21)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","level":"error","message":"503 - Authentication service unavailable","method":"POST","params":{},"path":"/api/payments","query":{},"service":"payment-service","timestamp":"2025-03-05 13:46:58"}
{"level":"info","message":"::ffff:127.0.0.1 - - [05/Mar/2025:11:46:58 +0000] \"POST /api/payments HTTP/1.1\" 503 64 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-05 13:46:58"}
{"level":"error","message":"Auth service unavailable: connect ECONNREFUSED ::1:5000","service":"payment-service","timestamp":"2025-03-05 13:47:13"}
{"body":{"amount":99.99,"courseId":"course123","educatorId":"educator456","paymentMethodId":"pm_card_visa"},"error":"Error: Authentication service unavailable\n    at validateToken (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\middleware\\auth.js:40:21)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","level":"error","message":"503 - Authentication service unavailable","method":"POST","params":{},"path":"/api/payments","query":{},"service":"payment-service","timestamp":"2025-03-05 13:47:13"}
{"level":"info","message":"::ffff:127.0.0.1 - - [05/Mar/2025:11:47:13 +0000] \"POST /api/payments HTTP/1.1\" 503 64 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-05 13:47:13"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-05 13:48:06"}
{"level":"info","message":"Successfully connected to the database","service":"payment-service","timestamp":"2025-03-05 13:48:06"}
{"level":"error","message":"Auth service unavailable: connect ECONNREFUSED ::1:5000","service":"payment-service","timestamp":"2025-03-05 13:48:11"}
{"body":{"amount":99.99,"courseId":"course123","educatorId":"educator456","paymentMethodId":"pm_card_visa"},"error":"Error: Authentication service unavailable\n    at validateToken (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\middleware\\auth.js:40:21)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","level":"error","message":"503 - Authentication service unavailable","method":"POST","params":{},"path":"/api/payments","query":{},"service":"payment-service","timestamp":"2025-03-05 13:48:11"}
{"level":"info","message":"::ffff:127.0.0.1 - - [05/Mar/2025:11:48:11 +0000] \"POST /api/payments HTTP/1.1\" 503 64 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-05 13:48:11"}
{"level":"error","message":"Auth service unavailable: connect ECONNREFUSED ::1:5000","service":"payment-service","timestamp":"2025-03-05 13:48:23"}
{"body":{"amount":99.99,"courseId":"course123","educatorId":"educator456","paymentMethodId":"pm_card_visa"},"error":"Error: Authentication service unavailable\n    at validateToken (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\middleware\\auth.js:40:21)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","level":"error","message":"503 - Authentication service unavailable","method":"POST","params":{},"path":"/api/payments","query":{},"service":"payment-service","timestamp":"2025-03-05 13:48:23"}
{"level":"info","message":"::ffff:127.0.0.1 - - [05/Mar/2025:11:48:23 +0000] \"POST /api/payments HTTP/1.1\" 503 64 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-05 13:48:23"}
{"level":"error","message":"Auth service unavailable: connect ECONNREFUSED ::1:5000","service":"payment-service","timestamp":"2025-03-05 13:48:55"}
{"error":{"clientVersion":"6.4.1","errorCode":"P1012","name":"PrismaClientInitializationError"},"level":"error","message":"Failed to connect to the database: \u001b[1;91merror\u001b[0m: \u001b[1mError validating datasource `db`: the URL must start with the protocol `postgresql://` or `postgres://`.\u001b[0m\n  \u001b[1;94m-->\u001b[0m  \u001b[4mschema.prisma:9\u001b[0m\n\u001b[1;94m   | \u001b[0m\n\u001b[1;94m 8 | \u001b[0m  provider = \"postgresql\"\n\u001b[1;94m 9 | \u001b[0m  url      = \u001b[1;91menv(\"DATABASE_URL\")\u001b[0m\n\u001b[1;94m   | \u001b[0m\n\nValidation Error Count: 1","service":"payment-service","timestamp":"2025-03-07 15:18:56"}
{"error":{"clientVersion":"6.4.1","errorCode":"P1012","name":"PrismaClientInitializationError"},"level":"error","message":"Failed to connect to the database: \u001b[1;91merror\u001b[0m: \u001b[1mError validating datasource `db`: the URL must start with the protocol `postgresql://` or `postgres://`.\u001b[0m\n  \u001b[1;94m-->\u001b[0m  \u001b[4mschema.prisma:9\u001b[0m\n\u001b[1;94m   | \u001b[0m\n\u001b[1;94m 8 | \u001b[0m  provider = \"postgresql\"\n\u001b[1;94m 9 | \u001b[0m  url      = \u001b[1;91menv(\"DATABASE_URL\")\u001b[0m\n\u001b[1;94m   | \u001b[0m\n\nValidation Error Count: 1","service":"payment-service","timestamp":"2025-03-07 15:18:58"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 15:45:10"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:45:10"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 15:45:33"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:45:34"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 15:46:57"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:46:57"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:32"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:33"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:33"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:36"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:38"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:38"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:38"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:38"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:38"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:39"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:39"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:39"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:39"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:39"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:39"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:39"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:39"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:39"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:39"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:39"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:39"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:39"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:39"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:39"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:40"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:41"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:42"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 15:59:24"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-09 15:59:24"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 16:38:53"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-09 16:38:53"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 16:38:58"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-09 16:38:58"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 17:08:34"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 17:08:41"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-09 17:08:41"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 17:08:55"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-09 17:08:55"}
{"level":"info","message":"::ffff:127.0.0.1 - - [09/Mar/2025:15:09:44 +0000] \"POST /api/payments HTTP/1.1\" - - \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-09 17:09:44"}
{"level":"info","message":"::ffff:127.0.0.1 - - [09/Mar/2025:15:10:00 +0000] \"POST /api/payments/ HTTP/1.1\" - - \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-09 17:10:00"}
{"level":"info","message":"::ffff:127.0.0.1 - - [09/Mar/2025:15:11:09 +0000] \"POST /api/payments/ HTTP/1.1\" - - \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-09 17:11:09"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 17:11:43"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-09 17:11:43"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 17:11:52"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-09 17:11:52"}
{"level":"info","message":"::ffff:127.0.0.1 - - [09/Mar/2025:15:12:01 +0000] \"POST /api/payments/ HTTP/1.1\" - - \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-09 17:12:01"}
{"level":"info","message":"::ffff:127.0.0.1 - - [09/Mar/2025:15:12:15 +0000] \"POST /api/payments/ HTTP/1.1\" - - \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-09 17:12:15"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 17:13:20"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-09 17:13:20"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 17:14:12"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-09 17:14:13"}
{"level":"info","message":"::ffff:127.0.0.1 - - [09/Mar/2025:15:14:27 +0000] \"POST /api/payments/ HTTP/1.1\" - - \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-09 17:14:27"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 17:14:47"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-09 17:14:48"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 17:15:55"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-09 17:15:56"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 17:16:19"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-09 17:16:19"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 17:16:37"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-09 17:16:37"}
{"level":"info","message":"::ffff:127.0.0.1 - - [09/Mar/2025:15:16:42 +0000] \"POST /api/payments/ HTTP/1.1\" - - \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-09 17:16:42"}
{"level":"info","message":"::ffff:127.0.0.1 - - [09/Mar/2025:15:16:54 +0000] \"POST /api/payments/ HTTP/1.1\" - - \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-09 17:16:54"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 17:17:10"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-09 17:17:11"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 17:17:52"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-09 17:17:52"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 17:18:02"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-09 17:18:02"}
{"level":"info","message":"::ffff:127.0.0.1 - - [09/Mar/2025:15:18:17 +0000] \"POST /api/payments/ HTTP/1.1\" - - \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-09 17:18:17"}
{"level":"info","message":"::ffff:127.0.0.1 - - [09/Mar/2025:15:19:03 +0000] \"POST /api/payments/ HTTP/1.1\" - - \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-09 17:19:03"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 17:19:16"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-09 17:19:16"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 17:21:45"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-09 17:21:45"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 17:23:37"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-09 17:23:37"}
{"level":"info","message":"::ffff:127.0.0.1 - - [09/Mar/2025:15:24:29 +0000] \"POST /api/payments/ HTTP/1.1\" - - \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-09 17:24:29"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 17:29:43"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-09 17:29:44"}
{"level":"info","message":"::ffff:127.0.0.1 - - [09/Mar/2025:15:30:10 +0000] \"POST /api/payments/ HTTP/1.1\" - - \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-09 17:30:10"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 17:31:08"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-09 17:31:08"}
{"level":"info","message":"::ffff:127.0.0.1 - - [09/Mar/2025:15:31:20 +0000] \"POST /api/payments/ HTTP/1.1\" - - \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-09 17:31:20"}
{"level":"info","message":"::ffff:127.0.0.1 - - [09/Mar/2025:15:32:15 +0000] \"POST /api/payments/ HTTP/1.1\" - - \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-09 17:32:15"}
{"level":"info","message":"::ffff:127.0.0.1 - - [09/Mar/2025:15:32:25 +0000] \"POST /api/payments/ HTTP/1.1\" - - \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-09 17:32:25"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 17:40:55"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-09 17:40:56"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 17:43:41"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-09 17:43:41"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-09 17:43:49"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 17:44:28"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-09 17:44:28"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 17:44:39"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-09 17:44:39"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-09 17:44:44"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-09 17:44:44"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 17:45:02"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-09 17:45:02"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 17:45:13"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-09 17:45:13"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-09 17:45:18"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 17:45:39"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-09 17:45:39"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-09 17:45:45"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-09 17:45:46"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 17:45:59"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-09 17:45:59"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 17:46:18"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-09 17:46:18"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 17:47:07"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-09 17:47:07"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 17:47:13"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-09 17:47:14"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 17:47:19"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-09 17:47:19"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 17:47:22"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-09 17:47:22"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 17:47:31"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-09 17:47:32"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 17:47:34"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-09 17:47:35"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 17:47:45"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-09 17:47:45"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 17:48:23"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-09 17:48:23"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-09 17:48:50"}
{"level":"info","message":"::ffff:127.0.0.1 - - [09/Mar/2025:15:49:01 +0000] \"POST /api/payments/ HTTP/1.1\" - - \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-09 17:49:01"}
{"level":"info","message":"POST /api/payments/refund","service":"payment-service","timestamp":"2025-03-09 17:49:19"}
{"level":"info","message":"::ffff:127.0.0.1 - - [09/Mar/2025:15:49:19 +0000] \"POST /api/payments/refund HTTP/1.1\" 401 1568 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-09 17:49:19"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 17:49:33"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-09 17:49:33"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-09 17:49:40"}
{"level":"info","message":"::ffff:127.0.0.1 - - [09/Mar/2025:15:49:40 +0000] \"POST /api/payments/ HTTP/1.1\" 401 1568 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-09 17:49:40"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 17:50:23"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-09 17:50:24"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-09 17:51:06"}
{"level":"info","message":"::ffff:127.0.0.1 - - [09/Mar/2025:15:51:22 +0000] \"POST /api/payments/ HTTP/1.1\" - - \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-09 17:51:22"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 17:51:30"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-09 17:51:31"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-09 17:51:33"}
{"level":"info","message":"Payment split: Amount: $100, Platform: $20, Educator: $80","service":"payment-service","timestamp":"2025-03-09 17:51:34"}
{"data":{"action":"ENROLL_USER","courseId":"1","transactionId":"6721e6f4-7cf4-470a-8d0c-c5a34ca1b603","userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"mock-user-id\",\"action\":\"ENROLL_USER\",\"courseId\":\"1\",\"transactionId\":\"6721e6f4-7cf4-470a-8d0c-c5a34ca1b603\"}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"118","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:87:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-09 17:51:35"}
{"data":{"action":"RECORD_PURCHASE","amount":100,"courseId":"1","educatorEarnings":80,"userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"courseId\":\"1\",\"action\":\"RECORD_PURCHASE\",\"userId\":\"mock-user-id\",\"amount\":100,\"educatorEarnings\":80}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"102","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3002/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3002","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3002\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyCourseService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:41:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:95:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify course service: connect ECONNREFUSED ::1:3002","service":"payment-service","timestamp":"2025-03-09 17:51:35"}
{"data":{"action":"NEW_EARNINGS","data":{"amount":80,"courseId":"1","totalPendingEarnings":80,"transactionId":"6721e6f4-7cf4-470a-8d0c-c5a34ca1b603"},"userId":"1"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"1\",\"action\":\"NEW_EARNINGS\",\"data\":{\"courseId\":\"1\",\"transactionId\":\"6721e6f4-7cf4-470a-8d0c-c5a34ca1b603\",\"amount\":80,\"totalPendingEarnings\":80}}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"155","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:104:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-09 17:51:35"}
{"action":"PAYMENT_PROCESSED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_PROCESSED by mock-user-id - Payment of 100 USD processed for course 1","metadata":{"stripeChargeId":"ch_3R0m8YDxY1cZtFZH2M6tXLfH"},"service":"payment-service","timestamp":"2025-03-09 17:51:35","transactionId":"6721e6f4-7cf4-470a-8d0c-c5a34ca1b603"}
{"level":"info","message":"::ffff:127.0.0.1 - - [09/Mar/2025:15:51:35 +0000] \"POST /api/payments/ HTTP/1.1\" 200 1136 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-09 17:51:35"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 18:43:44"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-09 18:43:44"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 18:45:21"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-09 18:45:22"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 18:45:33"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-09 18:45:33"}
{"level":"info","message":"POST /api/payments/refund","service":"payment-service","timestamp":"2025-03-09 18:46:08"}
{"error":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"274","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=tMeDVGMLBnFFRMkPk1EngeaDRv9E-zTSxf-67qfZ9BpRY_XwN3LX5WMPHGUJULIUfiCBcnnlIC3c-zNH","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Sun, 09 Mar 2025 16:46:09 GMT","idempotency-key":"stripe-node-retry-af916aa8-8ce3-4b39-9f2f-bc1aea932328","original-request":"req_SoQEwaV93cgKcm","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_SoQEwaV93cgKcm","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"param":"reason","raw":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"274","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=tMeDVGMLBnFFRMkPk1EngeaDRv9E-zTSxf-67qfZ9BpRY_XwN3LX5WMPHGUJULIUfiCBcnnlIC3c-zNH","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Sun, 09 Mar 2025 16:46:09 GMT","idempotency-key":"stripe-node-retry-af916aa8-8ce3-4b39-9f2f-bc1aea932328","original-request":"req_SoQEwaV93cgKcm","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_SoQEwaV93cgKcm","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"Invalid reason: must be one of duplicate, fraudulent, or requested_by_customer","param":"reason","requestId":"req_SoQEwaV93cgKcm","request_log_url":"https://dashboard.stripe.com/test/logs/req_SoQEwaV93cgKcm?t=1741538769","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_SoQEwaV93cgKcm","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Refund processing error: Invalid reason: must be one of duplicate, fraudulent, or requested_by_customer","service":"payment-service","timestamp":"2025-03-09 18:46:09"}
{"level":"error","message":"Error processing refund: Refund processing failed: Invalid reason: must be one of duplicate, fraudulent, or requested_by_customer","service":"payment-service","timestamp":"2025-03-09 18:46:09"}
{"level":"info","message":"::ffff:127.0.0.1 - - [09/Mar/2025:16:46:09 +0000] \"POST /api/payments/refund HTTP/1.1\" 400 134 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-09 18:46:09"}
{"level":"info","message":"POST /api/payments/refund","service":"payment-service","timestamp":"2025-03-09 18:47:28"}
{"error":{"clientVersion":"6.4.1","code":"P2002","meta":{"modelName":"Transaction","target":["userId","courseId"]},"name":"PrismaClientKnownRequestError"},"level":"error","message":"Refund processing error: \nInvalid `prisma.transaction.create()` invocation in\nC:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:260:56\n\n  257 const refundedEarnings = originalTransaction.educatorEarnings * refundRatio;\n  258 \n  259 // 4. Create a refund transaction record\n→ 260 const refundTransaction = await prisma.transaction.create(\nUnique constraint failed on the fields: (`userId`,`courseId`)","service":"payment-service","timestamp":"2025-03-09 18:47:30"}
{"level":"error","message":"Error processing refund: Refund processing failed: \nInvalid `prisma.transaction.create()` invocation in\nC:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:260:56\n\n  257 const refundedEarnings = originalTransaction.educatorEarnings * refundRatio;\n  258 \n  259 // 4. Create a refund transaction record\n→ 260 const refundTransaction = await prisma.transaction.create(\nUnique constraint failed on the fields: (`userId`,`courseId`)","service":"payment-service","timestamp":"2025-03-09 18:47:30"}
{"level":"info","message":"::ffff:127.0.0.1 - - [09/Mar/2025:16:47:30 +0000] \"POST /api/payments/refund HTTP/1.1\" 400 493 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-09 18:47:30"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 18:51:12"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-09 18:51:12"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 18:51:22"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-09 18:51:22"}
{"level":"info","message":"POST /api/payments/refund","service":"payment-service","timestamp":"2025-03-09 18:51:35"}
{"error":{"code":"charge_already_refunded","doc_url":"https://stripe.com/docs/error-codes/charge-already-refunded","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"351","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=uo5UHmSha5Q70VPI7X2ct8VOD4K3oPRRQjBwbxRIgNRwKIusQZS0yQuBqsyzdXCdABIXDd26ohp7Ty2H","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Sun, 09 Mar 2025 16:51:36 GMT","idempotency-key":"stripe-node-retry-b1e287e6-a4d1-41e0-98b5-c6cf925464ee","original-request":"req_r4Rt2m10kp4MUG","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_r4Rt2m10kp4MUG","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"raw":{"code":"charge_already_refunded","doc_url":"https://stripe.com/docs/error-codes/charge-already-refunded","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"351","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=uo5UHmSha5Q70VPI7X2ct8VOD4K3oPRRQjBwbxRIgNRwKIusQZS0yQuBqsyzdXCdABIXDd26ohp7Ty2H","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Sun, 09 Mar 2025 16:51:36 GMT","idempotency-key":"stripe-node-retry-b1e287e6-a4d1-41e0-98b5-c6cf925464ee","original-request":"req_r4Rt2m10kp4MUG","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_r4Rt2m10kp4MUG","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"Charge ch_3R0m8YDxY1cZtFZH2M6tXLfH has already been refunded.","requestId":"req_r4Rt2m10kp4MUG","request_log_url":"https://dashboard.stripe.com/test/logs/req_r4Rt2m10kp4MUG?t=1741539096","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_r4Rt2m10kp4MUG","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Refund processing error: Charge ch_3R0m8YDxY1cZtFZH2M6tXLfH has already been refunded.","service":"payment-service","timestamp":"2025-03-09 18:51:36"}
{"level":"error","message":"Error processing refund: Refund processing failed: Charge ch_3R0m8YDxY1cZtFZH2M6tXLfH has already been refunded.","service":"payment-service","timestamp":"2025-03-09 18:51:36"}
{"level":"info","message":"::ffff:127.0.0.1 - - [09/Mar/2025:16:51:36 +0000] \"POST /api/payments/refund HTTP/1.1\" 400 117 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-09 18:51:36"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-09 18:53:25"}
{"error":{"isOperational":true,"status":"fail","statusCode":400},"level":"error","message":"Payment processing error: User already enrolled in this course","service":"payment-service","timestamp":"2025-03-09 18:53:25"}
{"level":"error","message":"Error processing payment: \nInvalid `prisma.transaction.create()` invocation in\nC:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:135:32\n\n  132 \n  133 // Record failed transaction if we have enough information\n  134 if (courseId && amount && user?.id) {\n→ 135   await prisma.transaction.create(\nUnique constraint failed on the fields: (`userId`,`courseId`)","service":"payment-service","timestamp":"2025-03-09 18:53:25"}
{"level":"info","message":"::ffff:127.0.0.1 - - [09/Mar/2025:16:53:25 +0000] \"POST /api/payments/ HTTP/1.1\" 500 422 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-09 18:53:25"}
{"level":"info","message":"POST /api/payments/refund","service":"payment-service","timestamp":"2025-03-09 18:53:25"}
{"level":"warn","message":"Validation failed: transactionId is required","service":"payment-service","timestamp":"2025-03-09 18:53:25"}
{"level":"info","message":"::ffff:127.0.0.1 - - [09/Mar/2025:16:53:25 +0000] \"POST /api/payments/refund HTTP/1.1\" 400 86 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-09 18:53:25"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-09 18:56:10"}
{"error":{"isOperational":true,"status":"fail","statusCode":400},"level":"error","message":"Payment processing error: User already enrolled in this course","service":"payment-service","timestamp":"2025-03-09 18:56:10"}
{"action":"PAYMENT_FAILED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_FAILED by mock-user-id - Payment of 100 USD failed for course 1","metadata":{"error":"User already enrolled in this course"},"service":"payment-service","timestamp":"2025-03-09 18:56:10","transactionId":null}
{"level":"error","message":"Error processing payment: Payment processing failed: User already enrolled in this course","service":"payment-service","timestamp":"2025-03-09 18:56:10"}
{"level":"info","message":"::ffff:127.0.0.1 - - [09/Mar/2025:16:56:10 +0000] \"POST /api/payments/ HTTP/1.1\" 400 93 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-09 18:56:10"}
{"level":"info","message":"POST /api/payments/refund","service":"payment-service","timestamp":"2025-03-09 18:56:10"}
{"level":"warn","message":"Validation failed: transactionId is required","service":"payment-service","timestamp":"2025-03-09 18:56:10"}
{"level":"info","message":"::ffff:127.0.0.1 - - [09/Mar/2025:16:56:10 +0000] \"POST /api/payments/refund HTTP/1.1\" 400 86 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-09 18:56:10"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-09 19:00:26"}
{"error":{"isOperational":true,"status":"fail","statusCode":400},"level":"error","message":"Payment processing error: User already enrolled in this course","service":"payment-service","timestamp":"2025-03-09 19:00:26"}
{"action":"PAYMENT_FAILED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_FAILED by mock-user-id - Payment of 100 USD failed for course 1","metadata":{"error":"User already enrolled in this course"},"service":"payment-service","timestamp":"2025-03-09 19:00:26","transactionId":null}
{"level":"error","message":"Error processing payment: Payment processing failed: User already enrolled in this course","service":"payment-service","timestamp":"2025-03-09 19:00:26"}
{"level":"info","message":"::ffff:127.0.0.1 - - [09/Mar/2025:17:00:26 +0000] \"POST /api/payments/ HTTP/1.1\" 400 93 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-09 19:00:26"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 19:13:58"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-09 19:13:58"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 19:14:44"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-09 19:14:44"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 19:20:45"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-09 19:20:45"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 19:21:56"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-09 19:21:57"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 19:22:34"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-09 19:22:35"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-09 19:23:35"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-09 19:23:35"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 13:37:18"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 13:37:18"}
{"level":"info","message":"OPTIONS /api/payments","service":"payment-service","timestamp":"2025-03-10 13:38:32"}
{"level":"info","message":"POST /api/payments","service":"payment-service","timestamp":"2025-03-10 13:38:32"}
{"error":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"281","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=qeQGEUD5towABJHRXLQskW2LSNND4U_mmsKF4YChWfmOPnwyXjrYkTQZ44BmRxJ8WpfQqzY3i-WVMlDf","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Mon, 10 Mar 2025 11:38:32 GMT","idempotency-key":"stripe-node-retry-b10f532a-d8ea-4d4f-b256-22e1228a3ab3","original-request":"req_tY2IkhgTxAK62H","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_tY2IkhgTxAK62H","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"param":"source","raw":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"281","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=qeQGEUD5towABJHRXLQskW2LSNND4U_mmsKF4YChWfmOPnwyXjrYkTQZ44BmRxJ8WpfQqzY3i-WVMlDf","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Mon, 10 Mar 2025 11:38:32 GMT","idempotency-key":"stripe-node-retry-b10f532a-d8ea-4d4f-b256-22e1228a3ab3","original-request":"req_tY2IkhgTxAK62H","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_tY2IkhgTxAK62H","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"You cannot create a charge with a PaymentMethod. Use the Payment Intents API instead.","param":"source","requestId":"req_tY2IkhgTxAK62H","request_log_url":"https://dashboard.stripe.com/test/logs/req_tY2IkhgTxAK62H?t=1741606712","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_tY2IkhgTxAK62H","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Payment processing error: You cannot create a charge with a PaymentMethod. Use the Payment Intents API instead.","service":"payment-service","timestamp":"2025-03-10 13:38:33"}
{"action":"PAYMENT_FAILED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_FAILED by mock-user-id - Payment of 99.99 USD failed for course course_1","metadata":{"error":"You cannot create a charge with a PaymentMethod. Use the Payment Intents API instead."},"service":"payment-service","timestamp":"2025-03-10 13:38:33","transactionId":null}
{"level":"error","message":"Error processing payment: Payment processing failed: You cannot create a charge with a PaymentMethod. Use the Payment Intents API instead.","service":"payment-service","timestamp":"2025-03-10 13:38:33"}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:11:38:33 +0000] \"POST /api/payments HTTP/1.1\" 400 142 \"http://localhost:3000/\" \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:136.0) Gecko/20100101 Firefox/136.0\"","service":"payment-service","timestamp":"2025-03-10 13:38:33"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 13:41:48"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 13:41:48"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 13:41:57"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 13:41:58"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 13:42:14"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 13:42:14"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 13:42:55"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 13:42:55"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 13:43:24"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 13:43:25"}
{"level":"info","message":"POST /api/payments","service":"payment-service","timestamp":"2025-03-10 13:43:38"}
{"error":{"code":"parameter_missing","doc_url":"https://stripe.com/docs/error-codes/parameter-missing","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"310","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=aDi6Rz3Mg4fv8Q03f82FLunk2bjo7ExtGcXj_ur2FSHK7FeZyhvp0YoNBInNwBNLcEgQNmb85xjL1IHW","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Mon, 10 Mar 2025 11:43:38 GMT","idempotency-key":"stripe-node-retry-35f894fa-76c8-484d-9c7b-49316fdfb701","original-request":"req_6LglrLAcfqsduG","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_6LglrLAcfqsduG","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"raw":{"code":"parameter_missing","doc_url":"https://stripe.com/docs/error-codes/parameter-missing","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"310","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=aDi6Rz3Mg4fv8Q03f82FLunk2bjo7ExtGcXj_ur2FSHK7FeZyhvp0YoNBInNwBNLcEgQNmb85xjL1IHW","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Mon, 10 Mar 2025 11:43:38 GMT","idempotency-key":"stripe-node-retry-35f894fa-76c8-484d-9c7b-49316fdfb701","original-request":"req_6LglrLAcfqsduG","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_6LglrLAcfqsduG","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"Must provide source or customer.","requestId":"req_6LglrLAcfqsduG","request_log_url":"https://dashboard.stripe.com/test/logs/req_6LglrLAcfqsduG?t=1741607018","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_6LglrLAcfqsduG","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Payment processing error: Must provide source or customer.","service":"payment-service","timestamp":"2025-03-10 13:43:39"}
{"action":"PAYMENT_FAILED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_FAILED by mock-user-id - Payment of 99.99 USD failed for course course_1","metadata":{"error":"Must provide source or customer."},"service":"payment-service","timestamp":"2025-03-10 13:43:39","transactionId":null}
{"level":"error","message":"Error processing payment: Payment processing failed: Must provide source or customer.","service":"payment-service","timestamp":"2025-03-10 13:43:39"}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:11:43:39 +0000] \"POST /api/payments HTTP/1.1\" 400 89 \"http://localhost:3000/\" \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:136.0) Gecko/20100101 Firefox/136.0\"","service":"payment-service","timestamp":"2025-03-10 13:43:39"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 13:45:08"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 13:45:08"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 13:45:17"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 13:45:17"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 13:45:46"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 13:45:46"}
{"level":"info","message":"POST /api/payments","service":"payment-service","timestamp":"2025-03-10 13:45:50"}
{"error":{"code":"parameter_missing","doc_url":"https://stripe.com/docs/error-codes/parameter-missing","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"310","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=4z5x926Ww4tKj_zRLghnm-Uh7PltYaT9BLdgPTj3VTq__EskAG543kGL7sWUJ48bFLmt-VCLIkBZKLPA","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Mon, 10 Mar 2025 11:45:50 GMT","idempotency-key":"stripe-node-retry-a31aa4ca-a74f-4dd8-af78-9590b7bcc74d","original-request":"req_Oza6Ff9kr1coFy","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_Oza6Ff9kr1coFy","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"raw":{"code":"parameter_missing","doc_url":"https://stripe.com/docs/error-codes/parameter-missing","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"310","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=4z5x926Ww4tKj_zRLghnm-Uh7PltYaT9BLdgPTj3VTq__EskAG543kGL7sWUJ48bFLmt-VCLIkBZKLPA","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Mon, 10 Mar 2025 11:45:50 GMT","idempotency-key":"stripe-node-retry-a31aa4ca-a74f-4dd8-af78-9590b7bcc74d","original-request":"req_Oza6Ff9kr1coFy","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_Oza6Ff9kr1coFy","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"Must provide source or customer.","requestId":"req_Oza6Ff9kr1coFy","request_log_url":"https://dashboard.stripe.com/test/logs/req_Oza6Ff9kr1coFy?t=1741607150","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_Oza6Ff9kr1coFy","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Payment processing error: Must provide source or customer.","service":"payment-service","timestamp":"2025-03-10 13:45:51"}
{"action":"PAYMENT_FAILED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_FAILED by mock-user-id - Payment of 99.99 USD failed for course course_1","metadata":{"error":"Must provide source or customer."},"service":"payment-service","timestamp":"2025-03-10 13:45:51","transactionId":null}
{"level":"error","message":"Error processing payment: Payment processing failed: Must provide source or customer.","service":"payment-service","timestamp":"2025-03-10 13:45:51"}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:11:45:51 +0000] \"POST /api/payments HTTP/1.1\" 400 89 \"http://localhost:3000/\" \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:136.0) Gecko/20100101 Firefox/136.0\"","service":"payment-service","timestamp":"2025-03-10 13:45:51"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 13:47:32"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 13:47:32"}
{"level":"info","message":"POST /api/payments","service":"payment-service","timestamp":"2025-03-10 13:48:45"}
{"error":{"code":"parameter_unknown","doc_url":"https://stripe.com/docs/error-codes/parameter-unknown","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"337","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=zNVOhIV7jr9jpsMkDEpispz-4I2mGQkG8qf0ZzpCqwJpUj-N7l6vNEcKmnXcWrTZP30VFGOSStS9Biol","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Mon, 10 Mar 2025 11:48:45 GMT","idempotency-key":"stripe-node-retry-9e08d302-594a-485f-8fd0-4f1b91ef416f","original-request":"req_VNv2qIZh0cEWlx","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_VNv2qIZh0cEWlx","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"param":"confirm","raw":{"code":"parameter_unknown","doc_url":"https://stripe.com/docs/error-codes/parameter-unknown","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"337","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=zNVOhIV7jr9jpsMkDEpispz-4I2mGQkG8qf0ZzpCqwJpUj-N7l6vNEcKmnXcWrTZP30VFGOSStS9Biol","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Mon, 10 Mar 2025 11:48:45 GMT","idempotency-key":"stripe-node-retry-9e08d302-594a-485f-8fd0-4f1b91ef416f","original-request":"req_VNv2qIZh0cEWlx","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_VNv2qIZh0cEWlx","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"Received unknown parameter: confirm","param":"confirm","requestId":"req_VNv2qIZh0cEWlx","request_log_url":"https://dashboard.stripe.com/test/logs/req_VNv2qIZh0cEWlx?t=1741607325","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_VNv2qIZh0cEWlx","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Payment processing error: Received unknown parameter: confirm","service":"payment-service","timestamp":"2025-03-10 13:48:46"}
{"action":"PAYMENT_FAILED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_FAILED by mock-user-id - Payment of 99.99 USD failed for course course_1","metadata":{"error":"Received unknown parameter: confirm"},"service":"payment-service","timestamp":"2025-03-10 13:48:46","transactionId":null}
{"level":"error","message":"Error processing payment: Payment processing failed: Received unknown parameter: confirm","service":"payment-service","timestamp":"2025-03-10 13:48:46"}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:11:48:46 +0000] \"POST /api/payments HTTP/1.1\" 400 92 \"http://localhost:3000/\" \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:136.0) Gecko/20100101 Firefox/136.0\"","service":"payment-service","timestamp":"2025-03-10 13:48:46"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 13:48:57"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 13:48:57"}
{"level":"info","message":"POST /api/payments","service":"payment-service","timestamp":"2025-03-10 13:49:08"}
{"level":"info","message":"Payment split: Amount: $99.99, Platform: $19.998, Educator: $79.99199999999999","service":"payment-service","timestamp":"2025-03-10 13:49:10"}
{"data":{"action":"ENROLL_USER","courseId":"course_1","transactionId":"1db0e8c7-8ad5-4e59-b474-735f26c4befb","userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"mock-user-id\",\"action\":\"ENROLL_USER\",\"courseId\":\"course_1\",\"transactionId\":\"1db0e8c7-8ad5-4e59-b474-735f26c4befb\"}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"125","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:87:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-10 13:49:10"}
{"data":{"action":"RECORD_PURCHASE","amount":99.99,"courseId":"course_1","educatorEarnings":79.99199999999999,"userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"courseId\":\"course_1\",\"action\":\"RECORD_PURCHASE\",\"userId\":\"mock-user-id\",\"amount\":99.99,\"educatorEarnings\":79.99199999999999}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"126","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3002/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3002","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3002\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyCourseService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:41:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:95:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify course service: connect ECONNREFUSED ::1:3002","service":"payment-service","timestamp":"2025-03-10 13:49:10"}
{"data":{"action":"NEW_EARNINGS","data":{"amount":79.99199999999999,"courseId":"course_1","totalPendingEarnings":79.99199999999999,"transactionId":"1db0e8c7-8ad5-4e59-b474-735f26c4befb"},"userId":"edu_123"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"edu_123\",\"action\":\"NEW_EARNINGS\",\"data\":{\"courseId\":\"course_1\",\"transactionId\":\"1db0e8c7-8ad5-4e59-b474-735f26c4befb\",\"amount\":79.99199999999999,\"totalPendingEarnings\":79.99199999999999}}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"198","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:104:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-10 13:49:10"}
{"action":"PAYMENT_PROCESSED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_PROCESSED by mock-user-id - Payment of 99.99 USD processed for course course_1","metadata":{"stripeChargeId":"ch_3R14pUDxY1cZtFZH0T6H5kNY"},"service":"payment-service","timestamp":"2025-03-10 13:49:10","transactionId":"1db0e8c7-8ad5-4e59-b474-735f26c4befb"}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:11:49:10 +0000] \"POST /api/payments HTTP/1.1\" 200 1210 \"http://localhost:3000/\" \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:136.0) Gecko/20100101 Firefox/136.0\"","service":"payment-service","timestamp":"2025-03-10 13:49:10"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 13:51:47"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 13:51:48"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 13:52:26"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 13:52:26"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 13:52:39"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 13:52:39"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 13:52:43"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 13:52:43"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 13:53:16"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 13:53:17"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 13:53:32"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 13:53:35"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 13:53:35"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 13:53:43"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 13:53:43"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 13:54:02"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 13:54:02"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 13:55:30"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 13:55:30"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 13:55:35"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 13:55:36"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 13:55:39"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 13:55:39"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 13:55:51"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 13:55:51"}
{"level":"info","message":"GET /api/payouts/educators/edu_123/pending","service":"payment-service","timestamp":"2025-03-10 14:15:14"}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:12:15:14 +0000] \"GET /api/payouts/educators/edu_123/pending HTTP/1.1\" 404 176 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-10 14:15:14"}
{"level":"info","message":"GET /api/payouts/educators/edu_123/pending","service":"payment-service","timestamp":"2025-03-10 14:15:53"}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:12:15:53 +0000] \"GET /api/payouts/educators/edu_123/pending HTTP/1.1\" 404 176 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-10 14:15:53"}
{"level":"info","message":"GET /api/payouts/educators","service":"payment-service","timestamp":"2025-03-10 14:16:07"}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:12:16:07 +0000] \"GET /api/payouts/educators HTTP/1.1\" 404 160 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-10 14:16:07"}
{"level":"info","message":"GET /api/payouts/","service":"payment-service","timestamp":"2025-03-10 14:16:50"}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:12:16:50 +0000] \"GET /api/payouts/ HTTP/1.1\" 404 151 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-10 14:16:50"}
{"level":"info","message":"GET /api/","service":"payment-service","timestamp":"2025-03-10 14:17:20"}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:12:17:20 +0000] \"GET /api/ HTTP/1.1\" 404 143 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-10 14:17:20"}
{"level":"info","message":"GET /api//health","service":"payment-service","timestamp":"2025-03-10 14:17:33"}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:12:17:33 +0000] \"GET /api//health HTTP/1.1\" 404 150 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-10 14:17:33"}
{"level":"info","message":"GET /api/payouts/educators/edu_123/pending","service":"payment-service","timestamp":"2025-03-10 14:18:47"}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:12:18:47 +0000] \"GET /api/payouts/educators/edu_123/pending HTTP/1.1\" 404 176 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-10 14:18:47"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 14:19:14"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 14:19:15"}
{"level":"info","message":"GET /api/payouts/educators/edu_123/pending","service":"payment-service","timestamp":"2025-03-10 14:19:24"}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:12:19:24 +0000] \"GET /api/payouts/educators/edu_123/pending HTTP/1.1\" 404 176 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-10 14:19:24"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 14:20:15"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 14:20:15"}
{"level":"info","message":"GET /api/payouts/educators/edu_123/pending","service":"payment-service","timestamp":"2025-03-10 14:20:25"}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:12:20:25 +0000] \"GET /api/payouts/educators/edu_123/pending HTTP/1.1\" 404 176 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-10 14:20:25"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 14:22:22"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 14:22:22"}
{"level":"info","message":"GET /api/payouts/educators/edu_123/pending","service":"payment-service","timestamp":"2025-03-10 14:22:54"}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:12:22:54 +0000] \"GET /api/payouts/educators/edu_123/pending HTTP/1.1\" 200 248 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-10 14:22:54"}
{"level":"info","message":"POST /api/payments/refund","service":"payment-service","timestamp":"2025-03-10 14:28:32"}
{"data":{"action":"REMOVE_ENROLLMENT","courseId":"course_1","transactionId":"1fd0ad40-abad-4cad-ba87-8227f9d14d38","userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"mock-user-id\",\"action\":\"REMOVE_ENROLLMENT\",\"courseId\":\"course_1\",\"transactionId\":\"1fd0ad40-abad-4cad-ba87-8227f9d14d38\"}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"131","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processRefund (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:299:5)\n    at async processRefund (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:26:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-10 14:28:34"}
{"data":{"action":"RECORD_REFUND","amount":99.99,"courseId":"course_1","educatorEarnings":-79.99199999999999,"userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"courseId\":\"course_1\",\"action\":\"RECORD_REFUND\",\"userId\":\"mock-user-id\",\"amount\":99.99,\"educatorEarnings\":-79.99199999999999}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"125","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3002/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3002","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3002\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyCourseService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:41:5)\n    at async Object.processRefund (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:306:5)\n    at async processRefund (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:26:20)"},"level":"error","message":"Failed to notify course service: connect ECONNREFUSED ::1:3002","service":"payment-service","timestamp":"2025-03-10 14:28:34"}
{"data":{"action":"EARNINGS_REFUNDED","data":{"amount":79.99199999999999,"courseId":"course_1","reason":"requested_by_customer","totalPendingEarnings":-79.99199999999999,"transactionId":"1fd0ad40-abad-4cad-ba87-8227f9d14d38"},"userId":"edu_123"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"edu_123\",\"action\":\"EARNINGS_REFUNDED\",\"data\":{\"courseId\":\"course_1\",\"transactionId\":\"1fd0ad40-abad-4cad-ba87-8227f9d14d38\",\"amount\":79.99199999999999,\"totalPendingEarnings\":-79.99199999999999,\"reason\":\"requested_by_customer\"}}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"237","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processRefund (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:315:5)\n    at async processRefund (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:26:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-10 14:28:34"}
{"action":"REFUND_PROCESSED","actor":"mock-user-id","level":"info","message":"AUDIT: REFUND_PROCESSED by mock-user-id - Refund of 99.99 USD processed for transaction 1db0e8c7-8ad5-4e59-b474-735f26c4befb","metadata":{"originalTransactionId":"1db0e8c7-8ad5-4e59-b474-735f26c4befb","reason":"requested_by_customer"},"service":"payment-service","timestamp":"2025-03-10 14:28:34","transactionId":"1fd0ad40-abad-4cad-ba87-8227f9d14d38"}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:12:28:34 +0000] \"POST /api/payments/refund HTTP/1.1\" 200 1355 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-10 14:28:34"}
{"level":"info","message":"GET /api/payouts/educators/edu_123/pending","service":"payment-service","timestamp":"2025-03-10 14:32:02"}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:12:32:02 +0000] \"GET /api/payouts/educators/edu_123/pending HTTP/1.1\" 200 228 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-10 14:32:02"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 14:36:54"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 14:36:55"}
{"level":"info","message":"GET /api/payouts/educators/edu_123/pending","service":"payment-service","timestamp":"2025-03-10 14:41:05"}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:12:41:05 +0000] \"GET /api/payouts/educators/edu_123/pending HTTP/1.1\" 200 228 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-10 14:41:05"}
{"level":"info","message":"GET /api/payouts/educators/edu_123/pending","service":"payment-service","timestamp":"2025-03-10 14:41:13"}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:12:41:13 +0000] \"GET /api/payouts/educators/edu_123/pending HTTP/1.1\" 200 228 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-10 14:41:13"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 14:41:22"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 14:41:22"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 14:42:03"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 14:42:03"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 14:43:35"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 14:43:35"}
{"level":"info","message":"GET /api/payouts/educators/edu_123/pending","service":"payment-service","timestamp":"2025-03-10 14:43:47"}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:12:43:47 +0000] \"GET /api/payouts/educators/edu_123/pending HTTP/1.1\" 200 226 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-10 14:43:47"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 14:47:59"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 14:47:59"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 14:48:19"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 14:48:19"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 14:48:25"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 14:48:29"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 14:48:29"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 14:48:33"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 14:48:34"}
{"level":"info","message":"GET /api/payouts/educators/edu_123/pending","service":"payment-service","timestamp":"2025-03-10 14:48:46"}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:12:48:46 +0000] \"GET /api/payouts/educators/edu_123/pending HTTP/1.1\" 200 194 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-10 14:48:46"}
{"level":"info","message":"GET /api/payouts/educators/edu_123/request","service":"payment-service","timestamp":"2025-03-10 14:49:01"}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:12:49:01 +0000] \"GET /api/payouts/educators/edu_123/request HTTP/1.1\" 404 176 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-10 14:49:01"}
{"level":"info","message":"GET /api/payouts/educators/edu_123/request","service":"payment-service","timestamp":"2025-03-10 14:49:33"}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:12:49:33 +0000] \"GET /api/payouts/educators/edu_123/request HTTP/1.1\" 404 176 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-10 14:49:33"}
{"level":"info","message":"POST /api/payouts/educators/edu_123/request","service":"payment-service","timestamp":"2025-03-10 14:50:50"}
{"error":{"clientVersion":"6.4.1","name":"PrismaClientValidationError"},"level":"error","message":"Error requesting payout: \nInvalid `prisma.payout.create()` invocation in\nC:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\payoutService.js:108:40\n\n  105 });\n  106 \n  107 // Create the payout record\n→ 108 const payout = await prisma.payout.create({\n        data: {\n          payoutNumber: \"PAYOUT-2025-000001\",\n          educatorId: \"edu_123\",\n          status: \"PENDING\",\n          processingFee: 2.5,\n          paymentMethod: \"bank_transfer\",\n          bankDetails: undefined,\n          periodStart: new Date(\"2025-03-10T12:28:34.197Z\"),\n          periodEnd: new Date(\"2025-03-10T12:50:50.929Z\"),\n          notes: undefined,\n          metadata: {\n            requestedBy: \"edu_123\",\n            ipAddress: \"::ffff:127.0.0.1\"\n          },\n      +   amount: Float\n        }\n      })\n\nArgument `amount` is missing.","service":"payment-service","timestamp":"2025-03-10 14:50:50"}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:12:50:51 +0000] \"POST /api/payouts/educators/edu_123/request HTTP/1.1\" 500 397 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-10 14:50:51"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 14:54:31"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 14:54:31"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 14:54:59"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 14:54:59"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 14:55:18"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 14:55:18"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 14:55:29"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 14:55:29"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 14:56:11"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 14:56:11"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 14:56:41"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 14:56:41"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 14:58:26"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 14:58:26"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 15:00:50"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 15:01:12"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 15:01:12"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 15:01:55"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 15:01:55"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 15:02:12"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 15:02:12"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 15:02:30"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 15:02:30"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 15:02:41"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 15:02:41"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 15:02:44"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 15:02:44"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 15:02:48"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 15:02:48"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 15:02:59"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 15:02:59"}
{"level":"info","message":"POST /api/payouts/educators/edu_123/request","service":"payment-service","timestamp":"2025-03-10 15:04:52"}
{"level":"warn","message":"Validation failed: periodStart must be a date, periodEnd must be a date","service":"payment-service","timestamp":"2025-03-10 15:04:52"}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:13:04:52 +0000] \"POST /api/payouts/educators/edu_123/request HTTP/1.1\" 400 114 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-10 15:04:52"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 15:07:34"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 15:07:34"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 15:07:38"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 15:07:38"}
{"level":"info","message":"POST /api/payouts/educators/edu_123/request","service":"payment-service","timestamp":"2025-03-10 15:07:49"}
{"level":"warn","message":"Validation failed: periodStart must be a date, periodEnd must be a date","service":"payment-service","timestamp":"2025-03-10 15:07:49"}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:13:07:49 +0000] \"POST /api/payouts/educators/edu_123/request HTTP/1.1\" 400 114 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-10 15:07:49"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 15:08:09"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 15:08:09"}
{"level":"info","message":"POST /api/payouts/educators/edu_123/request","service":"payment-service","timestamp":"2025-03-10 15:08:20"}
{"level":"warn","message":"Validation failed: periodStart must be a date, periodEnd must be a date","service":"payment-service","timestamp":"2025-03-10 15:08:20"}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:13:08:20 +0000] \"POST /api/payouts/educators/edu_123/request HTTP/1.1\" 400 114 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-10 15:08:20"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 15:08:34"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 15:08:34"}
{"level":"info","message":"POST /api/payouts/educators/edu_123/request","service":"payment-service","timestamp":"2025-03-10 15:08:40"}
{"level":"warn","message":"Validation failed: periodStart must be a date, periodEnd must be a date","service":"payment-service","timestamp":"2025-03-10 15:08:41"}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:13:08:41 +0000] \"POST /api/payouts/educators/edu_123/request HTTP/1.1\" 400 114 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-10 15:08:41"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 15:08:55"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 15:08:56"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 15:09:04"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 15:09:04"}
{"level":"info","message":"POST /api/payouts/educators/edu_123/request","service":"payment-service","timestamp":"2025-03-10 15:09:17"}
{"level":"warn","message":"Validation failed: periodStart must be a date, periodEnd must be a date","service":"payment-service","timestamp":"2025-03-10 15:09:17"}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:13:09:17 +0000] \"POST /api/payouts/educators/edu_123/request HTTP/1.1\" 400 114 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-10 15:09:17"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 15:10:05"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 15:10:05"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 15:10:11"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 15:10:11"}
{"level":"info","message":"POST /api/payouts/educators/edu_123/request","service":"payment-service","timestamp":"2025-03-10 15:10:19"}
{"level":"warn","message":"Validation failed: periodStart must be a date, periodEnd must be a date","service":"payment-service","timestamp":"2025-03-10 15:10:19"}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:13:10:19 +0000] \"POST /api/payouts/educators/edu_123/request HTTP/1.1\" 400 114 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-10 15:10:19"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 15:10:29"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 15:10:29"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 15:11:12"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 15:11:12"}
{"level":"info","message":"POST /api/payouts/educators/edu_123/request","service":"payment-service","timestamp":"2025-03-10 15:11:41"}
{"level":"warn","message":"Validation failed: periodStart must be a date, periodEnd must be a date","service":"payment-service","timestamp":"2025-03-10 15:11:41"}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:13:11:41 +0000] \"POST /api/payouts/educators/edu_123/request HTTP/1.1\" 400 114 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-10 15:11:41"}
{"level":"info","message":"POST /api/payouts/educators/edu_123/request","service":"payment-service","timestamp":"2025-03-10 15:12:34"}
{"level":"warn","message":"Validation failed: periodStart must be a date, periodEnd must be a date","service":"payment-service","timestamp":"2025-03-10 15:12:34"}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:13:12:34 +0000] \"POST /api/payouts/educators/edu_123/request HTTP/1.1\" 400 114 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-10 15:12:34"}
{"level":"info","message":"POST /api/payouts/educators/edu_123/request","service":"payment-service","timestamp":"2025-03-10 15:12:37"}
{"level":"warn","message":"Validation failed: periodStart must be a date, periodEnd must be a date","service":"payment-service","timestamp":"2025-03-10 15:12:37"}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:13:12:37 +0000] \"POST /api/payouts/educators/edu_123/request HTTP/1.1\" 400 114 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-10 15:12:37"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 15:13:18"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 15:13:19"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 15:13:39"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 15:13:39"}
{"level":"info","message":"POST /api/payouts/educators/edu_123/request","service":"payment-service","timestamp":"2025-03-10 15:13:42"}
{"level":"warn","message":"Validation failed: periodStart must be a date, periodEnd must be a date","service":"payment-service","timestamp":"2025-03-10 15:13:42"}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:13:13:42 +0000] \"POST /api/payouts/educators/edu_123/request HTTP/1.1\" 400 114 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-10 15:13:42"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 15:13:54"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 15:13:54"}
{"level":"info","message":"POST /api/payouts/educators/edu_123/request","service":"payment-service","timestamp":"2025-03-10 15:14:04"}
{"level":"warn","message":"Validation failed: periodStart must be a date, periodEnd must be a date","service":"payment-service","timestamp":"2025-03-10 15:14:04"}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:13:14:04 +0000] \"POST /api/payouts/educators/edu_123/request HTTP/1.1\" 400 114 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-10 15:14:04"}
{"level":"info","message":"POST /api/payouts/educators/edu_123/request","service":"payment-service","timestamp":"2025-03-10 15:14:15"}
{"level":"warn","message":"Validation failed: periodStart must be a date, periodEnd must be a date","service":"payment-service","timestamp":"2025-03-10 15:14:15"}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:13:14:15 +0000] \"POST /api/payouts/educators/edu_123/request HTTP/1.1\" 400 114 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-10 15:14:15"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 15:14:31"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 15:14:32"}
{"level":"info","message":"POST /api/payouts/educators/edu_123/request","service":"payment-service","timestamp":"2025-03-10 15:14:36"}
{"level":"warn","message":"Validation failed: periodStart must be a date, periodEnd must be a date","service":"payment-service","timestamp":"2025-03-10 15:14:36"}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:13:14:36 +0000] \"POST /api/payouts/educators/edu_123/request HTTP/1.1\" 400 114 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-10 15:14:36"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 15:15:46"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 15:15:47"}
{"level":"info","message":"POST /api/payouts/educators/edu_123/request","service":"payment-service","timestamp":"2025-03-10 15:16:12"}
{"level":"warn","message":"Validation failed: periodStart must be a date, periodEnd must be a date","service":"payment-service","timestamp":"2025-03-10 15:17:19"}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:13:17:19 +0000] \"POST /api/payouts/educators/edu_123/request HTTP/1.1\" 400 114 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-10 15:17:19"}
{"level":"info","message":"POST /api/payouts/educators/edu_123/request","service":"payment-service","timestamp":"2025-03-10 15:17:50"}
{"level":"warn","message":"Validation failed: periodStart must be a date, periodEnd must be a date","service":"payment-service","timestamp":"2025-03-10 15:18:22"}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:13:18:22 +0000] \"POST /api/payouts/educators/edu_123/request HTTP/1.1\" 400 114 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-10 15:18:22"}
{"level":"info","message":"POST /api/payouts/educators/edu_123/request","service":"payment-service","timestamp":"2025-03-10 15:18:25"}
{"level":"warn","message":"Validation failed: periodStart must be a date, periodEnd must be a date","service":"payment-service","timestamp":"2025-03-10 15:19:22"}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:13:19:22 +0000] \"POST /api/payouts/educators/edu_123/request HTTP/1.1\" 400 114 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-10 15:19:22"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 15:20:49"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 15:20:49"}
{"level":"info","message":"POST /api/payouts/educators/edu_123/request","service":"payment-service","timestamp":"2025-03-10 15:21:10"}
{"level":"warn","message":"Validation failed: periodStart must be a date, periodEnd must be a date","service":"payment-service","timestamp":"2025-03-10 15:21:10"}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:13:21:10 +0000] \"POST /api/payouts/educators/edu_123/request HTTP/1.1\" 400 114 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-10 15:21:10"}
{"level":"info","message":"POST /api/payouts/educators/edu_123/request","service":"payment-service","timestamp":"2025-03-10 15:21:19"}
{"level":"warn","message":"Validation failed: periodStart must be a date, periodEnd must be a date","service":"payment-service","timestamp":"2025-03-10 15:21:19"}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:13:21:19 +0000] \"POST /api/payouts/educators/edu_123/request HTTP/1.1\" 400 114 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-10 15:21:19"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 15:21:52"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 15:21:52"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 15:22:05"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 15:22:05"}
{"level":"info","message":"POST /api/payouts/educators/edu_123/request","service":"payment-service","timestamp":"2025-03-10 15:22:12"}
{"level":"warn","message":"Validation failed: periodStart must be a date, periodEnd must be a date","service":"payment-service","timestamp":"2025-03-10 15:22:12"}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:13:22:12 +0000] \"POST /api/payouts/educators/edu_123/request HTTP/1.1\" 400 114 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-10 15:22:12"}
{"level":"info","message":"POST /api/payouts/educators/edu_123/request","service":"payment-service","timestamp":"2025-03-10 15:23:05"}
{"level":"warn","message":"Validation failed: periodStart must be a date, periodEnd must be a date","service":"payment-service","timestamp":"2025-03-10 15:23:05"}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:13:23:05 +0000] \"POST /api/payouts/educators/edu_123/request HTTP/1.1\" 400 114 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-10 15:23:05"}
{"level":"info","message":"POST /api/payouts/educators/edu_123/request","service":"payment-service","timestamp":"2025-03-10 15:23:15"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 15:24:46"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 15:24:46"}
{"level":"info","message":"POST /api/payouts/educators/edu_123/request","service":"payment-service","timestamp":"2025-03-10 15:24:51"}
{"level":"warn","message":"Validation failed: paymentMethod must be a string, bankDetails must be a object, description must be a string, periodStart must be a date, periodEnd must be a date, notes must be a string","service":"payment-service","timestamp":"2025-03-10 15:24:51"}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:13:24:51 +0000] \"POST /api/payouts/educators/edu_123/request HTTP/1.1\" 400 234 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-10 15:24:51"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 15:25:20"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 15:25:21"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 15:25:31"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 15:25:31"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 15:25:41"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 15:25:41"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 15:26:17"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 15:26:18"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 15:26:25"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 15:26:25"}
{"level":"info","message":"POST /api/payouts/educators/edu_123/request","service":"payment-service","timestamp":"2025-03-10 15:26:59"}
{"error":{"isOperational":true,"status":"fail","statusCode":400},"level":"error","message":"Error requesting payout: Insufficient balance. Available: $0","service":"payment-service","timestamp":"2025-03-10 15:26:59"}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:13:26:59 +0000] \"POST /api/payouts/educators/edu_123/request HTTP/1.1\" 400 417 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-10 15:26:59"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-10 15:29:48"}
{"error":{"isOperational":true,"status":"fail","statusCode":400},"level":"error","message":"Payment processing error: User already enrolled in this course","service":"payment-service","timestamp":"2025-03-10 15:29:48"}
{"action":"PAYMENT_FAILED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_FAILED by mock-user-id - Payment of 100 USD failed for course 1","metadata":{"error":"User already enrolled in this course"},"service":"payment-service","timestamp":"2025-03-10 15:29:48","transactionId":null}
{"level":"error","message":"Error processing payment: Payment processing failed: User already enrolled in this course","service":"payment-service","timestamp":"2025-03-10 15:29:48"}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:13:29:48 +0000] \"POST /api/payments/ HTTP/1.1\" 400 93 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-10 15:29:48"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-10 15:29:57"}
{"level":"info","message":"Payment split: Amount: $100, Platform: $20, Educator: $80","service":"payment-service","timestamp":"2025-03-10 15:29:58"}
{"data":{"action":"ENROLL_USER","courseId":"3","transactionId":"14b4ec76-7c78-4833-a608-6ade135734df","userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"mock-user-id\",\"action\":\"ENROLL_USER\",\"courseId\":\"3\",\"transactionId\":\"14b4ec76-7c78-4833-a608-6ade135734df\"}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"118","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:87:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-10 15:29:58"}
{"data":{"action":"RECORD_PURCHASE","amount":100,"courseId":"3","educatorEarnings":80,"userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"courseId\":\"3\",\"action\":\"RECORD_PURCHASE\",\"userId\":\"mock-user-id\",\"amount\":100,\"educatorEarnings\":80}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"102","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3002/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3002","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3002\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyCourseService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:41:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:95:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify course service: connect ECONNREFUSED ::1:3002","service":"payment-service","timestamp":"2025-03-10 15:29:58"}
{"data":{"action":"NEW_EARNINGS","data":{"amount":80,"courseId":"3","totalPendingEarnings":0.008000000000009777,"transactionId":"14b4ec76-7c78-4833-a608-6ade135734df"},"userId":"edu_123"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"edu_123\",\"action\":\"NEW_EARNINGS\",\"data\":{\"courseId\":\"3\",\"transactionId\":\"14b4ec76-7c78-4833-a608-6ade135734df\",\"amount\":80,\"totalPendingEarnings\":0.008000000000009777}}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"179","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:104:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-10 15:29:58"}
{"action":"PAYMENT_PROCESSED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_PROCESSED by mock-user-id - Payment of 100 USD processed for course 3","metadata":{"stripeChargeId":"ch_3R16P3DxY1cZtFZH0CNCPAJD"},"service":"payment-service","timestamp":"2025-03-10 15:29:58","transactionId":"14b4ec76-7c78-4833-a608-6ade135734df"}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:13:29:58 +0000] \"POST /api/payments/ HTTP/1.1\" 200 1142 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-10 15:29:58"}
{"level":"info","message":"GET /api/payouts/educators/edu_123/pending","service":"payment-service","timestamp":"2025-03-10 15:30:16"}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:13:30:16 +0000] \"GET /api/payouts/educators/edu_123/pending HTTP/1.1\" 200 218 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-10 15:30:16"}
{"level":"info","message":"POST /api/payouts/educators/edu_123/request","service":"payment-service","timestamp":"2025-03-10 15:30:33"}
{"error":{"isOperational":true,"status":"fail","statusCode":400},"level":"error","message":"Error requesting payout: Insufficient balance. Available: $80","service":"payment-service","timestamp":"2025-03-10 15:30:34"}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:13:30:34 +0000] \"POST /api/payouts/educators/edu_123/request HTTP/1.1\" 400 419 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-10 15:30:34"}
{"level":"info","message":"POST /api/payouts/educators/edu_123/request","service":"payment-service","timestamp":"2025-03-10 15:30:48"}
{"action":"PAYOUT_REQUESTED","actor":"edu_123","level":"info","message":"AUDIT: PAYOUT_REQUESTED by edu_123 - Payout of $80 requested by educator edu_123","metadata":{"payoutId":"dddc873d-8331-40a5-9b9f-add4980ad803"},"service":"payment-service","timestamp":"2025-03-10 15:30:48","transactionId":null}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:13:30:48 +0000] \"POST /api/payouts/educators/edu_123/request HTTP/1.1\" 201 705 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-10 15:30:48"}
{"level":"info","message":"POST /api/payouts/educators/edu_123/request","service":"payment-service","timestamp":"2025-03-10 16:09:09"}
{"action":"PAYOUT_REQUESTED","actor":"edu_123","level":"info","message":"AUDIT: PAYOUT_REQUESTED by edu_123 - Payout of $80 requested by educator edu_123","metadata":{"payoutId":"de014aac-ba12-411d-a0af-44416d65490f"},"service":"payment-service","timestamp":"2025-03-10 16:09:09","transactionId":null}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:14:09:09 +0000] \"POST /api/payouts/educators/edu_123/request HTTP/1.1\" 201 705 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-10 16:09:09"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 18:50:31"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 18:50:31"}
{"level":"info","message":"POST /api/payouts/educators/edu_123/request","service":"payment-service","timestamp":"2025-03-10 18:50:38"}
{"action":"PAYOUT_REQUESTED","actor":"edu_123","level":"info","message":"AUDIT: PAYOUT_REQUESTED by edu_123 - Payout of $80 requested by educator edu_123","metadata":{"payoutId":"aedbeaf3-8d8c-4e98-b1c2-79bc7ead51d9"},"service":"payment-service","timestamp":"2025-03-10 18:50:38","transactionId":null}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:16:50:38 +0000] \"POST /api/payouts/educators/edu_123/request HTTP/1.1\" 201 705 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-10 18:50:38"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 18:55:37"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 18:55:37"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 18:55:44"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 18:55:44"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 18:55:56"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 18:55:57"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 18:56:07"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 18:56:07"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 18:56:16"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 18:56:16"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 18:56:26"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 18:56:26"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 18:57:11"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 18:57:11"}
{"level":"info","message":"POST /api/payouts/educators/edu_123/request","service":"payment-service","timestamp":"2025-03-10 18:57:19"}
{"error":{"isOperational":true,"status":"fail","statusCode":400},"level":"error","message":"Error requesting payout: You already have a pending payout request","service":"payment-service","timestamp":"2025-03-10 18:57:19"}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:16:57:19 +0000] \"POST /api/payouts/educators/edu_123/request HTTP/1.1\" 400 429 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-10 18:57:19"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 18:57:30"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 18:57:31"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 18:57:33"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 18:57:33"}
{"level":"info","message":"POST /api/payouts/educators/edu_123/request","service":"payment-service","timestamp":"2025-03-10 18:59:07"}
{"action":"PAYOUT_REQUESTED","actor":"edu_123","level":"info","message":"AUDIT: PAYOUT_REQUESTED by edu_123 - Payout of $80 requested by educator edu_123","metadata":{"payoutId":"e24e2007-cf19-4b36-add9-e517cbece67a"},"service":"payment-service","timestamp":"2025-03-10 18:59:07","transactionId":null}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:16:59:07 +0000] \"POST /api/payouts/educators/edu_123/request HTTP/1.1\" 201 705 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-10 18:59:07"}
{"level":"info","message":"GET /api/payouts/e24e2007-cf19-4b36-add9-e517cbece67a","service":"payment-service","timestamp":"2025-03-10 19:00:12"}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:17:00:12 +0000] \"GET /api/payouts/e24e2007-cf19-4b36-add9-e517cbece67a HTTP/1.1\" 200 673 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-10 19:00:12"}
{"level":"info","message":"POST /api/payouts/e24e2007-cf19-4b36-add9-e517cbece67a/process","service":"payment-service","timestamp":"2025-03-10 19:02:40"}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:17:02:40 +0000] \"POST /api/payouts/e24e2007-cf19-4b36-add9-e517cbece67a/process HTTP/1.1\" 403 1566 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-10 19:02:40"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 19:03:23"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 19:03:23"}
{"level":"info","message":"POST /api/payouts/e24e2007-cf19-4b36-add9-e517cbece67a/process","service":"payment-service","timestamp":"2025-03-10 19:03:31"}
{"data":{"action":"PAYOUT_COMPLETED","data":{"amount":80,"payoutId":"e24e2007-cf19-4b36-add9-e517cbece67a","payoutNumber":"PAYOUT-2025-000001"},"userId":"edu_123"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"edu_123\",\"action\":\"PAYOUT_COMPLETED\",\"data\":{\"payoutId\":\"e24e2007-cf19-4b36-add9-e517cbece67a\",\"amount\":80,\"payoutNumber\":\"PAYOUT-2025-000001\"}}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"155","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayout (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\payoutService.js:285:7)\n    at async processPayout (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\payoutController.js:72:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-10 19:03:31"}
{"action":"PAYOUT_PROCESSED","actor":"edu_123","level":"info","message":"AUDIT: PAYOUT_PROCESSED by edu_123 - Payout PAYOUT-2025-000001 of $80 for educator edu_123 has been processed","metadata":{"payoutId":"e24e2007-cf19-4b36-add9-e517cbece67a"},"service":"payment-service","timestamp":"2025-03-10 19:03:31","transactionId":null}
{"level":"info","message":"::ffff:127.0.0.1 - - [10/Mar/2025:17:03:31 +0000] \"POST /api/payouts/e24e2007-cf19-4b36-add9-e517cbece67a/process HTTP/1.1\" 200 2088 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-10 19:03:31"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 20:09:22"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 20:09:22"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 20:13:51"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 20:13:51"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 20:15:39"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 20:15:39"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 20:15:43"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 20:15:44"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 20:15:46"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 20:15:47"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 20:26:57"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 20:26:57"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-10 20:27:46"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-10 20:27:46"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-11 14:46:52"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-11 14:46:53"}
{"level":"info","message":"POST /api/payouts/create-account","service":"payment-service","timestamp":"2025-03-11 14:47:05"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-11 14:47:06"}
{"level":"info","message":"::ffff:127.0.0.1 - - [11/Mar/2025:12:47:23 +0000] \"POST /api/payouts/create-account HTTP/1.1\" - - \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-11 14:47:23"}
{"level":"info","message":"POST /api/payouts/create-account","service":"payment-service","timestamp":"2025-03-11 14:47:47"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-11 14:47:47"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-11 14:48:28"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-11 14:48:28"}
{"level":"info","message":"POST /api/payouts/create-account","service":"payment-service","timestamp":"2025-03-11 14:48:37"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-11 14:48:37"}
{"level":"info","message":"::ffff:127.0.0.1 - - [11/Mar/2025:12:48:42 +0000] \"POST /api/payouts/create-account HTTP/1.1\" - - \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-11 14:48:42"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-11 14:48:49"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-11 14:48:49"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-11 14:48:57"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-11 14:48:57"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-11 14:50:23"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-11 14:50:23"}
{"level":"info","message":"POST /api/payouts/create-account","service":"payment-service","timestamp":"2025-03-11 14:50:50"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-11 14:50:51"}
{"level":"info","message":"::ffff:127.0.0.1 - - [11/Mar/2025:12:51:05 +0000] \"POST /api/payouts/create-account HTTP/1.1\" - - \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-11 14:51:05"}
{"level":"info","message":"GET /api/payments/14b4ec76-7c78-4833-a608-6ade135734df","service":"payment-service","timestamp":"2025-03-11 14:56:18"}
{"level":"info","message":"::ffff:127.0.0.1 - - [11/Mar/2025:12:56:19 +0000] \"GET /api/payments/14b4ec76-7c78-4833-a608-6ade135734df HTTP/1.1\" 200 1102 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-11 14:56:19"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-11 14:58:04"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-11 14:58:04"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-11 14:58:12"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-11 14:58:12"}
{"level":"info","message":"POST /api/payouts/create-account","service":"payment-service","timestamp":"2025-03-11 14:58:24"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-11 14:58:25"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-11 14:58:48"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-11 14:58:48"}
{"level":"info","message":"POST /api/payouts/create-account","service":"payment-service","timestamp":"2025-03-11 14:58:54"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-11 14:58:55"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-11 14:59:31"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-11 14:59:31"}
{"level":"info","message":"POST /api/payouts/create-account","service":"payment-service","timestamp":"2025-03-11 14:59:56"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-11 15:01:13"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-11 15:01:13"}
{"level":"info","message":"POST /api/payouts/create-account","service":"payment-service","timestamp":"2025-03-11 15:02:07"}
{"level":"error","message":"Stripe Connect is not configured properly","service":"payment-service","timestamp":"2025-03-11 15:02:07"}
{"error":{"isOperational":true,"status":"fail","statusCode":400},"level":"error","message":"Error creating Stripe account: Stripe Connect is not enabled for this account. Please set up Stripe Connect first: https://stripe.com/docs/connect","service":"payment-service","timestamp":"2025-03-11 15:02:07"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-11 15:02:07"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-11 15:10:34"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-11 15:10:34"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-11 15:11:23"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-11 15:11:23"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-11 15:11:49"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-11 15:11:50"}
{"level":"info","message":"POST /api/payouts/create-account","service":"payment-service","timestamp":"2025-03-11 15:11:58"}
{"level":"error","message":"Stripe Connect is not configured properly","service":"payment-service","timestamp":"2025-03-11 15:11:58"}
{"error":{"isOperational":true,"status":"fail","statusCode":400},"level":"error","message":"Error creating Stripe account: Stripe Connect is not enabled for this account. Please set up Stripe Connect first: https://stripe.com/docs/connect","service":"payment-service","timestamp":"2025-03-11 15:11:58"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-11 15:11:58"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-11 15:12:32"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-11 15:12:33"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-11 15:13:03"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-11 15:13:03"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-11 15:13:38"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-11 15:13:38"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-11 15:14:56"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-11 15:14:56"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-11 15:23:42"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-11 15:23:42"}
{"level":"info","message":"POST /api/payouts/create-account","service":"payment-service","timestamp":"2025-03-11 15:23:48"}
{"error":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"304","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=AEu-CUjZWg7d7FSneXyBUKechtzoAxtberqIdC7-06KWuZLVI8_xBo9ATKTL0wlsN__m7e8ltEiDjEZp","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Tue, 11 Mar 2025 13:23:48 GMT","idempotency-key":"d17307be-aca2-474a-8175-efefd6183543","original-request":"req_s7D6oejDGpFxLz","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_s7D6oejDGpFxLz","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"raw":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"304","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=AEu-CUjZWg7d7FSneXyBUKechtzoAxtberqIdC7-06KWuZLVI8_xBo9ATKTL0wlsN__m7e8ltEiDjEZp","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Tue, 11 Mar 2025 13:23:48 GMT","idempotency-key":"d17307be-aca2-474a-8175-efefd6183543","original-request":"req_s7D6oejDGpFxLz","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_s7D6oejDGpFxLz","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"You can only create new accounts if you've signed up for Connect, which you can learn how to do at https://stripe.com/docs/connect.","requestId":"req_s7D6oejDGpFxLz","request_log_url":"https://dashboard.stripe.com/test/logs/req_s7D6oejDGpFxLz?t=1741699428","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_s7D6oejDGpFxLz","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Error creating Stripe account: You can only create new accounts if you've signed up for Connect, which you can learn how to do at https://stripe.com/docs/connect.","service":"payment-service","timestamp":"2025-03-11 15:23:49"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-11 15:23:49"}
{"level":"info","message":"::ffff:127.0.0.1 - - [11/Mar/2025:13:24:07 +0000] \"POST /api/payouts/create-account HTTP/1.1\" - - \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-11 15:24:07"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-11 15:24:24"}
{"level":"info","message":"Payment split: Amount: $100, Platform: $20, Educator: $80","service":"payment-service","timestamp":"2025-03-11 15:24:25"}
{"data":{"action":"ENROLL_USER","courseId":"4","transactionId":"a750e456-0098-4b74-8ce2-e7a8c69fb3c3","userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"mock-user-id\",\"action\":\"ENROLL_USER\",\"courseId\":\"4\",\"transactionId\":\"a750e456-0098-4b74-8ce2-e7a8c69fb3c3\"}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"118","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:102:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-11 15:24:25"}
{"data":{"action":"RECORD_PURCHASE","amount":100,"courseId":"4","educatorEarnings":80,"userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"courseId\":\"4\",\"action\":\"RECORD_PURCHASE\",\"userId\":\"mock-user-id\",\"amount\":100,\"educatorEarnings\":80}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"102","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3002/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3002","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3002\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyCourseService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:41:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:110:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify course service: connect ECONNREFUSED ::1:3002","service":"payment-service","timestamp":"2025-03-11 15:24:25"}
{"data":{"action":"NEW_EARNINGS","data":{"amount":80,"courseId":"4","totalPendingEarnings":80,"transactionId":"a750e456-0098-4b74-8ce2-e7a8c69fb3c3"},"userId":"edu_123"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"edu_123\",\"action\":\"NEW_EARNINGS\",\"data\":{\"courseId\":\"4\",\"transactionId\":\"a750e456-0098-4b74-8ce2-e7a8c69fb3c3\",\"amount\":80,\"totalPendingEarnings\":80}}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"161","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:119:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-11 15:24:25"}
{"action":"PAYMENT_PROCESSED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_PROCESSED by mock-user-id - Payment of 100 USD processed for course 4","metadata":{"stripeChargeId":"ch_3R1SnDDxY1cZtFZH0y2utXhj"},"service":"payment-service","timestamp":"2025-03-11 15:24:25","transactionId":"a750e456-0098-4b74-8ce2-e7a8c69fb3c3"}
{"level":"info","message":"::ffff:127.0.0.1 - - [11/Mar/2025:13:24:25 +0000] \"POST /api/payments/ HTTP/1.1\" 200 1142 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-11 15:24:25"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-11 15:25:09"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-11 15:25:09"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-11 15:25:16"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-11 15:25:16"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-11 15:26:26"}
{"error":{"isOperational":true,"status":"fail","statusCode":400},"level":"error","message":"Payment processing error: User already enrolled in this course","service":"payment-service","timestamp":"2025-03-11 15:26:26"}
{"action":"PAYMENT_FAILED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_FAILED by mock-user-id - Payment of 100 USD failed for course 4","metadata":{"error":"User already enrolled in this course"},"service":"payment-service","timestamp":"2025-03-11 15:26:26","transactionId":null}
{"level":"error","message":"Error processing payment: Payment processing failed: User already enrolled in this course","service":"payment-service","timestamp":"2025-03-11 15:26:26"}
{"level":"info","message":"::ffff:127.0.0.1 - - [11/Mar/2025:13:26:26 +0000] \"POST /api/payments/ HTTP/1.1\" 400 93 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-11 15:26:26"}
{"level":"info","message":"POST /api/payouts/create-account","service":"payment-service","timestamp":"2025-03-11 15:27:00"}
{"error":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"304","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=9fEhwzG6z0-KOPyqfYlEbeSRAKNG5xBqxCtG8UMWA5BwlDLuSlPfJVjPnBetY6XoRmkghNxGlccELXS9","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Tue, 11 Mar 2025 13:27:00 GMT","idempotency-key":"5d31acba-f2f4-4e5b-bffc-0a36cc4cef1b","original-request":"req_zpc2YGkdIoI3L9","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_zpc2YGkdIoI3L9","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"raw":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"304","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=9fEhwzG6z0-KOPyqfYlEbeSRAKNG5xBqxCtG8UMWA5BwlDLuSlPfJVjPnBetY6XoRmkghNxGlccELXS9","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Tue, 11 Mar 2025 13:27:00 GMT","idempotency-key":"5d31acba-f2f4-4e5b-bffc-0a36cc4cef1b","original-request":"req_zpc2YGkdIoI3L9","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_zpc2YGkdIoI3L9","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"You can only create new accounts if you've signed up for Connect, which you can learn how to do at https://stripe.com/docs/connect.","requestId":"req_zpc2YGkdIoI3L9","request_log_url":"https://dashboard.stripe.com/test/logs/req_zpc2YGkdIoI3L9?t=1741699620","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_zpc2YGkdIoI3L9","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Error creating Stripe account: You can only create new accounts if you've signed up for Connect, which you can learn how to do at https://stripe.com/docs/connect.","service":"payment-service","timestamp":"2025-03-11 15:27:01"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-11 15:27:01"}
{"level":"info","message":"::ffff:127.0.0.1 - - [11/Mar/2025:13:27:01 +0000] \"POST /api/payouts/create-account HTTP/1.1\" - - \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-11 15:27:01"}
{"level":"info","message":"POST /api/payouts/create-account","service":"payment-service","timestamp":"2025-03-11 15:27:10"}
{"error":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"304","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=9fEhwzG6z0-KOPyqfYlEbeSRAKNG5xBqxCtG8UMWA5BwlDLuSlPfJVjPnBetY6XoRmkghNxGlccELXS9","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Tue, 11 Mar 2025 13:27:09 GMT","idempotency-key":"6c589b65-0bca-431f-8d3a-5b735baf891c","original-request":"req_xLf5q6stIfnRzB","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_xLf5q6stIfnRzB","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"raw":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"304","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=9fEhwzG6z0-KOPyqfYlEbeSRAKNG5xBqxCtG8UMWA5BwlDLuSlPfJVjPnBetY6XoRmkghNxGlccELXS9","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Tue, 11 Mar 2025 13:27:09 GMT","idempotency-key":"6c589b65-0bca-431f-8d3a-5b735baf891c","original-request":"req_xLf5q6stIfnRzB","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_xLf5q6stIfnRzB","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"You can only create new accounts if you've signed up for Connect, which you can learn how to do at https://stripe.com/docs/connect.","requestId":"req_xLf5q6stIfnRzB","request_log_url":"https://dashboard.stripe.com/test/logs/req_xLf5q6stIfnRzB?t=1741699629","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_xLf5q6stIfnRzB","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Error creating Stripe account: You can only create new accounts if you've signed up for Connect, which you can learn how to do at https://stripe.com/docs/connect.","service":"payment-service","timestamp":"2025-03-11 15:27:10"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-11 15:27:10"}
{"level":"info","message":"::ffff:127.0.0.1 - - [11/Mar/2025:13:27:51 +0000] \"POST /api/payouts/create-account HTTP/1.1\" - - \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-11 15:27:51"}
{"level":"info","message":"POST /api/payouts/create-account","service":"payment-service","timestamp":"2025-03-11 15:27:53"}
{"error":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"304","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=9fEhwzG6z0-KOPyqfYlEbeSRAKNG5xBqxCtG8UMWA5BwlDLuSlPfJVjPnBetY6XoRmkghNxGlccELXS9","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Tue, 11 Mar 2025 13:27:53 GMT","idempotency-key":"e4bf8ecf-242d-453b-8eb0-8e947a4f477b","original-request":"req_3pNssjKNon6WCr","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_3pNssjKNon6WCr","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"raw":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"304","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=9fEhwzG6z0-KOPyqfYlEbeSRAKNG5xBqxCtG8UMWA5BwlDLuSlPfJVjPnBetY6XoRmkghNxGlccELXS9","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Tue, 11 Mar 2025 13:27:53 GMT","idempotency-key":"e4bf8ecf-242d-453b-8eb0-8e947a4f477b","original-request":"req_3pNssjKNon6WCr","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_3pNssjKNon6WCr","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"You can only create new accounts if you've signed up for Connect, which you can learn how to do at https://stripe.com/docs/connect.","requestId":"req_3pNssjKNon6WCr","request_log_url":"https://dashboard.stripe.com/test/logs/req_3pNssjKNon6WCr?t=1741699673","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_3pNssjKNon6WCr","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Error creating Stripe account: You can only create new accounts if you've signed up for Connect, which you can learn how to do at https://stripe.com/docs/connect.","service":"payment-service","timestamp":"2025-03-11 16:16:32"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-11 16:16:34"}
{"level":"info","message":"::ffff:127.0.0.1 - - [11/Mar/2025:14:16:34 +0000] \"POST /api/payouts/create-account HTTP/1.1\" - - \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-11 16:16:34"}
{"level":"info","message":"POST /api/payouts/create-account","service":"payment-service","timestamp":"2025-03-11 16:18:54"}
{"error":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"324","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=reEbI6gkGHrlevNK6lQVXk_e-2xoSNwiPtckEe_S_tQiDzTWC0FP9kd0ytMCUQ_WeGxdFR5GBrsT4vUO","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Tue, 11 Mar 2025 14:18:53 GMT","idempotency-key":"30246009-67aa-4e53-ba1f-054db060bd6d","original-request":"req_1QvRptrZDSv5It","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_1QvRptrZDSv5It","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"raw":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"324","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=reEbI6gkGHrlevNK6lQVXk_e-2xoSNwiPtckEe_S_tQiDzTWC0FP9kd0ytMCUQ_WeGxdFR5GBrsT4vUO","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Tue, 11 Mar 2025 14:18:53 GMT","idempotency-key":"30246009-67aa-4e53-ba1f-054db060bd6d","original-request":"req_1QvRptrZDSv5It","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_1QvRptrZDSv5It","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"Connected accounts in US cannot be created by platforms in AE. Please contact us via https://support.stripe.com/contact if you need further assistance.","requestId":"req_1QvRptrZDSv5It","request_log_url":"https://dashboard.stripe.com/test/logs/req_1QvRptrZDSv5It?t=1741702733","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_1QvRptrZDSv5It","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Error creating Stripe account: Connected accounts in US cannot be created by platforms in AE. Please contact us via https://support.stripe.com/contact if you need further assistance.","service":"payment-service","timestamp":"2025-03-11 16:18:54"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-11 16:18:54"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-11 16:19:35"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-11 16:19:35"}
{"level":"info","message":"POST /api/payouts/create-account","service":"payment-service","timestamp":"2025-03-11 16:23:02"}
{"error":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"391","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=O0ydwDwSBMHm3sYl7Yx1mD4uuRBoo6iGFDzUiJwG3lfSlBJtVAIAQIFqeL-n1ZYFJz690QDVyOrtXrI-","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Tue, 11 Mar 2025 14:23:02 GMT","idempotency-key":"4b70cae3-1328-4088-912b-c45022d6bb4b","original-request":"req_0KfnD4qb7UgJHG","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_0KfnD4qb7UgJHG","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"raw":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"391","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=O0ydwDwSBMHm3sYl7Yx1mD4uuRBoo6iGFDzUiJwG3lfSlBJtVAIAQIFqeL-n1ZYFJz690QDVyOrtXrI-","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Tue, 11 Mar 2025 14:23:02 GMT","idempotency-key":"4b70cae3-1328-4088-912b-c45022d6bb4b","original-request":"req_0KfnD4qb7UgJHG","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_0KfnD4qb7UgJHG","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"Platforms in AE cannot create accounts where the platform is loss-liable, due to risk control measures. Please refer to our guide (https://support.stripe.com/questions/connect-availability-in-the-uae) for more details.","requestId":"req_0KfnD4qb7UgJHG","request_log_url":"https://dashboard.stripe.com/test/logs/req_0KfnD4qb7UgJHG?t=1741702982","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_0KfnD4qb7UgJHG","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Error creating Stripe account: Platforms in AE cannot create accounts where the platform is loss-liable, due to risk control measures. Please refer to our guide (https://support.stripe.com/questions/connect-availability-in-the-uae) for more details.","service":"payment-service","timestamp":"2025-03-11 16:23:03"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-11 16:23:03"}
{"level":"info","message":"::ffff:127.0.0.1 - - [11/Mar/2025:14:23:32 +0000] \"POST /api/payouts/create-account HTTP/1.1\" - - \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-11 16:23:32"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-11 16:24:35"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-11 16:24:35"}
{"level":"info","message":"POST /api/payouts/create-account","service":"payment-service","timestamp":"2025-03-11 16:24:42"}
{"error":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"391","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=ewiqq4a0MBftKcsUjB0eu6nFikDGNPkMuLxGK6hBFAs4gG78AKVA3xNKRLiswV4VXHOf2h3yb0qmuQLK","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Tue, 11 Mar 2025 14:24:42 GMT","idempotency-key":"fede27d1-6aae-4c97-a7c6-582e45d00c4f","original-request":"req_IeSaHyIBfKPsWg","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_IeSaHyIBfKPsWg","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"raw":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"391","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=ewiqq4a0MBftKcsUjB0eu6nFikDGNPkMuLxGK6hBFAs4gG78AKVA3xNKRLiswV4VXHOf2h3yb0qmuQLK","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Tue, 11 Mar 2025 14:24:42 GMT","idempotency-key":"fede27d1-6aae-4c97-a7c6-582e45d00c4f","original-request":"req_IeSaHyIBfKPsWg","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_IeSaHyIBfKPsWg","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"Platforms in AE cannot create accounts where the platform is loss-liable, due to risk control measures. Please refer to our guide (https://support.stripe.com/questions/connect-availability-in-the-uae) for more details.","requestId":"req_IeSaHyIBfKPsWg","request_log_url":"https://dashboard.stripe.com/test/logs/req_IeSaHyIBfKPsWg?t=1741703082","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_IeSaHyIBfKPsWg","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Error creating Stripe account: Platforms in AE cannot create accounts where the platform is loss-liable, due to risk control measures. Please refer to our guide (https://support.stripe.com/questions/connect-availability-in-the-uae) for more details.","service":"payment-service","timestamp":"2025-03-11 16:24:43"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-11 16:24:43"}
{"level":"info","message":"::ffff:127.0.0.1 - - [11/Mar/2025:14:24:57 +0000] \"POST /api/payouts/create-account HTTP/1.1\" - - \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-11 16:24:57"}
{"level":"info","message":"Database connection closed","service":"payment-service","timestamp":"2025-03-11 16:35:04"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-11 16:50:38"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-11 16:50:38"}
{"level":"info","message":"POST /api/payouts/create-account","service":"payment-service","timestamp":"2025-03-11 16:52:17"}
{"error":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"658","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=3Ec1oU5qpc3DidwBVZvCBrgzHdjbCpLPFAkp3c4HR83RiBipF9Ax5xx16wTjwUBTWkou3EZBXqwy_KbV","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Tue, 11 Mar 2025 14:52:17 GMT","idempotency-key":"38cb3918-ab84-416f-a28c-80e4cb816a3a","original-request":"req_0yojWltyuhSO4Y","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_0yojWltyuhSO4Y","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"param":"requested_capabilities","raw":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"658","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=3Ec1oU5qpc3DidwBVZvCBrgzHdjbCpLPFAkp3c4HR83RiBipF9Ax5xx16wTjwUBTWkou3EZBXqwy_KbV","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Tue, 11 Mar 2025 14:52:17 GMT","idempotency-key":"38cb3918-ab84-416f-a28c-80e4cb816a3a","original-request":"req_0yojWltyuhSO4Y","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_0yojWltyuhSO4Y","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"When requesting the `transfers` capability for accounts in AE, you must either specify the `recipient` service agreement, or request the `card_payments` capability along with `transfers`. To specify the `recipient` service agreement, see https://stripe.com/docs/connect/service-agreement-types#choosing-type-with-api. For more information on cross-border transfers, see https://stripe.com/docs/connect/account-capabilities#transfers-cross-border.","param":"requested_capabilities","requestId":"req_0yojWltyuhSO4Y","request_log_url":"https://dashboard.stripe.com/test/logs/req_0yojWltyuhSO4Y?t=1741704737","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_0yojWltyuhSO4Y","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Error creating Stripe account: When requesting the `transfers` capability for accounts in AE, you must either specify the `recipient` service agreement, or request the `card_payments` capability along with `transfers`. To specify the `recipient` service agreement, see https://stripe.com/docs/connect/service-agreement-types#choosing-type-with-api. For more information on cross-border transfers, see https://stripe.com/docs/connect/account-capabilities#transfers-cross-border.","service":"payment-service","timestamp":"2025-03-11 16:52:18"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-11 16:52:18"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-11 16:52:53"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-11 16:52:54"}
{"level":"info","message":"POST /api/payouts/create-account","service":"payment-service","timestamp":"2025-03-11 16:56:38"}
{"error":{},"level":"error","message":"Error creating Stripe account: Cannot read properties of undefined (reading 'create')","service":"payment-service","timestamp":"2025-03-11 16:56:42"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-11 16:56:42"}
{"level":"info","message":"::ffff:127.0.0.1 - - [11/Mar/2025:14:59:30 +0000] \"POST /api/payouts/create-account HTTP/1.1\" - - \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-11 16:59:30"}
{"level":"info","message":"POST /api/payouts/create-account","service":"payment-service","timestamp":"2025-03-11 16:59:34"}
{"error":{},"level":"error","message":"Error creating Stripe account: Cannot read properties of undefined (reading 'create')","service":"payment-service","timestamp":"2025-03-11 17:00:49"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-11 17:00:49"}
{"level":"info","message":"::ffff:127.0.0.1 - - [11/Mar/2025:15:02:32 +0000] \"POST /api/payouts/create-account HTTP/1.1\" - - \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-11 17:02:32"}
{"level":"info","message":"POST /api/payouts/create-account","service":"payment-service","timestamp":"2025-03-11 17:02:39"}
{"error":{},"level":"error","message":"Error creating Stripe account: Cannot read properties of undefined (reading 'create')","service":"payment-service","timestamp":"2025-03-11 17:02:42"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-11 17:02:42"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-11 17:03:58"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-11 17:03:58"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-11 17:04:55"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-11 17:04:58"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-11 17:04:58"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-11 17:05:10"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-11 17:05:10"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-11 17:05:19"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-11 17:05:19"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-11 17:05:27"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-11 17:05:28"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-11 17:05:38"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-11 17:05:38"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-11 17:06:14"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-11 17:06:15"}
{"level":"info","message":"POST /api/payouts/create-account","service":"payment-service","timestamp":"2025-03-11 17:06:26"}
{"action":"STRIPE_ACCOUNT_CREATED","actor":"edu_123","level":"info","message":"AUDIT: STRIPE_ACCOUNT_CREATED by edu_123 - Stripe Connect account created for educator edu_123","metadata":{"accountId":"acct_1R1UNyPe6gqEZwQ4"},"service":"payment-service","timestamp":"2025-03-11 17:06:29","transactionId":null}
{"level":"info","message":"::ffff:127.0.0.1 - - [11/Mar/2025:15:06:29 +0000] \"POST /api/payouts/create-account HTTP/1.1\" 201 195 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-11 17:06:29"}
{"level":"info","message":"Database connection closed","service":"payment-service","timestamp":"2025-03-11 17:20:50"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-11 17:51:21"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-11 17:51:21"}
{"level":"info","message":"POST /api/payouts/create-account","service":"payment-service","timestamp":"2025-03-11 17:52:45"}
{"error":{"code":"url_invalid","doc_url":"https://stripe.com/docs/error-codes/url-invalid","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"319","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=VfMgaN6Jy4Oq6AaaUvMRt1HPPs-BVf9_uS6spxA3s4uea4b4gOsWUOLD0SScwy7ob_-U6dU3xkPA3edn","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Tue, 11 Mar 2025 15:52:45 GMT","idempotency-key":"5fb32e08-842d-4b85-9e3b-1f201e26fdf7","original-request":"req_i3YFNI5I62ICuE","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_i3YFNI5I62ICuE","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"param":"business_profile[url]","raw":{"code":"url_invalid","doc_url":"https://stripe.com/docs/error-codes/url-invalid","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"319","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=VfMgaN6Jy4Oq6AaaUvMRt1HPPs-BVf9_uS6spxA3s4uea4b4gOsWUOLD0SScwy7ob_-U6dU3xkPA3edn","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Tue, 11 Mar 2025 15:52:45 GMT","idempotency-key":"5fb32e08-842d-4b85-9e3b-1f201e26fdf7","original-request":"req_i3YFNI5I62ICuE","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_i3YFNI5I62ICuE","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"Not a valid URL","param":"business_profile[url]","requestId":"req_i3YFNI5I62ICuE","request_log_url":"https://dashboard.stripe.com/test/logs/req_i3YFNI5I62ICuE?t=1741708365","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_i3YFNI5I62ICuE","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Error creating Stripe account: Not a valid URL","service":"payment-service","timestamp":"2025-03-11 17:52:46"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-11 17:52:46"}
{"level":"info","message":"::ffff:127.0.0.1 - - [11/Mar/2025:15:54:06 +0000] \"POST /api/payouts/create-account HTTP/1.1\" - - \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-11 17:54:06"}
{"level":"info","message":"POST /api/payouts/create-account","service":"payment-service","timestamp":"2025-03-11 17:54:10"}
{"error":{"code":"url_invalid","doc_url":"https://stripe.com/docs/error-codes/url-invalid","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"319","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=VfMgaN6Jy4Oq6AaaUvMRt1HPPs-BVf9_uS6spxA3s4uea4b4gOsWUOLD0SScwy7ob_-U6dU3xkPA3edn","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Tue, 11 Mar 2025 15:54:09 GMT","idempotency-key":"bd1fa0ec-bb28-430b-82e2-94dba3fe5d11","original-request":"req_rtpXDBOdOCVrku","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_rtpXDBOdOCVrku","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"param":"business_profile[url]","raw":{"code":"url_invalid","doc_url":"https://stripe.com/docs/error-codes/url-invalid","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"319","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=VfMgaN6Jy4Oq6AaaUvMRt1HPPs-BVf9_uS6spxA3s4uea4b4gOsWUOLD0SScwy7ob_-U6dU3xkPA3edn","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Tue, 11 Mar 2025 15:54:09 GMT","idempotency-key":"bd1fa0ec-bb28-430b-82e2-94dba3fe5d11","original-request":"req_rtpXDBOdOCVrku","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_rtpXDBOdOCVrku","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"Not a valid URL","param":"business_profile[url]","requestId":"req_rtpXDBOdOCVrku","request_log_url":"https://dashboard.stripe.com/test/logs/req_rtpXDBOdOCVrku?t=1741708449","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_rtpXDBOdOCVrku","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Error creating Stripe account: Not a valid URL","service":"payment-service","timestamp":"2025-03-11 17:54:10"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-11 17:54:10"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-11 17:54:27"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-11 17:54:27"}
{"level":"info","message":"POST /api/payouts/create-account","service":"payment-service","timestamp":"2025-03-11 17:54:35"}
{"error":{"code":"url_invalid","doc_url":"https://stripe.com/docs/error-codes/url-invalid","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"319","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=xNsagmISNjhBM4nC3EFk1jN-lPLjCSx6U2wVLY8bYJ8NIcQOh7jM2UK06TVrzOQQMBCLDGfg7qTubXzt","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Tue, 11 Mar 2025 15:54:35 GMT","idempotency-key":"5afa560f-0a48-4859-8803-f6ee45066616","original-request":"req_5hTqMCWP3n9QZ3","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_5hTqMCWP3n9QZ3","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"param":"business_profile[url]","raw":{"code":"url_invalid","doc_url":"https://stripe.com/docs/error-codes/url-invalid","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"319","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=xNsagmISNjhBM4nC3EFk1jN-lPLjCSx6U2wVLY8bYJ8NIcQOh7jM2UK06TVrzOQQMBCLDGfg7qTubXzt","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Tue, 11 Mar 2025 15:54:35 GMT","idempotency-key":"5afa560f-0a48-4859-8803-f6ee45066616","original-request":"req_5hTqMCWP3n9QZ3","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_5hTqMCWP3n9QZ3","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"Not a valid URL","param":"business_profile[url]","requestId":"req_5hTqMCWP3n9QZ3","request_log_url":"https://dashboard.stripe.com/test/logs/req_5hTqMCWP3n9QZ3?t=1741708475","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_5hTqMCWP3n9QZ3","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Error creating Stripe account: Not a valid URL","service":"payment-service","timestamp":"2025-03-11 17:54:35"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-11 17:54:35"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-11 17:55:12"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-11 17:55:12"}
{"level":"info","message":"POST /api/payouts/create-account","service":"payment-service","timestamp":"2025-03-11 17:55:18"}
{"action":"STRIPE_ACCOUNT_CREATED","actor":"edu_123","level":"info","message":"AUDIT: STRIPE_ACCOUNT_CREATED by edu_123 - Stripe Connect account created for educator edu_123","metadata":{"accountId":"acct_1R1V9GB7OPtLPqMx"},"service":"payment-service","timestamp":"2025-03-11 17:55:22","transactionId":null}
{"level":"info","message":"::ffff:127.0.0.1 - - [11/Mar/2025:15:55:22 +0000] \"POST /api/payouts/create-account HTTP/1.1\" 201 195 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-11 17:55:22"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 14:15:39"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 14:15:39"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 14:17:34"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 14:17:34"}
{"level":"info","message":"DELETE /api/payouts//delete-account","service":"payment-service","timestamp":"2025-03-12 14:18:39"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-12 14:18:39"}
{"level":"info","message":"::ffff:127.0.0.1 - - [12/Mar/2025:12:18:47 +0000] \"DELETE /api/payouts//delete-account HTTP/1.1\" - - \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-12 14:18:47"}
{"level":"info","message":"DELETE /api/payouts//delete-account","service":"payment-service","timestamp":"2025-03-12 14:19:21"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 14:20:08"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 14:20:08"}
{"level":"info","message":"DELETE /api/payouts//delete-account","service":"payment-service","timestamp":"2025-03-12 14:20:14"}
{"error":{"isOperational":true,"status":"fail","statusCode":404},"level":"error","message":"Error deleting educator account: Educator Stripe account not found","service":"payment-service","timestamp":"2025-03-12 14:20:14"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-12 14:20:14"}
{"level":"info","message":"::ffff:127.0.0.1 - - [12/Mar/2025:12:20:43 +0000] \"DELETE /api/payouts//delete-account HTTP/1.1\" - - \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-12 14:20:43"}
{"level":"info","message":"DELETE /api/payouts//delete-account","service":"payment-service","timestamp":"2025-03-12 14:21:28"}
{"error":{"isOperational":true,"status":"fail","statusCode":404},"level":"error","message":"Error deleting educator account: Educator Stripe account not found","service":"payment-service","timestamp":"2025-03-12 14:21:28"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-12 14:21:28"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 14:21:59"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 14:21:59"}
{"level":"info","message":"DELETE /api/payouts//delete-account","service":"payment-service","timestamp":"2025-03-12 14:22:05"}
{"action":"STRIPE_ACCOUNT_DELETED","actor":"edu_123","level":"info","message":"AUDIT: STRIPE_ACCOUNT_DELETED by edu_123 - Stripe Connect account deleted for educator edu_123","metadata":{"accountId":"acct_1R1V9GB7OPtLPqMx"},"service":"payment-service","timestamp":"2025-03-12 14:22:07","transactionId":null}
{"level":"info","message":"::ffff:127.0.0.1 - - [12/Mar/2025:12:22:07 +0000] \"DELETE /api/payouts//delete-account HTTP/1.1\" 200 64 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-12 14:22:07"}
{"level":"info","message":"DELETE /api/payouts//delete-account","service":"payment-service","timestamp":"2025-03-12 14:22:20"}
{"action":"STRIPE_ACCOUNT_DELETED","actor":"edu_123","level":"info","message":"AUDIT: STRIPE_ACCOUNT_DELETED by edu_123 - Stripe Connect account deleted for educator edu_123","metadata":{"accountId":"acct_1R1UEUB1gxfPcASb"},"service":"payment-service","timestamp":"2025-03-12 14:22:21","transactionId":null}
{"level":"info","message":"::ffff:127.0.0.1 - - [12/Mar/2025:12:22:21 +0000] \"DELETE /api/payouts//delete-account HTTP/1.1\" 200 64 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-12 14:22:21"}
{"level":"info","message":"DELETE /api/payouts//delete-account","service":"payment-service","timestamp":"2025-03-12 14:23:42"}
{"action":"STRIPE_ACCOUNT_DELETED","actor":"edu_123","level":"info","message":"AUDIT: STRIPE_ACCOUNT_DELETED by edu_123 - Stripe Connect account deleted for educator edu_123","metadata":{"accountId":"acct_1R1UNyPe6gqEZwQ4"},"service":"payment-service","timestamp":"2025-03-12 14:23:44","transactionId":null}
{"level":"info","message":"::ffff:127.0.0.1 - - [12/Mar/2025:12:23:44 +0000] \"DELETE /api/payouts//delete-account HTTP/1.1\" 200 64 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-12 14:23:44"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 14:27:32"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 14:27:32"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 14:27:58"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 14:27:58"}
{"level":"info","message":"DELETE /api/payouts//delete-account","service":"payment-service","timestamp":"2025-03-12 14:28:52"}
{"action":"STRIPE_ACCOUNT_DELETED","actor":"edu_123","level":"info","message":"AUDIT: STRIPE_ACCOUNT_DELETED by edu_123 - Stripe Connect account deleted for educator edu_123","metadata":{"accountId":"acct_1R1UKJBTpTW0i2zn"},"service":"payment-service","timestamp":"2025-03-12 14:28:55","transactionId":null}
{"level":"info","message":"::ffff:127.0.0.1 - - [12/Mar/2025:12:28:55 +0000] \"DELETE /api/payouts//delete-account HTTP/1.1\" 200 64 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-12 14:28:55"}
{"level":"info","message":"DELETE /api/payouts//delete-account","service":"payment-service","timestamp":"2025-03-12 14:29:13"}
{"action":"STRIPE_ACCOUNT_DELETED","actor":"edu_123","level":"info","message":"AUDIT: STRIPE_ACCOUNT_DELETED by edu_123 - Stripe Connect account deleted for educator edu_123","metadata":{"accountId":"acct_1R1UHPBGZdTKZu9J"},"service":"payment-service","timestamp":"2025-03-12 14:29:14","transactionId":null}
{"level":"info","message":"::ffff:127.0.0.1 - - [12/Mar/2025:12:29:15 +0000] \"DELETE /api/payouts//delete-account HTTP/1.1\" 200 64 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-12 14:29:15"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 14:30:56"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 14:30:56"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 14:33:14"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 14:33:15"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 14:33:33"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 14:33:33"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 14:33:42"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 14:33:43"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 14:43:38"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 14:43:39"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 14:44:21"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 14:44:22"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 14:44:41"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 14:44:41"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 14:44:52"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 14:44:52"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 14:45:07"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 14:45:07"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 14:45:16"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 14:45:16"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 14:45:26"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 14:45:27"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 14:45:51"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 14:45:51"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 14:45:57"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 14:45:57"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 14:46:00"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 14:46:01"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 14:46:27"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 14:46:35"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 14:46:35"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 14:46:41"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 14:46:41"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 14:46:49"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 14:46:49"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 14:47:00"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 14:47:00"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 14:47:07"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 14:47:07"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 14:47:31"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 14:47:31"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 14:47:38"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 14:47:38"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 14:48:10"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 14:48:10"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 14:48:25"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 14:48:25"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 14:49:01"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 14:49:01"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 14:49:18"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 14:49:18"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 14:49:29"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 14:49:30"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 14:49:36"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 14:49:36"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 14:50:11"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 14:50:11"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 14:54:26"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 14:54:27"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 14:55:15"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 14:55:16"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 14:55:22"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 14:55:22"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-12 14:57:09"}
{"error":{"isOperational":true,"status":"fail","statusCode":400},"level":"error","message":"Payment processing error: Error happened","service":"payment-service","timestamp":"2025-03-12 14:57:10"}
{"action":"PAYMENT_FAILED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_FAILED by mock-user-id - Payment of 100 USD failed for course 1","metadata":{"error":"Error happened"},"service":"payment-service","timestamp":"2025-03-12 14:57:10","transactionId":null}
{"level":"error","message":"Error processing payment: Payment processing failed: Error happened","service":"payment-service","timestamp":"2025-03-12 14:57:10"}
{"level":"info","message":"::ffff:127.0.0.1 - - [12/Mar/2025:12:57:10 +0000] \"POST /api/payments/ HTTP/1.1\" 400 71 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-12 14:57:10"}
{"level":"info","message":"POST /api/payouts/create-account","service":"payment-service","timestamp":"2025-03-12 14:58:40"}
{"error":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"330","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=EGKHVeS8NPnBUjIZHR9XT2uCkv9gNOnQ_QkZ5vUuu-glS60SIAhjxlBadquYBrVyGxeTc4Utm7QtiKAY","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Wed, 12 Mar 2025 12:58:40 GMT","idempotency-key":"ae407bb0-7bc4-413a-92ed-5d4ab1495b33","original-request":"req_mCSABGWmhZgloK","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_mCSABGWmhZgloK","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"raw":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"330","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=EGKHVeS8NPnBUjIZHR9XT2uCkv9gNOnQ_QkZ5vUuu-glS60SIAhjxlBadquYBrVyGxeTc4Utm7QtiKAY","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Wed, 12 Mar 2025 12:58:40 GMT","idempotency-key":"ae407bb0-7bc4-413a-92ed-5d4ab1495b33","original-request":"req_mCSABGWmhZgloK","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_mCSABGWmhZgloK","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"You cannot accept the Terms of Service on behalf of accounts where `controller[requirement_collection]=stripe`, which includes Standard and Express accounts.","requestId":"req_mCSABGWmhZgloK","request_log_url":"https://dashboard.stripe.com/test/logs/req_mCSABGWmhZgloK?t=1741784320","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_mCSABGWmhZgloK","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Error creating Stripe account: You cannot accept the Terms of Service on behalf of accounts where `controller[requirement_collection]=stripe`, which includes Standard and Express accounts.","service":"payment-service","timestamp":"2025-03-12 14:58:41"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-12 14:58:41"}
{"level":"info","message":"::ffff:127.0.0.1 - - [12/Mar/2025:12:58:58 +0000] \"POST /api/payouts/create-account HTTP/1.1\" - - \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-12 14:58:58"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 15:01:19"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 15:01:20"}
{"level":"info","message":"POST /api/payouts/create-account","service":"payment-service","timestamp":"2025-03-12 15:02:13"}
{"action":"STRIPE_ACCOUNT_CREATED","actor":"edu_123","level":"info","message":"AUDIT: STRIPE_ACCOUNT_CREATED by edu_123 - Stripe Connect account created for educator edu_123","metadata":{"accountId":"acct_1R1ovJPbFNshYDFw"},"service":"payment-service","timestamp":"2025-03-12 15:02:19","transactionId":null}
{"level":"info","message":"::ffff:127.0.0.1 - - [12/Mar/2025:13:02:19 +0000] \"POST /api/payouts/create-account HTTP/1.1\" 201 109 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-12 15:02:19"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 15:06:17"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 15:06:17"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 15:06:32"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 15:06:32"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 15:06:47"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 15:06:47"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 15:06:56"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 15:06:56"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 15:07:03"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 15:07:04"}
{"level":"info","message":"DELETE /api/payouts//delete-account","service":"payment-service","timestamp":"2025-03-12 15:07:19"}
{"action":"STRIPE_ACCOUNT_DELETED","actor":"edu_123","level":"info","message":"AUDIT: STRIPE_ACCOUNT_DELETED by edu_123 - Stripe Connect account deleted for educator edu_123","metadata":{"accountId":"acct_1R1ovJPbFNshYDFw"},"service":"payment-service","timestamp":"2025-03-12 15:07:21","transactionId":null}
{"level":"info","message":"::ffff:127.0.0.1 - - [12/Mar/2025:13:07:21 +0000] \"DELETE /api/payouts//delete-account HTTP/1.1\" 200 64 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-12 15:07:21"}
{"level":"info","message":"POST /api/payouts/create-account","service":"payment-service","timestamp":"2025-03-12 15:08:07"}
{"error":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"352","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=AI-AyViINQcT19JM3qLK3esSRDFyuJuCIguParCrX0sKMsnoG_4WAhD8cF7RNhm_ryl-WTX9D0EEcwXV","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Wed, 12 Mar 2025 13:08:11 GMT","idempotency-key":"ac8f918b-5aa5-4ab3-908b-d49a3847c9ea","original-request":"req_4W3igs5xj15rOG","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_4W3igs5xj15rOG","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-account":"acct_1R1p10PfYq6iycrh","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"raw":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"352","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=AI-AyViINQcT19JM3qLK3esSRDFyuJuCIguParCrX0sKMsnoG_4WAhD8cF7RNhm_ryl-WTX9D0EEcwXV","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Wed, 12 Mar 2025 13:08:11 GMT","idempotency-key":"ac8f918b-5aa5-4ab3-908b-d49a3847c9ea","original-request":"req_4W3igs5xj15rOG","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_4W3igs5xj15rOG","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-account":"acct_1R1p10PfYq6iycrh","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"You cannot accept the Terms of Service on behalf of accounts where `controller[requirement_collection]=stripe`, which includes Standard and Express accounts.","requestId":"req_4W3igs5xj15rOG","request_log_url":"https://dashboard.stripe.com/acct_1R1p10PfYq6iycrh/test/logs/req_4W3igs5xj15rOG?t=1741784890","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_4W3igs5xj15rOG","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Error creating Stripe account: You cannot accept the Terms of Service on behalf of accounts where `controller[requirement_collection]=stripe`, which includes Standard and Express accounts.","service":"payment-service","timestamp":"2025-03-12 15:08:12"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-12 15:08:12"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 15:08:44"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 15:08:44"}
{"level":"info","message":"POST /api/payouts/create-account","service":"payment-service","timestamp":"2025-03-12 15:09:38"}
{"error":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"352","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=Xt_1bBSrPfUKZWS49YeOO2ce1c4g_GcHyAVfuFjSQeFAcY_fisNYE3LCOLVWM0djQXtDtLxdMkfYcq-d","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Wed, 12 Mar 2025 13:10:02 GMT","idempotency-key":"41346e8f-8964-4d67-897c-37a1fd9948e6","original-request":"req_Va4U5xnXU7hqts","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_Va4U5xnXU7hqts","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-account":"acct_1R1p2dB1KKzvBTJW","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"raw":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"352","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=Xt_1bBSrPfUKZWS49YeOO2ce1c4g_GcHyAVfuFjSQeFAcY_fisNYE3LCOLVWM0djQXtDtLxdMkfYcq-d","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Wed, 12 Mar 2025 13:10:02 GMT","idempotency-key":"41346e8f-8964-4d67-897c-37a1fd9948e6","original-request":"req_Va4U5xnXU7hqts","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_Va4U5xnXU7hqts","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-account":"acct_1R1p2dB1KKzvBTJW","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"You cannot accept the Terms of Service on behalf of accounts where `controller[requirement_collection]=stripe`, which includes Standard and Express accounts.","requestId":"req_Va4U5xnXU7hqts","request_log_url":"https://dashboard.stripe.com/acct_1R1p2dB1KKzvBTJW/test/logs/req_Va4U5xnXU7hqts?t=1741785002","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_Va4U5xnXU7hqts","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Error creating Stripe account: You cannot accept the Terms of Service on behalf of accounts where `controller[requirement_collection]=stripe`, which includes Standard and Express accounts.","service":"payment-service","timestamp":"2025-03-12 15:11:12"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-12 15:11:18"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 15:11:45"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 15:11:45"}
{"level":"info","message":"GET /api/payouts/e24e2007-cf19-4b36-add9-e517cbece67a","service":"payment-service","timestamp":"2025-03-12 15:12:09"}
{"level":"info","message":"::ffff:127.0.0.1 - - [12/Mar/2025:13:12:09 +0000] \"GET /api/payouts/e24e2007-cf19-4b36-add9-e517cbece67a HTTP/1.1\" 200 794 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-12 15:12:09"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 15:14:32"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 15:14:32"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-12 15:15:35"}
{"level":"info","message":"Payment split: Amount: $100, Platform: $20, Educator: $80","service":"payment-service","timestamp":"2025-03-12 15:15:36"}
{"error":{"code":"resource_missing","doc_url":"https://stripe.com/docs/error-codes/resource-missing","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"344","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=tGHAFLqXe-59qv_bKT1HxCHgtmSSVzRXceGDhAB4-MwFuEvoYj-MEh4I2-CruZtOz62Ho5UPZ9L1XcSv","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Wed, 12 Mar 2025 13:15:35 GMT","idempotency-key":"ca3b6088-36c8-4c37-8f6a-db88c1e7c06b","original-request":"req_eOBgDSYYfl0WUr","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_eOBgDSYYfl0WUr","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"param":"destination","raw":{"code":"resource_missing","doc_url":"https://stripe.com/docs/error-codes/resource-missing","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"344","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=tGHAFLqXe-59qv_bKT1HxCHgtmSSVzRXceGDhAB4-MwFuEvoYj-MEh4I2-CruZtOz62Ho5UPZ9L1XcSv","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Wed, 12 Mar 2025 13:15:35 GMT","idempotency-key":"ca3b6088-36c8-4c37-8f6a-db88c1e7c06b","original-request":"req_eOBgDSYYfl0WUr","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_eOBgDSYYfl0WUr","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"No such account: 'acct_1R1ovJPbFNshYDFw'","param":"destination","requestId":"req_eOBgDSYYfl0WUr","request_log_url":"https://dashboard.stripe.com/test/logs/req_eOBgDSYYfl0WUr?t=1741785335","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_eOBgDSYYfl0WUr","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Payment processing error: No such account: 'acct_1R1ovJPbFNshYDFw'","service":"payment-service","timestamp":"2025-03-12 15:15:36"}
{"action":"PAYMENT_FAILED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_FAILED by mock-user-id - Payment of 100 USD failed for course 1","metadata":{"error":"No such account: 'acct_1R1ovJPbFNshYDFw'"},"service":"payment-service","timestamp":"2025-03-12 15:15:36","transactionId":null}
{"level":"error","message":"Error processing payment: Payment processing failed: No such account: 'acct_1R1ovJPbFNshYDFw'","service":"payment-service","timestamp":"2025-03-12 15:15:36"}
{"level":"info","message":"::ffff:127.0.0.1 - - [12/Mar/2025:13:15:36 +0000] \"POST /api/payments/ HTTP/1.1\" 400 97 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-12 15:15:36"}
{"level":"info","message":"POST /api/payouts/create-account","service":"payment-service","timestamp":"2025-03-12 15:17:46"}
{"action":"STRIPE_ACCOUNT_CREATED","actor":"edu_123","level":"info","message":"AUDIT: STRIPE_ACCOUNT_CREATED by edu_123 - Stripe Connect account created for educator edu_123","metadata":{"accountId":"acct_1R1pAMBGLheFsQTo"},"service":"payment-service","timestamp":"2025-03-12 15:17:51","transactionId":null}
{"level":"info","message":"::ffff:127.0.0.1 - - [12/Mar/2025:13:17:51 +0000] \"POST /api/payouts/create-account HTTP/1.1\" 201 109 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-12 15:17:51"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-12 15:18:21"}
{"level":"info","message":"Payment split: Amount: $100, Platform: $20, Educator: $80","service":"payment-service","timestamp":"2025-03-12 15:18:21"}
{"error":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"253","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=BgXDUD3jHfznnjiOFYUDf2cdzJ2NzLZk-rUqsp7VKiC2K5j65S87e86WZkWbJYkxo-PM0Txk-_z0NNRR","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Wed, 12 Mar 2025 13:18:20 GMT","idempotency-key":"2d3e513d-9729-487a-8b58-bab9c62310fe","original-request":"req_2K959EsLKIEV3t","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_2K959EsLKIEV3t","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"raw":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"253","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=BgXDUD3jHfznnjiOFYUDf2cdzJ2NzLZk-rUqsp7VKiC2K5j65S87e86WZkWbJYkxo-PM0Txk-_z0NNRR","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Wed, 12 Mar 2025 13:18:20 GMT","idempotency-key":"2d3e513d-9729-487a-8b58-bab9c62310fe","original-request":"req_2K959EsLKIEV3t","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_2K959EsLKIEV3t","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"Only one of `application_fee_amount` and `destination[amount]` can be specified.","requestId":"req_2K959EsLKIEV3t","request_log_url":"https://dashboard.stripe.com/test/logs/req_2K959EsLKIEV3t?t=1741785500","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_2K959EsLKIEV3t","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Payment processing error: Only one of `application_fee_amount` and `destination[amount]` can be specified.","service":"payment-service","timestamp":"2025-03-12 15:18:21"}
{"action":"PAYMENT_FAILED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_FAILED by mock-user-id - Payment of 100 USD failed for course 1","metadata":{"error":"Only one of `application_fee_amount` and `destination[amount]` can be specified."},"service":"payment-service","timestamp":"2025-03-12 15:18:21","transactionId":null}
{"level":"error","message":"Error processing payment: Payment processing failed: Only one of `application_fee_amount` and `destination[amount]` can be specified.","service":"payment-service","timestamp":"2025-03-12 15:18:21"}
{"level":"info","message":"::ffff:127.0.0.1 - - [12/Mar/2025:13:18:21 +0000] \"POST /api/payments/ HTTP/1.1\" 400 137 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-12 15:18:21"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 15:20:00"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 15:20:01"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-12 15:20:18"}
{"level":"info","message":"Payment split: Amount: $100, Platform: $20, Educator: $80","service":"payment-service","timestamp":"2025-03-12 15:20:18"}
{"error":{"code":"insufficient_capabilities_for_transfer","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"362","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=eTYAZ4oWcMvt1TQKoE7kQRS7Iyq7qZ9aRDz7Ci5M7L7q-qNcMX-nUgKgxxWHGPc6qOhzi_hof6SkBLyo","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Wed, 12 Mar 2025 13:20:18 GMT","idempotency-key":"29389b05-d152-4cfd-97f7-1ed9a2a27231","original-request":"req_3JaylMvLbaLHkP","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_3JaylMvLbaLHkP","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"raw":{"code":"insufficient_capabilities_for_transfer","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"362","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=eTYAZ4oWcMvt1TQKoE7kQRS7Iyq7qZ9aRDz7Ci5M7L7q-qNcMX-nUgKgxxWHGPc6qOhzi_hof6SkBLyo","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Wed, 12 Mar 2025 13:20:18 GMT","idempotency-key":"29389b05-d152-4cfd-97f7-1ed9a2a27231","original-request":"req_3JaylMvLbaLHkP","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_3JaylMvLbaLHkP","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"Your destination account needs to have at least one of the following capabilities enabled: transfers, crypto_transfers, legacy_payments","requestId":"req_3JaylMvLbaLHkP","request_log_url":"https://dashboard.stripe.com/test/logs/req_3JaylMvLbaLHkP?t=1741785618","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_3JaylMvLbaLHkP","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Payment processing error: Your destination account needs to have at least one of the following capabilities enabled: transfers, crypto_transfers, legacy_payments","service":"payment-service","timestamp":"2025-03-12 15:20:19"}
{"action":"PAYMENT_FAILED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_FAILED by mock-user-id - Payment of 100 USD failed for course 1","metadata":{"error":"Your destination account needs to have at least one of the following capabilities enabled: transfers, crypto_transfers, legacy_payments"},"service":"payment-service","timestamp":"2025-03-12 15:20:19","transactionId":null}
{"level":"error","message":"Error processing payment: Payment processing failed: Your destination account needs to have at least one of the following capabilities enabled: transfers, crypto_transfers, legacy_payments","service":"payment-service","timestamp":"2025-03-12 15:20:19"}
{"level":"info","message":"::ffff:127.0.0.1 - - [12/Mar/2025:13:20:19 +0000] \"POST /api/payments/ HTTP/1.1\" 400 192 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-12 15:20:19"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 15:29:07"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 15:29:07"}
{"level":"info","message":"DELETE /api/payouts//delete-account","service":"payment-service","timestamp":"2025-03-12 15:31:47"}
{"action":"STRIPE_ACCOUNT_DELETED","actor":"edu_123","level":"info","message":"AUDIT: STRIPE_ACCOUNT_DELETED by edu_123 - Stripe Connect account deleted for educator edu_123","metadata":{"accountId":"acct_1R1pAMBGLheFsQTo"},"service":"payment-service","timestamp":"2025-03-12 15:31:50","transactionId":null}
{"level":"info","message":"::ffff:127.0.0.1 - - [12/Mar/2025:13:31:50 +0000] \"DELETE /api/payouts//delete-account HTTP/1.1\" 200 64 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-12 15:31:50"}
{"level":"info","message":"POST /api/payouts/create-account","service":"payment-service","timestamp":"2025-03-12 15:32:02"}
{"error":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"324","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=lMuWavtWO1Cc0hCXZK5qXE6CY0QzKQ0S_xpepFV3o9UWA967nENtRs5H1H58NPstioXFfp8UFU38Wugv","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Wed, 12 Mar 2025 13:32:02 GMT","idempotency-key":"5bb3eebe-2773-4c2e-8635-e0ad5aeca5a1","original-request":"req_MWX8kEFCKizPy2","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_MWX8kEFCKizPy2","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"raw":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"324","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=lMuWavtWO1Cc0hCXZK5qXE6CY0QzKQ0S_xpepFV3o9UWA967nENtRs5H1H58NPstioXFfp8UFU38Wugv","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Wed, 12 Mar 2025 13:32:02 GMT","idempotency-key":"5bb3eebe-2773-4c2e-8635-e0ad5aeca5a1","original-request":"req_MWX8kEFCKizPy2","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_MWX8kEFCKizPy2","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"Please review the responsibilities of collecting requirements for connected accounts at https://dashboard.stripe.com/settings/connect/platform-profile.","requestId":"req_MWX8kEFCKizPy2","request_log_url":"https://dashboard.stripe.com/test/logs/req_MWX8kEFCKizPy2?t=1741786321","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_MWX8kEFCKizPy2","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Error creating Stripe account: Please review the responsibilities of collecting requirements for connected accounts at https://dashboard.stripe.com/settings/connect/platform-profile.","service":"payment-service","timestamp":"2025-03-12 15:32:03"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-12 15:32:03"}
{"level":"info","message":"::ffff:127.0.0.1 - - [12/Mar/2025:13:54:57 +0000] \"POST /api/payouts/create-account HTTP/1.1\" - - \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-12 15:54:57"}
{"level":"info","message":"POST /api/payouts/create-account","service":"payment-service","timestamp":"2025-03-12 15:55:56"}
{"error":{"clientVersion":"6.4.1","code":"P2002","meta":{"modelName":"stripeAccount","target":["educatorId"]},"name":"PrismaClientKnownRequestError"},"level":"error","message":"Error creating Stripe account: \nInvalid `prisma.stripeAccount.create()` invocation in\nC:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\payoutService.js:601:62\n\n  598   }\n  599 );\n  600 \n→ 601 const educatorStripeAccount = await prisma.stripeAccount.create(\nUnique constraint failed on the fields: (`educatorId`)","service":"payment-service","timestamp":"2025-03-12 15:56:03"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-12 15:56:03"}
{"level":"info","message":"::ffff:127.0.0.1 - - [12/Mar/2025:13:57:21 +0000] \"POST /api/payouts/create-account HTTP/1.1\" - - \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-12 15:57:21"}
{"level":"info","message":"DELETE /api/payouts/delete-account","service":"payment-service","timestamp":"2025-03-12 15:58:32"}
{"action":"STRIPE_ACCOUNT_DELETED","actor":"edu_123","level":"info","message":"AUDIT: STRIPE_ACCOUNT_DELETED by edu_123 - Stripe Connect account deleted for educator edu_123","metadata":{"accountId":"acct_1R1plIBDoZ8j7IlL"},"service":"payment-service","timestamp":"2025-03-12 15:58:34","transactionId":null}
{"level":"info","message":"::ffff:127.0.0.1 - - [12/Mar/2025:13:58:34 +0000] \"DELETE /api/payouts/delete-account HTTP/1.1\" 200 64 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-12 15:58:34"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 15:59:34"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 15:59:34"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 15:59:41"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 15:59:42"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 15:59:47"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 15:59:47"}
{"level":"info","message":"POST /api/payouts/create-account","service":"payment-service","timestamp":"2025-03-12 16:00:13"}
{"action":"STRIPE_ACCOUNT_CREATED","actor":"edu_123","level":"info","message":"AUDIT: STRIPE_ACCOUNT_CREATED by edu_123 - Stripe Connect account created for educator edu_123","metadata":{"accountId":"acct_1R1ppRPWoytzXOqP"},"service":"payment-service","timestamp":"2025-03-12 16:00:24","transactionId":null}
{"level":"info","message":"::ffff:127.0.0.1 - - [12/Mar/2025:14:00:24 +0000] \"POST /api/payouts/create-account HTTP/1.1\" 201 109 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-12 16:00:24"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 16:05:09"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 16:05:09"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 16:05:36"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 16:05:36"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 16:05:52"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 16:05:52"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 16:06:12"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 16:06:12"}
{"level":"info","message":"DELETE /api/payouts/delete-account","service":"payment-service","timestamp":"2025-03-12 16:06:26"}
{"action":"STRIPE_ACCOUNT_DELETED","actor":"edu_123","level":"info","message":"AUDIT: STRIPE_ACCOUNT_DELETED by edu_123 - Stripe Connect account deleted for educator edu_123","metadata":{"accountId":"acct_1R1ppRPWoytzXOqP"},"service":"payment-service","timestamp":"2025-03-12 16:06:28","transactionId":null}
{"level":"info","message":"::ffff:127.0.0.1 - - [12/Mar/2025:14:06:28 +0000] \"DELETE /api/payouts/delete-account HTTP/1.1\" 200 64 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-12 16:06:28"}
{"level":"info","message":"POST /api/payouts/create-account","service":"payment-service","timestamp":"2025-03-12 16:08:20"}
{"error":{"code":"url_invalid","doc_url":"https://stripe.com/docs/error-codes/url-invalid","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"319","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=rAEd74QYqOXKneapX4roiZAZ8Bou0USEUPf3PV_nrMbGhtHJpBjCUoMVdNOi1TmmdJ1ss3cevSMh-QjB","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Wed, 12 Mar 2025 14:08:20 GMT","idempotency-key":"1b22d605-14d2-45f2-9e26-acae562b373d","original-request":"req_pQWgvSrvCW6L7N","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_pQWgvSrvCW6L7N","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"param":"business_profile[url]","raw":{"code":"url_invalid","doc_url":"https://stripe.com/docs/error-codes/url-invalid","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"319","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=rAEd74QYqOXKneapX4roiZAZ8Bou0USEUPf3PV_nrMbGhtHJpBjCUoMVdNOi1TmmdJ1ss3cevSMh-QjB","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Wed, 12 Mar 2025 14:08:20 GMT","idempotency-key":"1b22d605-14d2-45f2-9e26-acae562b373d","original-request":"req_pQWgvSrvCW6L7N","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_pQWgvSrvCW6L7N","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"Not a valid URL","param":"business_profile[url]","requestId":"req_pQWgvSrvCW6L7N","request_log_url":"https://dashboard.stripe.com/test/logs/req_pQWgvSrvCW6L7N?t=1741788500","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_pQWgvSrvCW6L7N","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Error creating Stripe account: Not a valid URL","service":"payment-service","timestamp":"2025-03-12 16:08:21"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-12 16:08:21"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 16:08:47"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 16:08:47"}
{"level":"info","message":"POST /api/payouts/create-account","service":"payment-service","timestamp":"2025-03-12 16:08:50"}
{"error":{"code":"url_invalid","doc_url":"https://stripe.com/docs/error-codes/url-invalid","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"319","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=rAEd74QYqOXKneapX4roiZAZ8Bou0USEUPf3PV_nrMbGhtHJpBjCUoMVdNOi1TmmdJ1ss3cevSMh-QjB","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Wed, 12 Mar 2025 14:08:50 GMT","idempotency-key":"6cadd337-4568-42ec-a8a9-08780c363869","original-request":"req_ennWU3qG5sp49F","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_ennWU3qG5sp49F","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"param":"business_profile[url]","raw":{"code":"url_invalid","doc_url":"https://stripe.com/docs/error-codes/url-invalid","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"319","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=rAEd74QYqOXKneapX4roiZAZ8Bou0USEUPf3PV_nrMbGhtHJpBjCUoMVdNOi1TmmdJ1ss3cevSMh-QjB","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Wed, 12 Mar 2025 14:08:50 GMT","idempotency-key":"6cadd337-4568-42ec-a8a9-08780c363869","original-request":"req_ennWU3qG5sp49F","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_ennWU3qG5sp49F","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"Not a valid URL","param":"business_profile[url]","requestId":"req_ennWU3qG5sp49F","request_log_url":"https://dashboard.stripe.com/test/logs/req_ennWU3qG5sp49F?t=1741788530","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_ennWU3qG5sp49F","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Error creating Stripe account: Not a valid URL","service":"payment-service","timestamp":"2025-03-12 16:08:51"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-12 16:08:51"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 16:09:11"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 16:09:11"}
{"level":"info","message":"POST /api/payouts/create-account","service":"payment-service","timestamp":"2025-03-12 16:09:18"}
{"error":{"code":"parameter_unknown","doc_url":"https://stripe.com/docs/error-codes/parameter-unknown","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"381","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=lMuWavtWO1Cc0hCXZK5qXE6CY0QzKQ0S_xpepFV3o9UWA967nENtRs5H1H58NPstioXFfp8UFU38Wugv","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Wed, 12 Mar 2025 14:09:18 GMT","idempotency-key":"5d0dc5c8-346a-4d96-b28d-0dc82c98021c","original-request":"req_JrBPkhgJMiZbms","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_JrBPkhgJMiZbms","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"param":"business_profile[description]","raw":{"code":"parameter_unknown","doc_url":"https://stripe.com/docs/error-codes/parameter-unknown","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"381","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=lMuWavtWO1Cc0hCXZK5qXE6CY0QzKQ0S_xpepFV3o9UWA967nENtRs5H1H58NPstioXFfp8UFU38Wugv","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Wed, 12 Mar 2025 14:09:18 GMT","idempotency-key":"5d0dc5c8-346a-4d96-b28d-0dc82c98021c","original-request":"req_JrBPkhgJMiZbms","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_JrBPkhgJMiZbms","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"Received unknown parameter: business_profile[description]","param":"business_profile[description]","requestId":"req_JrBPkhgJMiZbms","request_log_url":"https://dashboard.stripe.com/test/logs/req_JrBPkhgJMiZbms?t=1741788557","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_JrBPkhgJMiZbms","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Error creating Stripe account: Received unknown parameter: business_profile[description]","service":"payment-service","timestamp":"2025-03-12 16:09:18"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-12 16:09:18"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 16:09:37"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 16:09:37"}
{"level":"info","message":"POST /api/payouts/create-account","service":"payment-service","timestamp":"2025-03-12 16:09:42"}
{"error":{"clientVersion":"6.4.1","code":"P2002","meta":{"modelName":"stripeAccount","target":["educatorId"]},"name":"PrismaClientKnownRequestError"},"level":"error","message":"Error creating Stripe account: \nInvalid `prisma.stripeAccount.create()` invocation in\nC:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\payoutService.js:630:62\n\n  627   }\n  628 );\n  629 \n→ 630 const educatorStripeAccount = await prisma.stripeAccount.create(\nUnique constraint failed on the fields: (`educatorId`)","service":"payment-service","timestamp":"2025-03-12 16:09:49"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-12 16:09:49"}
{"level":"info","message":"::ffff:127.0.0.1 - - [12/Mar/2025:14:10:06 +0000] \"POST /api/payouts/create-account HTTP/1.1\" - - \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-12 16:10:06"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 16:13:50"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 16:13:50"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 16:13:58"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 16:13:58"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 16:14:21"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 16:14:21"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 16:16:20"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 16:16:20"}
{"level":"info","message":"POST /api/payouts/create-account","service":"payment-service","timestamp":"2025-03-12 16:16:32"}
{"error":{"clientVersion":"6.4.1","code":"P2002","meta":{"modelName":"stripeAccount","target":["educatorId"]},"name":"PrismaClientKnownRequestError"},"level":"error","message":"Error creating Stripe account: \nInvalid `prisma.stripeAccount.create()` invocation in\nC:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\payoutService.js:631:62\n\n  628   }\n  629 );\n  630 \n→ 631 const educatorStripeAccount = await prisma.stripeAccount.create(\nUnique constraint failed on the fields: (`educatorId`)","service":"payment-service","timestamp":"2025-03-12 16:16:40"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-12 16:16:40"}
{"level":"info","message":"::ffff:127.0.0.1 - - [12/Mar/2025:14:16:52 +0000] \"POST /api/payouts/create-account HTTP/1.1\" - - \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-12 16:16:52"}
{"level":"info","message":"POST /api/payouts/create-account","service":"payment-service","timestamp":"2025-03-12 16:16:57"}
{"action":"STRIPE_ACCOUNT_CREATED","actor":"edu_123","level":"info","message":"AUDIT: STRIPE_ACCOUNT_CREATED by edu_123 - Stripe Connect account created for educator edu_123","metadata":{"accountId":"acct_1R1q5cPhf90cniis"},"service":"payment-service","timestamp":"2025-03-12 16:17:04","transactionId":null}
{"level":"info","message":"::ffff:127.0.0.1 - - [12/Mar/2025:14:17:04 +0000] \"POST /api/payouts/create-account HTTP/1.1\" 201 109 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-12 16:17:04"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-12 16:19:37"}
{"level":"info","message":"Payment split: Amount: $100, Platform: $20, Educator: $80","service":"payment-service","timestamp":"2025-03-12 16:19:37"}
{"data":{"action":"ENROLL_USER","courseId":"1","transactionId":"b3b39119-eb20-4a9c-be1d-590cfcfe7cf5","userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"mock-user-id\",\"action\":\"ENROLL_USER\",\"courseId\":\"1\",\"transactionId\":\"b3b39119-eb20-4a9c-be1d-590cfcfe7cf5\"}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"118","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:117:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-12 16:19:39"}
{"data":{"action":"RECORD_PURCHASE","amount":100,"courseId":"1","educatorEarnings":80,"userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"courseId\":\"1\",\"action\":\"RECORD_PURCHASE\",\"userId\":\"mock-user-id\",\"amount\":100,\"educatorEarnings\":80}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"102","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3002/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3002","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3002\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyCourseService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:41:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:125:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify course service: connect ECONNREFUSED ::1:3002","service":"payment-service","timestamp":"2025-03-12 16:19:39"}
{"data":{"action":"NEW_EARNINGS","data":{"amount":80,"courseId":"1","totalPendingEarnings":80,"transactionId":"b3b39119-eb20-4a9c-be1d-590cfcfe7cf5"},"userId":"edu_123"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"edu_123\",\"action\":\"NEW_EARNINGS\",\"data\":{\"courseId\":\"1\",\"transactionId\":\"b3b39119-eb20-4a9c-be1d-590cfcfe7cf5\",\"amount\":80,\"totalPendingEarnings\":80}}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"161","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:134:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-12 16:19:39"}
{"action":"PAYMENT_PROCESSED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_PROCESSED by mock-user-id - Payment of 100 USD processed for course 1","metadata":{"stripeChargeId":"ch_3R1q8DBLtTuFPq2g3yxm1POU"},"service":"payment-service","timestamp":"2025-03-12 16:19:39","transactionId":"b3b39119-eb20-4a9c-be1d-590cfcfe7cf5"}
{"level":"info","message":"::ffff:127.0.0.1 - - [12/Mar/2025:14:19:39 +0000] \"POST /api/payments/ HTTP/1.1\" 200 1142 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-12 16:19:39"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-12 16:22:15"}
{"level":"info","message":"Payment split: Amount: $100, Platform: $20, Educator: $80","service":"payment-service","timestamp":"2025-03-12 16:22:31"}
{"data":{"action":"ENROLL_USER","courseId":"2","transactionId":"4bd46fd7-d432-4125-825f-43b3f65b7c95","userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"mock-user-id\",\"action\":\"ENROLL_USER\",\"courseId\":\"2\",\"transactionId\":\"4bd46fd7-d432-4125-825f-43b3f65b7c95\"}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"118","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:117:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-12 16:22:44"}
{"data":{"action":"RECORD_PURCHASE","amount":100,"courseId":"2","educatorEarnings":80,"userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"courseId\":\"2\",\"action\":\"RECORD_PURCHASE\",\"userId\":\"mock-user-id\",\"amount\":100,\"educatorEarnings\":80}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"102","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3002/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3002","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3002\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyCourseService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:41:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:125:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify course service: connect ECONNREFUSED ::1:3002","service":"payment-service","timestamp":"2025-03-12 16:22:44"}
{"data":{"action":"NEW_EARNINGS","data":{"amount":80,"courseId":"2","totalPendingEarnings":160,"transactionId":"4bd46fd7-d432-4125-825f-43b3f65b7c95"},"userId":"edu_123"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"edu_123\",\"action\":\"NEW_EARNINGS\",\"data\":{\"courseId\":\"2\",\"transactionId\":\"4bd46fd7-d432-4125-825f-43b3f65b7c95\",\"amount\":80,\"totalPendingEarnings\":160}}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"162","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:134:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-12 16:22:44"}
{"action":"PAYMENT_PROCESSED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_PROCESSED by mock-user-id - Payment of 100 USD processed for course 2","metadata":{"stripeChargeId":"ch_3R1qB1BLtTuFPq2g0gIW2LAP"},"service":"payment-service","timestamp":"2025-03-12 16:22:44","transactionId":"4bd46fd7-d432-4125-825f-43b3f65b7c95"}
{"level":"info","message":"::ffff:127.0.0.1 - - [12/Mar/2025:14:22:44 +0000] \"POST /api/payments/ HTTP/1.1\" 200 1143 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-12 16:22:44"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 16:23:40"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 16:23:40"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 16:23:43"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 16:23:44"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 16:35:06"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 16:35:06"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 16:35:30"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 16:35:30"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 16:43:52"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 16:43:52"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 16:43:57"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 16:43:57"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 16:44:12"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 16:44:12"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 16:44:31"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 16:44:31"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 16:44:36"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 16:44:36"}
{"level":"info","message":"Database connection closed","service":"payment-service","timestamp":"2025-03-12 16:45:13"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 16:52:11"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 16:52:12"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-12 16:53:44"}
{"level":"error","message":"Error calculating commission: commissionAmount is not defined","service":"payment-service","timestamp":"2025-03-12 16:53:44"}
{"error":{},"level":"error","message":"Payment processing error: platformCommission is not defined","service":"payment-service","timestamp":"2025-03-12 16:53:44"}
{"action":"PAYMENT_FAILED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_FAILED by mock-user-id - Payment of 100 USD failed for course 3","metadata":{"error":"platformCommission is not defined"},"service":"payment-service","timestamp":"2025-03-12 16:53:44","transactionId":null}
{"level":"error","message":"Error processing payment: Payment processing failed: platformCommission is not defined","service":"payment-service","timestamp":"2025-03-12 16:53:44"}
{"level":"info","message":"::ffff:127.0.0.1 - - [12/Mar/2025:14:53:45 +0000] \"POST /api/payments/ HTTP/1.1\" 400 90 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-12 16:53:45"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 16:54:27"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 16:54:27"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-12 16:54:55"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 16:56:16"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 16:56:16"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-12 16:56:25"}
{"level":"info","message":"Payment split: Amount: $100, Platform: $undefined, Educator: $undefined","service":"payment-service","timestamp":"2025-03-12 16:56:25"}
{"level":"info","message":"::ffff:127.0.0.1 - - [12/Mar/2025:14:57:45 +0000] \"POST /api/payments/ HTTP/1.1\" - - \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-12 16:57:45"}
{"error":{"detail":{"code":"ETIMEDOUT"},"raw":{"detail":{"code":"ETIMEDOUT"},"message":"Request aborted due to timeout being reached (80000ms)"},"type":"StripeConnectionError"},"level":"error","message":"Payment processing error: Request aborted due to timeout being reached (80000ms)","service":"payment-service","timestamp":"2025-03-12 16:57:48"}
{"action":"PAYMENT_FAILED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_FAILED by mock-user-id - Payment of 100 USD failed for course 3","metadata":{"error":"Request aborted due to timeout being reached (80000ms)"},"service":"payment-service","timestamp":"2025-03-12 16:57:48","transactionId":null}
{"level":"error","message":"Error processing payment: Payment processing failed: Request aborted due to timeout being reached (80000ms)","service":"payment-service","timestamp":"2025-03-12 16:57:48"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 16:58:42"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 16:58:42"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 17:01:15"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 17:01:16"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-12 17:01:24"}
{"level":"error","message":"Error calculating commission: Assignment to constant variable.","service":"payment-service","timestamp":"2025-03-12 17:01:57"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 17:02:01"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 17:02:01"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-12 17:02:16"}
{"level":"info","message":"Payment split: Amount: $100, Platform: $19, Educator: $78","service":"payment-service","timestamp":"2025-03-12 17:02:16"}
{"error":{"code":"resource_missing","doc_url":"https://stripe.com/docs/error-codes/resource-missing","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"548","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=zBEfSBedeHaOeTRG_-AEXJGQ7aNP3PiDyadowW36ioVpy3g7O5p5KzsgTcpp_OIOq6kJJ_QdWn1JoFDA","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Wed, 12 Mar 2025 15:02:16 GMT","idempotency-key":"02d14d00-6013-4a72-81c7-fc9351781541","original-request":"req_mlQg9ws9QNJ5if","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_mlQg9ws9QNJ5if","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"param":"payment_method","raw":{"code":"resource_missing","doc_url":"https://stripe.com/docs/error-codes/resource-missing","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"548","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=zBEfSBedeHaOeTRG_-AEXJGQ7aNP3PiDyadowW36ioVpy3g7O5p5KzsgTcpp_OIOq6kJJ_QdWn1JoFDA","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Wed, 12 Mar 2025 15:02:16 GMT","idempotency-key":"02d14d00-6013-4a72-81c7-fc9351781541","original-request":"req_mlQg9ws9QNJ5if","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_mlQg9ws9QNJ5if","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"No such PaymentMethod: 'tok_visa'; It's possible this PaymentMethod exists on one of your connected accounts, in which case you should retry this request on that connected account. Learn more at https://stripe.com/docs/connect/authentication","param":"payment_method","requestId":"req_mlQg9ws9QNJ5if","request_log_url":"https://dashboard.stripe.com/test/logs/req_mlQg9ws9QNJ5if?t=1741791736","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_mlQg9ws9QNJ5if","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Payment processing error: No such PaymentMethod: 'tok_visa'; It's possible this PaymentMethod exists on one of your connected accounts, in which case you should retry this request on that connected account. Learn more at https://stripe.com/docs/connect/authentication","service":"payment-service","timestamp":"2025-03-12 17:02:17"}
{"action":"PAYMENT_FAILED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_FAILED by mock-user-id - Payment of 100 USD failed for course 3","metadata":{"error":"No such PaymentMethod: 'tok_visa'; It's possible this PaymentMethod exists on one of your connected accounts, in which case you should retry this request on that connected account. Learn more at https://stripe.com/docs/connect/authentication"},"service":"payment-service","timestamp":"2025-03-12 17:02:17","transactionId":null}
{"level":"error","message":"Error processing payment: Payment processing failed: No such PaymentMethod: 'tok_visa'; It's possible this PaymentMethod exists on one of your connected accounts, in which case you should retry this request on that connected account. Learn more at https://stripe.com/docs/connect/authentication","service":"payment-service","timestamp":"2025-03-12 17:02:17"}
{"level":"info","message":"::ffff:127.0.0.1 - - [12/Mar/2025:15:02:17 +0000] \"POST /api/payments/ HTTP/1.1\" 400 298 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-12 17:02:17"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-12 17:03:17"}
{"level":"info","message":"Payment split: Amount: $100, Platform: $19, Educator: $78","service":"payment-service","timestamp":"2025-03-12 17:03:17"}
{"data":{"action":"ENROLL_USER","courseId":"3","transactionId":"7bcf181c-5cc4-420c-93df-29b35d71bcea","userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"mock-user-id\",\"action\":\"ENROLL_USER\",\"courseId\":\"3\",\"transactionId\":\"7bcf181c-5cc4-420c-93df-29b35d71bcea\"}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"118","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:116:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-12 17:03:18"}
{"data":{"action":"RECORD_PURCHASE","amount":100,"courseId":"3","educatorEarnings":78,"userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"courseId\":\"3\",\"action\":\"RECORD_PURCHASE\",\"userId\":\"mock-user-id\",\"amount\":100,\"educatorEarnings\":78}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"102","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3002/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3002","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3002\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyCourseService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:41:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:124:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify course service: connect ECONNREFUSED ::1:3002","service":"payment-service","timestamp":"2025-03-12 17:03:18"}
{"data":{"action":"NEW_EARNINGS","data":{"amount":78,"courseId":"3","totalPendingEarnings":238,"transactionId":"7bcf181c-5cc4-420c-93df-29b35d71bcea"},"userId":"edu_123"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"edu_123\",\"action\":\"NEW_EARNINGS\",\"data\":{\"courseId\":\"3\",\"transactionId\":\"7bcf181c-5cc4-420c-93df-29b35d71bcea\",\"amount\":78,\"totalPendingEarnings\":238}}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"162","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:133:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-12 17:03:18"}
{"action":"PAYMENT_PROCESSED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_PROCESSED by mock-user-id - Payment of 100 USD processed for course 3","metadata":{"stripeChargeId":"pi_3R1qoTBLtTuFPq2g2aRtCFDy"},"service":"payment-service","timestamp":"2025-03-12 17:03:18","transactionId":"7bcf181c-5cc4-420c-93df-29b35d71bcea"}
{"level":"info","message":"::ffff:127.0.0.1 - - [12/Mar/2025:15:03:18 +0000] \"POST /api/payments/ HTTP/1.1\" 200 1139 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-12 17:03:18"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 17:05:32"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 17:05:33"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 17:06:08"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 17:06:11"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 17:06:11"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-12 17:07:43"}
{"level":"info","message":"Payment split: Amount: $100, Platform: $19, Educator: $78","service":"payment-service","timestamp":"2025-03-12 17:07:43"}
{"error":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"2866","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=eTYAZ4oWcMvt1TQKoE7kQRS7Iyq7qZ9aRDz7Ci5M7L7q-qNcMX-nUgKgxxWHGPc6qOhzi_hof6SkBLyo","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Wed, 12 Mar 2025 15:07:44 GMT","idempotency-key":"bc46af27-7219-455a-8d10-d269071958ff","original-request":"req_paI4AHA8xIYVhV","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_paI4AHA8xIYVhV","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"payment_intent":{"amount":10000,"amount_capturable":0,"amount_details":{"tip":{}},"amount_received":0,"application":null,"application_fee_amount":1900,"automatic_payment_methods":{"allow_redirects":"always","enabled":true},"canceled_at":null,"cancellation_reason":null,"capture_method":"automatic","client_secret":"pi_3R1qsmBLtTuFPq2g4k4Nyrld_secret_MICcoXGGncQmNRWkkgTBtqjky","confirmation_method":"automatic","created":1741792064,"currency":"usd","customer":null,"description":"Payment for course","id":"pi_3R1qsmBLtTuFPq2g4k4Nyrld","invoice":null,"last_payment_error":null,"latest_charge":null,"livemode":false,"metadata":{"courseId":"6","educatorId":"edu_123","userId":"mock-user-id"},"next_action":null,"object":"payment_intent","on_behalf_of":null,"payment_method":"pm_1R1qsmBLtTuFPq2gLvtaMcD6","payment_method_configuration_details":{"id":"pmc_1R0nX4BLtTuFPq2gRzQqIDox","parent":null},"payment_method_options":{"affirm":{},"amazon_pay":{"express_checkout_element_session_id":null},"card":{"installments":null,"mandate_options":null,"network":null,"request_three_d_secure":"automatic"},"cashapp":{},"klarna":{"preferred_locale":null},"link":{"persistent_token":null}},"payment_method_types":["card","klarna","link","affirm","cashapp","amazon_pay"],"processing":null,"receipt_email":null,"review":null,"setup_future_usage":null,"shipping":null,"source":null,"statement_descriptor":null,"statement_descriptor_suffix":null,"status":"requires_confirmation","transfer_data":{"destination":"acct_1R1q5cPhf90cniis"},"transfer_group":null},"raw":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"2866","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=eTYAZ4oWcMvt1TQKoE7kQRS7Iyq7qZ9aRDz7Ci5M7L7q-qNcMX-nUgKgxxWHGPc6qOhzi_hof6SkBLyo","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Wed, 12 Mar 2025 15:07:44 GMT","idempotency-key":"bc46af27-7219-455a-8d10-d269071958ff","original-request":"req_paI4AHA8xIYVhV","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_paI4AHA8xIYVhV","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"This PaymentIntent is configured to accept payment methods enabled in your Dashboard. Because some of these payment methods might redirect your customer off of your page, you must provide a `return_url`. If you don't want to accept redirect-based payment methods, set `automatic_payment_methods[enabled]` to `true` and `automatic_payment_methods[allow_redirects]` to `never` when creating Setup Intents and Payment Intents.","payment_intent":{"amount":10000,"amount_capturable":0,"amount_details":{"tip":{}},"amount_received":0,"application":null,"application_fee_amount":1900,"automatic_payment_methods":{"allow_redirects":"always","enabled":true},"canceled_at":null,"cancellation_reason":null,"capture_method":"automatic","client_secret":"pi_3R1qsmBLtTuFPq2g4k4Nyrld_secret_MICcoXGGncQmNRWkkgTBtqjky","confirmation_method":"automatic","created":1741792064,"currency":"usd","customer":null,"description":"Payment for course","id":"pi_3R1qsmBLtTuFPq2g4k4Nyrld","invoice":null,"last_payment_error":null,"latest_charge":null,"livemode":false,"metadata":{"courseId":"6","educatorId":"edu_123","userId":"mock-user-id"},"next_action":null,"object":"payment_intent","on_behalf_of":null,"payment_method":"pm_1R1qsmBLtTuFPq2gLvtaMcD6","payment_method_configuration_details":{"id":"pmc_1R0nX4BLtTuFPq2gRzQqIDox","parent":null},"payment_method_options":{"affirm":{},"amazon_pay":{"express_checkout_element_session_id":null},"card":{"installments":null,"mandate_options":null,"network":null,"request_three_d_secure":"automatic"},"cashapp":{},"klarna":{"preferred_locale":null},"link":{"persistent_token":null}},"payment_method_types":["card","klarna","link","affirm","cashapp","amazon_pay"],"processing":null,"receipt_email":null,"review":null,"setup_future_usage":null,"shipping":null,"source":null,"statement_descriptor":null,"statement_descriptor_suffix":null,"status":"requires_confirmation","transfer_data":{"destination":"acct_1R1q5cPhf90cniis"},"transfer_group":null},"requestId":"req_paI4AHA8xIYVhV","request_log_url":"https://dashboard.stripe.com/test/logs/req_paI4AHA8xIYVhV?t=1741792064","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_paI4AHA8xIYVhV","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Payment processing error: This PaymentIntent is configured to accept payment methods enabled in your Dashboard. Because some of these payment methods might redirect your customer off of your page, you must provide a `return_url`. If you don't want to accept redirect-based payment methods, set `automatic_payment_methods[enabled]` to `true` and `automatic_payment_methods[allow_redirects]` to `never` when creating Setup Intents and Payment Intents.","service":"payment-service","timestamp":"2025-03-12 17:07:45"}
{"action":"PAYMENT_FAILED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_FAILED by mock-user-id - Payment of 100 USD failed for course 6","metadata":{"error":"This PaymentIntent is configured to accept payment methods enabled in your Dashboard. Because some of these payment methods might redirect your customer off of your page, you must provide a `return_url`. If you don't want to accept redirect-based payment methods, set `automatic_payment_methods[enabled]` to `true` and `automatic_payment_methods[allow_redirects]` to `never` when creating Setup Intents and Payment Intents."},"service":"payment-service","timestamp":"2025-03-12 17:07:45","transactionId":null}
{"level":"error","message":"Error processing payment: Payment processing failed: This PaymentIntent is configured to accept payment methods enabled in your Dashboard. Because some of these payment methods might redirect your customer off of your page, you must provide a `return_url`. If you don't want to accept redirect-based payment methods, set `automatic_payment_methods[enabled]` to `true` and `automatic_payment_methods[allow_redirects]` to `never` when creating Setup Intents and Payment Intents.","service":"payment-service","timestamp":"2025-03-12 17:07:45"}
{"level":"info","message":"::ffff:127.0.0.1 - - [12/Mar/2025:15:07:45 +0000] \"POST /api/payments/ HTTP/1.1\" 400 480 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-12 17:07:45"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-12 17:11:31"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-12 17:11:32"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-12 17:11:36"}
{"level":"info","message":"Payment split: Amount: $100, Platform: $19, Educator: $78","service":"payment-service","timestamp":"2025-03-12 17:11:36"}
{"data":{"action":"ENROLL_USER","courseId":"6","transactionId":"3700b937-8b88-4752-aa21-acd8f9509c56","userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"mock-user-id\",\"action\":\"ENROLL_USER\",\"courseId\":\"6\",\"transactionId\":\"3700b937-8b88-4752-aa21-acd8f9509c56\"}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"118","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:122:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-12 17:11:39"}
{"data":{"action":"RECORD_PURCHASE","amount":100,"courseId":"6","educatorEarnings":78,"userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"courseId\":\"6\",\"action\":\"RECORD_PURCHASE\",\"userId\":\"mock-user-id\",\"amount\":100,\"educatorEarnings\":78}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"102","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3002/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3002","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3002\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyCourseService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:41:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:130:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify course service: connect ECONNREFUSED ::1:3002","service":"payment-service","timestamp":"2025-03-12 17:11:39"}
{"data":{"action":"NEW_EARNINGS","data":{"amount":78,"courseId":"6","totalPendingEarnings":78,"transactionId":"3700b937-8b88-4752-aa21-acd8f9509c56"},"userId":"edu_123"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"edu_123\",\"action\":\"NEW_EARNINGS\",\"data\":{\"courseId\":\"6\",\"transactionId\":\"3700b937-8b88-4752-aa21-acd8f9509c56\",\"amount\":78,\"totalPendingEarnings\":78}}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"161","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:139:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-12 17:11:40"}
{"action":"PAYMENT_PROCESSED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_PROCESSED by mock-user-id - Payment of 100 USD processed for course 6","metadata":{"stripeChargeId":"pi_3R1qwXBLtTuFPq2g13t8rCta"},"service":"payment-service","timestamp":"2025-03-12 17:11:40","transactionId":"3700b937-8b88-4752-aa21-acd8f9509c56"}
{"level":"info","message":"::ffff:127.0.0.1 - - [12/Mar/2025:15:11:40 +0000] \"POST /api/payments/ HTTP/1.1\" 200 1140 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-12 17:11:40"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-13 15:18:18"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-13 15:18:18"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-13 16:05:20"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-13 16:05:20"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-13 16:05:50"}
{"level":"info","message":"Payment split: Amount: $100, Platform: $19, Educator: $78","service":"payment-service","timestamp":"2025-03-13 16:05:50"}
{"error":{"code":"resource_missing","doc_url":"https://stripe.com/docs/error-codes/resource-missing","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"548","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=wDEtFQek_AIKfoWoYeKlc04R6GOV_gnroV2dDVCU04jYQMFfnQZJg9KBjLCryJT38s68_9ewkHezShBM","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Thu, 13 Mar 2025 14:05:50 GMT","idempotency-key":"c920c152-1bfb-45b1-829e-446a1509593f","original-request":"req_wTVE0gvHgr8Bfy","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_wTVE0gvHgr8Bfy","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"param":"payment_method","raw":{"code":"resource_missing","doc_url":"https://stripe.com/docs/error-codes/resource-missing","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"548","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=wDEtFQek_AIKfoWoYeKlc04R6GOV_gnroV2dDVCU04jYQMFfnQZJg9KBjLCryJT38s68_9ewkHezShBM","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Thu, 13 Mar 2025 14:05:50 GMT","idempotency-key":"c920c152-1bfb-45b1-829e-446a1509593f","original-request":"req_wTVE0gvHgr8Bfy","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_wTVE0gvHgr8Bfy","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"No such PaymentMethod: 'tok_visa'; It's possible this PaymentMethod exists on one of your connected accounts, in which case you should retry this request on that connected account. Learn more at https://stripe.com/docs/connect/authentication","param":"payment_method","requestId":"req_wTVE0gvHgr8Bfy","request_log_url":"https://dashboard.stripe.com/test/logs/req_wTVE0gvHgr8Bfy?t=1741874750","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_wTVE0gvHgr8Bfy","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Payment processing error: No such PaymentMethod: 'tok_visa'; It's possible this PaymentMethod exists on one of your connected accounts, in which case you should retry this request on that connected account. Learn more at https://stripe.com/docs/connect/authentication","service":"payment-service","timestamp":"2025-03-13 16:05:51"}
{"level":"error","message":"Error processing payment: \nInvalid `prisma.transaction.create()` invocation in\nC:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:166:32\n\n  163 \n  164 // Record failed transaction if we have enough information\n  165 if (courseId && amount && user?.id) {\n→ 166   await prisma.transaction.create({\n          data: {\n            amount: 100,\n            currency: \"USD\",\n            status: \"FAILED\",\n            type: \"PAYMENT\",\n            platformCommission: 0,\n            educatorEarnings: 0,\n            userId: \"mock-user-id\",\n            courseId: \"1\",\n            educatorId: \"edu_123\",\n            description: \"Payment for course\",\n            metadata: {\n              error: \"No such PaymentMethod: 'tok_visa'; It's possible this PaymentMethod exists on one of your connected accounts, in which case you should retry this request on that connected account. Learn more at https://stripe.com/docs/connect/authentication\"\n            },\n        +   transferId: String\n          }\n        })\n\nArgument `transferId` is missing.","service":"payment-service","timestamp":"2025-03-13 16:05:51"}
{"level":"info","message":"::ffff:127.0.0.1 - - [13/Mar/2025:14:05:51 +0000] \"POST /api/payments/ HTTP/1.1\" 500 1132 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-13 16:05:51"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-13 16:06:34"}
{"level":"info","message":"Payment split: Amount: $100, Platform: $19, Educator: $78","service":"payment-service","timestamp":"2025-03-13 16:06:34"}
{"error":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"224","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=wDEtFQek_AIKfoWoYeKlc04R6GOV_gnroV2dDVCU04jYQMFfnQZJg9KBjLCryJT38s68_9ewkHezShBM","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Thu, 13 Mar 2025 14:06:34 GMT","idempotency-key":"acc7c076-f74a-49eb-a534-b81ef1ecec7d","original-request":"req_p2sAU20GGHbNbG","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_p2sAU20GGHbNbG","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"raw":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"224","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=wDEtFQek_AIKfoWoYeKlc04R6GOV_gnroV2dDVCU04jYQMFfnQZJg9KBjLCryJT38s68_9ewkHezShBM","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Thu, 13 Mar 2025 14:06:34 GMT","idempotency-key":"acc7c076-f74a-49eb-a534-b81ef1ecec7d","original-request":"req_p2sAU20GGHbNbG","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_p2sAU20GGHbNbG","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"There is a part of the token that is not valid: ''.","requestId":"req_p2sAU20GGHbNbG","request_log_url":"https://dashboard.stripe.com/test/logs/req_p2sAU20GGHbNbG?t=1741874794","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_p2sAU20GGHbNbG","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Payment processing error: There is a part of the token that is not valid: ''.","service":"payment-service","timestamp":"2025-03-13 16:06:35"}
{"level":"error","message":"Error processing payment: \nInvalid `prisma.transaction.create()` invocation in\nC:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:166:32\n\n  163 \n  164 // Record failed transaction if we have enough information\n  165 if (courseId && amount && user?.id) {\n→ 166   await prisma.transaction.create({\n          data: {\n            amount: 100,\n            currency: \"USD\",\n            status: \"FAILED\",\n            type: \"PAYMENT\",\n            platformCommission: 0,\n            educatorEarnings: 0,\n            userId: \"mock-user-id\",\n            courseId: \"1\",\n            educatorId: \"edu_123\",\n            description: \"Payment for course\",\n            metadata: {\n              error: \"There is a part of the token that is not valid: ''.\"\n            },\n        +   transferId: String\n          }\n        })\n\nArgument `transferId` is missing.","service":"payment-service","timestamp":"2025-03-13 16:06:35"}
{"level":"info","message":"::ffff:127.0.0.1 - - [13/Mar/2025:14:06:35 +0000] \"POST /api/payments/ HTTP/1.1\" 500 942 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-13 16:06:35"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-13 16:07:14"}
{"level":"info","message":"Payment split: Amount: $100, Platform: $19, Educator: $78","service":"payment-service","timestamp":"2025-03-13 16:07:21"}
{"error":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"224","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=wDEtFQek_AIKfoWoYeKlc04R6GOV_gnroV2dDVCU04jYQMFfnQZJg9KBjLCryJT38s68_9ewkHezShBM","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Thu, 13 Mar 2025 14:07:21 GMT","idempotency-key":"ee59df78-9083-4326-90fa-d039c94bb73b","original-request":"req_2SULveltHOy8Jg","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_2SULveltHOy8Jg","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"raw":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"224","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=wDEtFQek_AIKfoWoYeKlc04R6GOV_gnroV2dDVCU04jYQMFfnQZJg9KBjLCryJT38s68_9ewkHezShBM","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Thu, 13 Mar 2025 14:07:21 GMT","idempotency-key":"ee59df78-9083-4326-90fa-d039c94bb73b","original-request":"req_2SULveltHOy8Jg","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_2SULveltHOy8Jg","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"There is a part of the token that is not valid: ''.","requestId":"req_2SULveltHOy8Jg","request_log_url":"https://dashboard.stripe.com/test/logs/req_2SULveltHOy8Jg?t=1741874841","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_2SULveltHOy8Jg","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Payment processing error: There is a part of the token that is not valid: ''.","service":"payment-service","timestamp":"2025-03-13 16:07:21"}
{"level":"error","message":"Error processing payment: \nInvalid `prisma.transaction.create()` invocation in\nC:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:166:32\n\n  163 \n  164 // Record failed transaction if we have enough information\n  165 if (courseId && amount && user?.id) {\n→ 166   await prisma.transaction.create({\n          data: {\n            amount: 100,\n            currency: \"USD\",\n            status: \"FAILED\",\n            type: \"PAYMENT\",\n            platformCommission: 0,\n            educatorEarnings: 0,\n            userId: \"mock-user-id\",\n            courseId: \"1\",\n            educatorId: \"edu_123\",\n            description: \"Payment for course\",\n            metadata: {\n              error: \"There is a part of the token that is not valid: ''.\"\n            },\n        +   transferId: String\n          }\n        })\n\nArgument `transferId` is missing.","service":"payment-service","timestamp":"2025-03-13 16:07:22"}
{"level":"info","message":"::ffff:127.0.0.1 - - [13/Mar/2025:14:07:22 +0000] \"POST /api/payments/ HTTP/1.1\" 500 942 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-13 16:07:22"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-13 16:08:34"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-13 16:08:34"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-13 16:08:47"}
{"level":"info","message":"Payment split: Amount: $100, Platform: $19, Educator: $78","service":"payment-service","timestamp":"2025-03-13 16:08:47"}
{"error":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"224","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=6CPVIiiotrEbkNy6ymU3xQJnrVOeHijZu5MP_8QkpQ6ouLboQfdZwWGvHxC01UqY7TAYfl5DPn4ZV8Us","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Thu, 13 Mar 2025 14:08:47 GMT","idempotency-key":"de67634f-ee7c-4266-ad17-07e507219ca1","original-request":"req_K6zj2WLOVvDPpG","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_K6zj2WLOVvDPpG","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"raw":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"224","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=6CPVIiiotrEbkNy6ymU3xQJnrVOeHijZu5MP_8QkpQ6ouLboQfdZwWGvHxC01UqY7TAYfl5DPn4ZV8Us","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Thu, 13 Mar 2025 14:08:47 GMT","idempotency-key":"de67634f-ee7c-4266-ad17-07e507219ca1","original-request":"req_K6zj2WLOVvDPpG","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_K6zj2WLOVvDPpG","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"There is a part of the token that is not valid: ''.","requestId":"req_K6zj2WLOVvDPpG","request_log_url":"https://dashboard.stripe.com/test/logs/req_K6zj2WLOVvDPpG?t=1741874927","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_K6zj2WLOVvDPpG","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Payment processing error: There is a part of the token that is not valid: ''.","service":"payment-service","timestamp":"2025-03-13 16:08:47"}
{"action":"PAYMENT_FAILED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_FAILED by mock-user-id - Payment of 100 USD failed for course 1","metadata":{"error":"There is a part of the token that is not valid: ''."},"service":"payment-service","timestamp":"2025-03-13 16:08:48","transactionId":null}
{"level":"error","message":"Error processing payment: Payment processing failed: There is a part of the token that is not valid: ''.","service":"payment-service","timestamp":"2025-03-13 16:08:48"}
{"level":"info","message":"::ffff:127.0.0.1 - - [13/Mar/2025:14:08:48 +0000] \"POST /api/payments/ HTTP/1.1\" 400 108 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-13 16:08:48"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-13 16:09:01"}
{"level":"info","message":"Payment split: Amount: $100, Platform: $19, Educator: $78","service":"payment-service","timestamp":"2025-03-13 16:09:01"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-13 16:09:02"}
{"error":{"clientVersion":"6.4.1","name":"PrismaClientValidationError"},"level":"error","message":"Payment processing error: \nInvalid `prisma.transaction.create()` invocation in\nC:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:81:50\n\n  78 await stripe.paymentIntents.confirm(stripeCharge.id);\n  79 const transferId = await stripe.charges.retrieve(stripeCharge.latest_charge).transfer;\n  80 // 3. Record the transaction with revenue split details\n→ 81 const transaction = await prisma.transaction.create({\n       data: {\n         stripeChargeId: \"pi_3R2CRUBLtTuFPq2g4cgTz3sC\",\n         amount: 100,\n         currency: \"USD\",\n         status: \"COMPLETED\",\n         type: \"PAYMENT\",\n         platformCommission: 19,\n         educatorEarnings: 78,\n         userId: \"mock-user-id\",\n         courseId: \"1\",\n         educatorId: \"edu_123\",\n         description: \"Payment for course\",\n         metadata: {\n           stripePaymentId: \"pi_3R2CRUBLtTuFPq2g4cgTz3sC\",\n           paymentMethod: \"card\",\n           last4: null,\n           processingTime: 1790\n         },\n     +   transferId: String\n       }\n     })\n\nArgument `transferId` is missing.","service":"payment-service","timestamp":"2025-03-13 16:09:03"}
{"action":"PAYMENT_FAILED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_FAILED by mock-user-id - Payment of 100 USD failed for course 1","metadata":{"error":"\nInvalid `prisma.transaction.create()` invocation in\nC:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:81:50\n\n  78 await stripe.paymentIntents.confirm(stripeCharge.id);\n  79 const transferId = await stripe.charges.retrieve(stripeCharge.latest_charge).transfer;\n  80 // 3. Record the transaction with revenue split details\n→ 81 const transaction = await prisma.transaction.create({\n       data: {\n         stripeChargeId: \"pi_3R2CRUBLtTuFPq2g4cgTz3sC\",\n         amount: 100,\n         currency: \"USD\",\n         status: \"COMPLETED\",\n         type: \"PAYMENT\",\n         platformCommission: 19,\n         educatorEarnings: 78,\n         userId: \"mock-user-id\",\n         courseId: \"1\",\n         educatorId: \"edu_123\",\n         description: \"Payment for course\",\n         metadata: {\n           stripePaymentId: \"pi_3R2CRUBLtTuFPq2g4cgTz3sC\",\n           paymentMethod: \"card\",\n           last4: null,\n           processingTime: 1790\n         },\n     +   transferId: String\n       }\n     })\n\nArgument `transferId` is missing."},"service":"payment-service","timestamp":"2025-03-13 16:09:03","transactionId":null}
{"level":"error","message":"Error processing payment: Payment processing failed: \nInvalid `prisma.transaction.create()` invocation in\nC:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:81:50\n\n  78 await stripe.paymentIntents.confirm(stripeCharge.id);\n  79 const transferId = await stripe.charges.retrieve(stripeCharge.latest_charge).transfer;\n  80 // 3. Record the transaction with revenue split details\n→ 81 const transaction = await prisma.transaction.create({\n       data: {\n         stripeChargeId: \"pi_3R2CRUBLtTuFPq2g4cgTz3sC\",\n         amount: 100,\n         currency: \"USD\",\n         status: \"COMPLETED\",\n         type: \"PAYMENT\",\n         platformCommission: 19,\n         educatorEarnings: 78,\n         userId: \"mock-user-id\",\n         courseId: \"1\",\n         educatorId: \"edu_123\",\n         description: \"Payment for course\",\n         metadata: {\n           stripePaymentId: \"pi_3R2CRUBLtTuFPq2g4cgTz3sC\",\n           paymentMethod: \"card\",\n           last4: null,\n           processingTime: 1790\n         },\n     +   transferId: String\n       }\n     })\n\nArgument `transferId` is missing.","service":"payment-service","timestamp":"2025-03-13 16:09:03"}
{"level":"info","message":"::ffff:127.0.0.1 - - [13/Mar/2025:14:09:03 +0000] \"POST /api/payments/ HTTP/1.1\" 400 1176 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-13 16:09:03"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-13 16:09:55"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-13 16:09:55"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-13 16:10:06"}
{"level":"info","message":"Payment split: Amount: $100, Platform: $19, Educator: $78","service":"payment-service","timestamp":"2025-03-13 16:10:06"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-13 16:10:08"}
{"error":{"clientVersion":"6.4.1","name":"PrismaClientValidationError"},"level":"error","message":"Payment processing error: \nInvalid `prisma.transaction.create()` invocation in\nC:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:81:50\n\n  78 await stripe.paymentIntents.confirm(stripeCharge.id);\n  79 const transferId = await stripe.charges.retrieve(stripeCharge.latest_charge).transfer;\n  80 // 3. Record the transaction with revenue split details\n→ 81 const transaction = await prisma.transaction.create({\n       data: {\n         stripeChargeId: \"pi_3R2CSYBLtTuFPq2g02LytLxm\",\n         amount: 100,\n         currency: \"USD\",\n         status: \"COMPLETED\",\n         type: \"PAYMENT\",\n         platformCommission: 19,\n         educatorEarnings: 78,\n         userId: \"mock-user-id\",\n         courseId: \"1\",\n         educatorId: \"edu_123\",\n         description: \"Payment for course\",\n         metadata: {\n           stripePaymentId: \"pi_3R2CSYBLtTuFPq2g02LytLxm\",\n           paymentMethod: \"card\",\n           last4: null,\n           processingTime: 2219\n         },\n     +   transferId: String\n       }\n     })\n\nArgument `transferId` is missing.","service":"payment-service","timestamp":"2025-03-13 16:10:08"}
{"action":"PAYMENT_FAILED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_FAILED by mock-user-id - Payment of 100 USD failed for course 1","metadata":{"error":"\nInvalid `prisma.transaction.create()` invocation in\nC:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:81:50\n\n  78 await stripe.paymentIntents.confirm(stripeCharge.id);\n  79 const transferId = await stripe.charges.retrieve(stripeCharge.latest_charge).transfer;\n  80 // 3. Record the transaction with revenue split details\n→ 81 const transaction = await prisma.transaction.create({\n       data: {\n         stripeChargeId: \"pi_3R2CSYBLtTuFPq2g02LytLxm\",\n         amount: 100,\n         currency: \"USD\",\n         status: \"COMPLETED\",\n         type: \"PAYMENT\",\n         platformCommission: 19,\n         educatorEarnings: 78,\n         userId: \"mock-user-id\",\n         courseId: \"1\",\n         educatorId: \"edu_123\",\n         description: \"Payment for course\",\n         metadata: {\n           stripePaymentId: \"pi_3R2CSYBLtTuFPq2g02LytLxm\",\n           paymentMethod: \"card\",\n           last4: null,\n           processingTime: 2219\n         },\n     +   transferId: String\n       }\n     })\n\nArgument `transferId` is missing."},"service":"payment-service","timestamp":"2025-03-13 16:10:08","transactionId":null}
{"level":"error","message":"Error processing payment: Payment processing failed: \nInvalid `prisma.transaction.create()` invocation in\nC:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:81:50\n\n  78 await stripe.paymentIntents.confirm(stripeCharge.id);\n  79 const transferId = await stripe.charges.retrieve(stripeCharge.latest_charge).transfer;\n  80 // 3. Record the transaction with revenue split details\n→ 81 const transaction = await prisma.transaction.create({\n       data: {\n         stripeChargeId: \"pi_3R2CSYBLtTuFPq2g02LytLxm\",\n         amount: 100,\n         currency: \"USD\",\n         status: \"COMPLETED\",\n         type: \"PAYMENT\",\n         platformCommission: 19,\n         educatorEarnings: 78,\n         userId: \"mock-user-id\",\n         courseId: \"1\",\n         educatorId: \"edu_123\",\n         description: \"Payment for course\",\n         metadata: {\n           stripePaymentId: \"pi_3R2CSYBLtTuFPq2g02LytLxm\",\n           paymentMethod: \"card\",\n           last4: null,\n           processingTime: 2219\n         },\n     +   transferId: String\n       }\n     })\n\nArgument `transferId` is missing.","service":"payment-service","timestamp":"2025-03-13 16:10:08"}
{"level":"info","message":"::ffff:127.0.0.1 - - [13/Mar/2025:14:10:08 +0000] \"POST /api/payments/ HTTP/1.1\" 400 1176 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-13 16:10:08"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-13 16:10:33"}
{"level":"info","message":"Payment split: Amount: $100, Platform: $19, Educator: $78","service":"payment-service","timestamp":"2025-03-13 16:10:33"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-13 16:10:42"}
{"error":{"clientVersion":"6.4.1","name":"PrismaClientValidationError"},"level":"error","message":"Payment processing error: \nInvalid `prisma.transaction.create()` invocation in\nC:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:81:50\n\n  78 await stripe.paymentIntents.confirm(stripeCharge.id);\n  79 const transferId = await stripe.charges.retrieve(stripeCharge.latest_charge).transfer;\n  80 // 3. Record the transaction with revenue split details\n→ 81 const transaction = await prisma.transaction.create({\n       data: {\n         stripeChargeId: \"pi_3R2CSyBLtTuFPq2g254v7Vxl\",\n         amount: 100,\n         currency: \"USD\",\n         status: \"COMPLETED\",\n         type: \"PAYMENT\",\n         platformCommission: 19,\n         educatorEarnings: 78,\n         userId: \"mock-user-id\",\n         courseId: \"1\",\n         educatorId: \"edu_123\",\n         description: \"Payment for course\",\n         metadata: {\n           stripePaymentId: \"pi_3R2CSyBLtTuFPq2g254v7Vxl\",\n           paymentMethod: \"card\",\n           last4: null,\n           processingTime: 9049\n         },\n     +   transferId: String\n       }\n     })\n\nArgument `transferId` is missing.","service":"payment-service","timestamp":"2025-03-13 16:10:46"}
{"action":"PAYMENT_FAILED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_FAILED by mock-user-id - Payment of 100 USD failed for course 1","metadata":{"error":"\nInvalid `prisma.transaction.create()` invocation in\nC:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:81:50\n\n  78 await stripe.paymentIntents.confirm(stripeCharge.id);\n  79 const transferId = await stripe.charges.retrieve(stripeCharge.latest_charge).transfer;\n  80 // 3. Record the transaction with revenue split details\n→ 81 const transaction = await prisma.transaction.create({\n       data: {\n         stripeChargeId: \"pi_3R2CSyBLtTuFPq2g254v7Vxl\",\n         amount: 100,\n         currency: \"USD\",\n         status: \"COMPLETED\",\n         type: \"PAYMENT\",\n         platformCommission: 19,\n         educatorEarnings: 78,\n         userId: \"mock-user-id\",\n         courseId: \"1\",\n         educatorId: \"edu_123\",\n         description: \"Payment for course\",\n         metadata: {\n           stripePaymentId: \"pi_3R2CSyBLtTuFPq2g254v7Vxl\",\n           paymentMethod: \"card\",\n           last4: null,\n           processingTime: 9049\n         },\n     +   transferId: String\n       }\n     })\n\nArgument `transferId` is missing."},"service":"payment-service","timestamp":"2025-03-13 16:10:47","transactionId":null}
{"level":"error","message":"Error processing payment: Payment processing failed: \nInvalid `prisma.transaction.create()` invocation in\nC:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:81:50\n\n  78 await stripe.paymentIntents.confirm(stripeCharge.id);\n  79 const transferId = await stripe.charges.retrieve(stripeCharge.latest_charge).transfer;\n  80 // 3. Record the transaction with revenue split details\n→ 81 const transaction = await prisma.transaction.create({\n       data: {\n         stripeChargeId: \"pi_3R2CSyBLtTuFPq2g254v7Vxl\",\n         amount: 100,\n         currency: \"USD\",\n         status: \"COMPLETED\",\n         type: \"PAYMENT\",\n         platformCommission: 19,\n         educatorEarnings: 78,\n         userId: \"mock-user-id\",\n         courseId: \"1\",\n         educatorId: \"edu_123\",\n         description: \"Payment for course\",\n         metadata: {\n           stripePaymentId: \"pi_3R2CSyBLtTuFPq2g254v7Vxl\",\n           paymentMethod: \"card\",\n           last4: null,\n           processingTime: 9049\n         },\n     +   transferId: String\n       }\n     })\n\nArgument `transferId` is missing.","service":"payment-service","timestamp":"2025-03-13 16:10:47"}
{"level":"info","message":"::ffff:127.0.0.1 - - [13/Mar/2025:14:10:47 +0000] \"POST /api/payments/ HTTP/1.1\" 400 1176 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-13 16:10:47"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-13 16:11:03"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-13 16:11:03"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-13 16:11:10"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-13 16:11:10"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-13 16:11:13"}
{"level":"info","message":"Payment split: Amount: $100, Platform: $19, Educator: $78","service":"payment-service","timestamp":"2025-03-13 16:11:13"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-13 16:11:15"}
{"error":{"clientVersion":"6.4.1","name":"PrismaClientValidationError"},"level":"error","message":"Payment processing error: \nInvalid `prisma.transaction.create()` invocation in\nC:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:82:50\n\n  79 const transferId = await stripe.charges.retrieve(stripeCharge.latest_charge).transfer;\n  80 console.log(transferId);\n  81 // 3. Record the transaction with revenue split details\n→ 82 const transaction = await prisma.transaction.create({\n       data: {\n         stripeChargeId: \"pi_3R2CTdBLtTuFPq2g4ZHLk5Eq\",\n         amount: 100,\n         currency: \"USD\",\n         status: \"COMPLETED\",\n         type: \"PAYMENT\",\n         platformCommission: 19,\n         educatorEarnings: 78,\n         userId: \"mock-user-id\",\n         courseId: \"1\",\n         educatorId: \"edu_123\",\n         description: \"Payment for course\",\n         metadata: {\n           stripePaymentId: \"pi_3R2CTdBLtTuFPq2g4ZHLk5Eq\",\n           paymentMethod: \"card\",\n           last4: null,\n           processingTime: 2151\n         },\n     +   transferId: String\n       }\n     })\n\nArgument `transferId` is missing.","service":"payment-service","timestamp":"2025-03-13 16:11:15"}
{"action":"PAYMENT_FAILED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_FAILED by mock-user-id - Payment of 100 USD failed for course 1","metadata":{"error":"\nInvalid `prisma.transaction.create()` invocation in\nC:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:82:50\n\n  79 const transferId = await stripe.charges.retrieve(stripeCharge.latest_charge).transfer;\n  80 console.log(transferId);\n  81 // 3. Record the transaction with revenue split details\n→ 82 const transaction = await prisma.transaction.create({\n       data: {\n         stripeChargeId: \"pi_3R2CTdBLtTuFPq2g4ZHLk5Eq\",\n         amount: 100,\n         currency: \"USD\",\n         status: \"COMPLETED\",\n         type: \"PAYMENT\",\n         platformCommission: 19,\n         educatorEarnings: 78,\n         userId: \"mock-user-id\",\n         courseId: \"1\",\n         educatorId: \"edu_123\",\n         description: \"Payment for course\",\n         metadata: {\n           stripePaymentId: \"pi_3R2CTdBLtTuFPq2g4ZHLk5Eq\",\n           paymentMethod: \"card\",\n           last4: null,\n           processingTime: 2151\n         },\n     +   transferId: String\n       }\n     })\n\nArgument `transferId` is missing."},"service":"payment-service","timestamp":"2025-03-13 16:11:15","transactionId":null}
{"level":"error","message":"Error processing payment: Payment processing failed: \nInvalid `prisma.transaction.create()` invocation in\nC:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:82:50\n\n  79 const transferId = await stripe.charges.retrieve(stripeCharge.latest_charge).transfer;\n  80 console.log(transferId);\n  81 // 3. Record the transaction with revenue split details\n→ 82 const transaction = await prisma.transaction.create({\n       data: {\n         stripeChargeId: \"pi_3R2CTdBLtTuFPq2g4ZHLk5Eq\",\n         amount: 100,\n         currency: \"USD\",\n         status: \"COMPLETED\",\n         type: \"PAYMENT\",\n         platformCommission: 19,\n         educatorEarnings: 78,\n         userId: \"mock-user-id\",\n         courseId: \"1\",\n         educatorId: \"edu_123\",\n         description: \"Payment for course\",\n         metadata: {\n           stripePaymentId: \"pi_3R2CTdBLtTuFPq2g4ZHLk5Eq\",\n           paymentMethod: \"card\",\n           last4: null,\n           processingTime: 2151\n         },\n     +   transferId: String\n       }\n     })\n\nArgument `transferId` is missing.","service":"payment-service","timestamp":"2025-03-13 16:11:15"}
{"level":"info","message":"::ffff:127.0.0.1 - - [13/Mar/2025:14:11:15 +0000] \"POST /api/payments/ HTTP/1.1\" 400 1147 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-13 16:11:15"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-13 16:12:46"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-13 16:12:46"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-13 16:12:51"}
{"level":"info","message":"Payment split: Amount: $100, Platform: $19, Educator: $78","service":"payment-service","timestamp":"2025-03-13 16:12:51"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-13 16:12:53"}
{"error":{"clientVersion":"6.4.1","name":"PrismaClientValidationError"},"level":"error","message":"Payment processing error: \nInvalid `prisma.transaction.create()` invocation in\nC:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:82:50\n\n  79 const transferId = await stripe.charges.retrieve(stripeCharge.latest_charge).transfer;\n  80 console.log(transferId + \"transferId\");\n  81 // 3. Record the transaction with revenue split details\n→ 82 const transaction = await prisma.transaction.create({\n       data: {\n         stripeChargeId: \"pi_3R2CVDBLtTuFPq2g4gnVgCwG\",\n         amount: 100,\n         currency: \"USD\",\n         status: \"COMPLETED\",\n         type: \"PAYMENT\",\n         platformCommission: 19,\n         educatorEarnings: 78,\n         userId: \"mock-user-id\",\n         courseId: \"1\",\n         educatorId: \"edu_123\",\n         description: \"Payment for course\",\n         metadata: {\n           stripePaymentId: \"pi_3R2CVDBLtTuFPq2g4gnVgCwG\",\n           paymentMethod: \"card\",\n           last4: null,\n           processingTime: 2072\n         },\n     +   transferId: String\n       }\n     })\n\nArgument `transferId` is missing.","service":"payment-service","timestamp":"2025-03-13 16:12:53"}
{"action":"PAYMENT_FAILED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_FAILED by mock-user-id - Payment of 100 USD failed for course 1","metadata":{"error":"\nInvalid `prisma.transaction.create()` invocation in\nC:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:82:50\n\n  79 const transferId = await stripe.charges.retrieve(stripeCharge.latest_charge).transfer;\n  80 console.log(transferId + \"transferId\");\n  81 // 3. Record the transaction with revenue split details\n→ 82 const transaction = await prisma.transaction.create({\n       data: {\n         stripeChargeId: \"pi_3R2CVDBLtTuFPq2g4gnVgCwG\",\n         amount: 100,\n         currency: \"USD\",\n         status: \"COMPLETED\",\n         type: \"PAYMENT\",\n         platformCommission: 19,\n         educatorEarnings: 78,\n         userId: \"mock-user-id\",\n         courseId: \"1\",\n         educatorId: \"edu_123\",\n         description: \"Payment for course\",\n         metadata: {\n           stripePaymentId: \"pi_3R2CVDBLtTuFPq2g4gnVgCwG\",\n           paymentMethod: \"card\",\n           last4: null,\n           processingTime: 2072\n         },\n     +   transferId: String\n       }\n     })\n\nArgument `transferId` is missing."},"service":"payment-service","timestamp":"2025-03-13 16:12:53","transactionId":null}
{"level":"error","message":"Error processing payment: Payment processing failed: \nInvalid `prisma.transaction.create()` invocation in\nC:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:82:50\n\n  79 const transferId = await stripe.charges.retrieve(stripeCharge.latest_charge).transfer;\n  80 console.log(transferId + \"transferId\");\n  81 // 3. Record the transaction with revenue split details\n→ 82 const transaction = await prisma.transaction.create({\n       data: {\n         stripeChargeId: \"pi_3R2CVDBLtTuFPq2g4gnVgCwG\",\n         amount: 100,\n         currency: \"USD\",\n         status: \"COMPLETED\",\n         type: \"PAYMENT\",\n         platformCommission: 19,\n         educatorEarnings: 78,\n         userId: \"mock-user-id\",\n         courseId: \"1\",\n         educatorId: \"edu_123\",\n         description: \"Payment for course\",\n         metadata: {\n           stripePaymentId: \"pi_3R2CVDBLtTuFPq2g4gnVgCwG\",\n           paymentMethod: \"card\",\n           last4: null,\n           processingTime: 2072\n         },\n     +   transferId: String\n       }\n     })\n\nArgument `transferId` is missing.","service":"payment-service","timestamp":"2025-03-13 16:12:53"}
{"level":"info","message":"::ffff:127.0.0.1 - - [13/Mar/2025:14:12:53 +0000] \"POST /api/payments/ HTTP/1.1\" 400 1164 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-13 16:12:53"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-13 16:13:15"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-13 16:13:16"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-13 16:13:20"}
{"level":"info","message":"Payment split: Amount: $100, Platform: $19, Educator: $78","service":"payment-service","timestamp":"2025-03-13 16:13:20"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-13 16:13:22"}
{"error":{"clientVersion":"6.4.1","name":"PrismaClientValidationError"},"level":"error","message":"Payment processing error: \nInvalid `prisma.transaction.create()` invocation in\nC:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:82:50\n\n  79 const transferId = await stripe.charges.retrieve(stripeCharge.latest_charge).transfer;\n  80 console.log(transferId + \"transferId\");\n  81 // 3. Record the transaction with revenue split details\n→ 82 const transaction = await prisma.transaction.create({\n       data: {\n         stripeChargeId: \"pi_3R2CVgBLtTuFPq2g3VypqpLc\",\n         amount: 100,\n         currency: \"USD\",\n         status: \"COMPLETED\",\n         type: \"PAYMENT\",\n         platformCommission: 19,\n         educatorEarnings: 78,\n         userId: \"mock-user-id\",\n         courseId: \"1\",\n         educatorId: \"edu_123\",\n         description: \"Payment for course\",\n         metadata: {\n           stripePaymentId: \"pi_3R2CVgBLtTuFPq2g3VypqpLc\",\n           paymentMethod: \"card\",\n           last4: null,\n           processingTime: 2268\n         },\n     +   transferId: String\n       }\n     })\n\nArgument `transferId` is missing.","service":"payment-service","timestamp":"2025-03-13 16:13:22"}
{"action":"PAYMENT_FAILED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_FAILED by mock-user-id - Payment of 100 USD failed for course 1","metadata":{"error":"\nInvalid `prisma.transaction.create()` invocation in\nC:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:82:50\n\n  79 const transferId = await stripe.charges.retrieve(stripeCharge.latest_charge).transfer;\n  80 console.log(transferId + \"transferId\");\n  81 // 3. Record the transaction with revenue split details\n→ 82 const transaction = await prisma.transaction.create({\n       data: {\n         stripeChargeId: \"pi_3R2CVgBLtTuFPq2g3VypqpLc\",\n         amount: 100,\n         currency: \"USD\",\n         status: \"COMPLETED\",\n         type: \"PAYMENT\",\n         platformCommission: 19,\n         educatorEarnings: 78,\n         userId: \"mock-user-id\",\n         courseId: \"1\",\n         educatorId: \"edu_123\",\n         description: \"Payment for course\",\n         metadata: {\n           stripePaymentId: \"pi_3R2CVgBLtTuFPq2g3VypqpLc\",\n           paymentMethod: \"card\",\n           last4: null,\n           processingTime: 2268\n         },\n     +   transferId: String\n       }\n     })\n\nArgument `transferId` is missing."},"service":"payment-service","timestamp":"2025-03-13 16:13:22","transactionId":null}
{"level":"error","message":"Error processing payment: Payment processing failed: \nInvalid `prisma.transaction.create()` invocation in\nC:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:82:50\n\n  79 const transferId = await stripe.charges.retrieve(stripeCharge.latest_charge).transfer;\n  80 console.log(transferId + \"transferId\");\n  81 // 3. Record the transaction with revenue split details\n→ 82 const transaction = await prisma.transaction.create({\n       data: {\n         stripeChargeId: \"pi_3R2CVgBLtTuFPq2g3VypqpLc\",\n         amount: 100,\n         currency: \"USD\",\n         status: \"COMPLETED\",\n         type: \"PAYMENT\",\n         platformCommission: 19,\n         educatorEarnings: 78,\n         userId: \"mock-user-id\",\n         courseId: \"1\",\n         educatorId: \"edu_123\",\n         description: \"Payment for course\",\n         metadata: {\n           stripePaymentId: \"pi_3R2CVgBLtTuFPq2g3VypqpLc\",\n           paymentMethod: \"card\",\n           last4: null,\n           processingTime: 2268\n         },\n     +   transferId: String\n       }\n     })\n\nArgument `transferId` is missing.","service":"payment-service","timestamp":"2025-03-13 16:13:22"}
{"level":"info","message":"::ffff:127.0.0.1 - - [13/Mar/2025:14:13:22 +0000] \"POST /api/payments/ HTTP/1.1\" 400 1164 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-13 16:13:22"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-13 16:15:23"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-13 16:15:23"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-13 16:15:28"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-13 16:15:28"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-13 16:15:46"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-13 16:15:46"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-13 16:15:51"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-13 16:15:51"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-13 16:16:00"}
{"level":"info","message":"Payment split: Amount: $100, Platform: $19, Educator: $78","service":"payment-service","timestamp":"2025-03-13 16:16:00"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-13 16:16:02"}
{"error":{"clientVersion":"6.4.1","name":"PrismaClientValidationError"},"level":"error","message":"Payment processing error: \nInvalid `prisma.transaction.create()` invocation in\nC:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:84:50\n\n  81 \n  82 console.log(transferId + \"transferId\");\n  83 // 3. Record the transaction with revenue split details\n→ 84 const transaction = await prisma.transaction.create({\n       data: {\n         stripeChargeId: \"pi_3R2CYGBLtTuFPq2g3s9EB5wx\",\n         amount: 100,\n         currency: \"USD\",\n         status: \"COMPLETED\",\n         type: \"PAYMENT\",\n         platformCommission: 19,\n         educatorEarnings: 78,\n         userId: \"mock-user-id\",\n         courseId: \"1\",\n         educatorId: \"edu_123\",\n         description: \"Payment for course\",\n         metadata: {\n           stripePaymentId: \"pi_3R2CYGBLtTuFPq2g3s9EB5wx\",\n           paymentMethod: \"card\",\n           last4: null,\n           processingTime: 2091\n         },\n     +   transferId: String\n       }\n     })\n\nArgument `transferId` is missing.","service":"payment-service","timestamp":"2025-03-13 16:16:02"}
{"action":"PAYMENT_FAILED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_FAILED by mock-user-id - Payment of 100 USD failed for course 1","metadata":{"error":"\nInvalid `prisma.transaction.create()` invocation in\nC:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:84:50\n\n  81 \n  82 console.log(transferId + \"transferId\");\n  83 // 3. Record the transaction with revenue split details\n→ 84 const transaction = await prisma.transaction.create({\n       data: {\n         stripeChargeId: \"pi_3R2CYGBLtTuFPq2g3s9EB5wx\",\n         amount: 100,\n         currency: \"USD\",\n         status: \"COMPLETED\",\n         type: \"PAYMENT\",\n         platformCommission: 19,\n         educatorEarnings: 78,\n         userId: \"mock-user-id\",\n         courseId: \"1\",\n         educatorId: \"edu_123\",\n         description: \"Payment for course\",\n         metadata: {\n           stripePaymentId: \"pi_3R2CYGBLtTuFPq2g3s9EB5wx\",\n           paymentMethod: \"card\",\n           last4: null,\n           processingTime: 2091\n         },\n     +   transferId: String\n       }\n     })\n\nArgument `transferId` is missing."},"service":"payment-service","timestamp":"2025-03-13 16:16:02","transactionId":null}
{"level":"error","message":"Error processing payment: Payment processing failed: \nInvalid `prisma.transaction.create()` invocation in\nC:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:84:50\n\n  81 \n  82 console.log(transferId + \"transferId\");\n  83 // 3. Record the transaction with revenue split details\n→ 84 const transaction = await prisma.transaction.create({\n       data: {\n         stripeChargeId: \"pi_3R2CYGBLtTuFPq2g3s9EB5wx\",\n         amount: 100,\n         currency: \"USD\",\n         status: \"COMPLETED\",\n         type: \"PAYMENT\",\n         platformCommission: 19,\n         educatorEarnings: 78,\n         userId: \"mock-user-id\",\n         courseId: \"1\",\n         educatorId: \"edu_123\",\n         description: \"Payment for course\",\n         metadata: {\n           stripePaymentId: \"pi_3R2CYGBLtTuFPq2g3s9EB5wx\",\n           paymentMethod: \"card\",\n           last4: null,\n           processingTime: 2091\n         },\n     +   transferId: String\n       }\n     })\n\nArgument `transferId` is missing.","service":"payment-service","timestamp":"2025-03-13 16:16:02"}
{"level":"info","message":"::ffff:127.0.0.1 - - [13/Mar/2025:14:16:02 +0000] \"POST /api/payments/ HTTP/1.1\" 400 1078 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-13 16:16:02"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-13 16:16:50"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-13 16:16:50"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-13 16:16:55"}
{"level":"info","message":"Payment split: Amount: $100, Platform: $19, Educator: $78","service":"payment-service","timestamp":"2025-03-13 16:16:55"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-13 16:16:57"}
{"error":{"clientVersion":"6.4.1","name":"PrismaClientValidationError"},"level":"error","message":"Payment processing error: \nInvalid `prisma.transaction.create()` invocation in\nC:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:84:50\n\n  81 \n  82 console.log(transferId + \"transferId\");\n  83 // 3. Record the transaction with revenue split details\n→ 84 const transaction = await prisma.transaction.create({\n       data: {\n         stripeChargeId: \"pi_3R2CZ9BLtTuFPq2g3ntvTPD3\",\n         amount: 100,\n         currency: \"USD\",\n         status: \"COMPLETED\",\n         type: \"PAYMENT\",\n         platformCommission: 19,\n         educatorEarnings: 78,\n         userId: \"mock-user-id\",\n         courseId: \"1\",\n         educatorId: \"edu_123\",\n         description: \"Payment for course\",\n         metadata: {\n           stripePaymentId: \"pi_3R2CZ9BLtTuFPq2g3ntvTPD3\",\n           paymentMethod: \"card\",\n           last4: null,\n           processingTime: 2099\n         },\n     +   transferId: String\n       }\n     })\n\nArgument `transferId` is missing.","service":"payment-service","timestamp":"2025-03-13 16:16:57"}
{"action":"PAYMENT_FAILED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_FAILED by mock-user-id - Payment of 100 USD failed for course 1","metadata":{"error":"\nInvalid `prisma.transaction.create()` invocation in\nC:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:84:50\n\n  81 \n  82 console.log(transferId + \"transferId\");\n  83 // 3. Record the transaction with revenue split details\n→ 84 const transaction = await prisma.transaction.create({\n       data: {\n         stripeChargeId: \"pi_3R2CZ9BLtTuFPq2g3ntvTPD3\",\n         amount: 100,\n         currency: \"USD\",\n         status: \"COMPLETED\",\n         type: \"PAYMENT\",\n         platformCommission: 19,\n         educatorEarnings: 78,\n         userId: \"mock-user-id\",\n         courseId: \"1\",\n         educatorId: \"edu_123\",\n         description: \"Payment for course\",\n         metadata: {\n           stripePaymentId: \"pi_3R2CZ9BLtTuFPq2g3ntvTPD3\",\n           paymentMethod: \"card\",\n           last4: null,\n           processingTime: 2099\n         },\n     +   transferId: String\n       }\n     })\n\nArgument `transferId` is missing."},"service":"payment-service","timestamp":"2025-03-13 16:16:57","transactionId":null}
{"level":"error","message":"Error processing payment: Payment processing failed: \nInvalid `prisma.transaction.create()` invocation in\nC:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:84:50\n\n  81 \n  82 console.log(transferId + \"transferId\");\n  83 // 3. Record the transaction with revenue split details\n→ 84 const transaction = await prisma.transaction.create({\n       data: {\n         stripeChargeId: \"pi_3R2CZ9BLtTuFPq2g3ntvTPD3\",\n         amount: 100,\n         currency: \"USD\",\n         status: \"COMPLETED\",\n         type: \"PAYMENT\",\n         platformCommission: 19,\n         educatorEarnings: 78,\n         userId: \"mock-user-id\",\n         courseId: \"1\",\n         educatorId: \"edu_123\",\n         description: \"Payment for course\",\n         metadata: {\n           stripePaymentId: \"pi_3R2CZ9BLtTuFPq2g3ntvTPD3\",\n           paymentMethod: \"card\",\n           last4: null,\n           processingTime: 2099\n         },\n     +   transferId: String\n       }\n     })\n\nArgument `transferId` is missing.","service":"payment-service","timestamp":"2025-03-13 16:16:57"}
{"level":"info","message":"::ffff:127.0.0.1 - - [13/Mar/2025:14:16:57 +0000] \"POST /api/payments/ HTTP/1.1\" 400 1078 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-13 16:16:57"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-13 16:20:46"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-13 16:20:46"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-13 16:21:04"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-13 16:21:04"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-13 16:22:55"}
{"level":"info","message":"Payment split: Amount: $100, Platform: $19, Educator: $78","service":"payment-service","timestamp":"2025-03-13 16:22:55"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-13 16:22:57"}
{"error":{"clientVersion":"6.4.1","name":"PrismaClientValidationError"},"level":"error","message":"Payment processing error: \nInvalid `prisma.transaction.create()` invocation in\nC:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:84:50\n\n  81 \n  82 console.log(transferId + \"transferId\");\n  83 // 3. Record the transaction with revenue split details\n→ 84 const transaction = await prisma.transaction.create({\n       data: {\n         stripeChargeId: \"pi_3R2CexBLtTuFPq2g2fXSZ0sh\",\n         amount: 100,\n         currency: \"USD\",\n         status: \"COMPLETED\",\n         type: \"PAYMENT\",\n         platformCommission: 19,\n         educatorEarnings: 78,\n         userId: \"mock-user-id\",\n         courseId: \"1\",\n         educatorId: \"edu_123\",\n         description: \"Payment for course\",\n         metadata: {\n           stripePaymentId: \"pi_3R2CexBLtTuFPq2g2fXSZ0sh\",\n           paymentMethod: \"card\",\n           last4: null,\n           processingTime: 2049\n         },\n     +   transferId: String\n       }\n     })\n\nArgument `transferId` is missing.","service":"payment-service","timestamp":"2025-03-13 16:22:57"}
{"action":"PAYMENT_FAILED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_FAILED by mock-user-id - Payment of 100 USD failed for course 1","metadata":{"error":"\nInvalid `prisma.transaction.create()` invocation in\nC:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:84:50\n\n  81 \n  82 console.log(transferId + \"transferId\");\n  83 // 3. Record the transaction with revenue split details\n→ 84 const transaction = await prisma.transaction.create({\n       data: {\n         stripeChargeId: \"pi_3R2CexBLtTuFPq2g2fXSZ0sh\",\n         amount: 100,\n         currency: \"USD\",\n         status: \"COMPLETED\",\n         type: \"PAYMENT\",\n         platformCommission: 19,\n         educatorEarnings: 78,\n         userId: \"mock-user-id\",\n         courseId: \"1\",\n         educatorId: \"edu_123\",\n         description: \"Payment for course\",\n         metadata: {\n           stripePaymentId: \"pi_3R2CexBLtTuFPq2g2fXSZ0sh\",\n           paymentMethod: \"card\",\n           last4: null,\n           processingTime: 2049\n         },\n     +   transferId: String\n       }\n     })\n\nArgument `transferId` is missing."},"service":"payment-service","timestamp":"2025-03-13 16:22:57","transactionId":null}
{"level":"error","message":"Error processing payment: Payment processing failed: \nInvalid `prisma.transaction.create()` invocation in\nC:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:84:50\n\n  81 \n  82 console.log(transferId + \"transferId\");\n  83 // 3. Record the transaction with revenue split details\n→ 84 const transaction = await prisma.transaction.create({\n       data: {\n         stripeChargeId: \"pi_3R2CexBLtTuFPq2g2fXSZ0sh\",\n         amount: 100,\n         currency: \"USD\",\n         status: \"COMPLETED\",\n         type: \"PAYMENT\",\n         platformCommission: 19,\n         educatorEarnings: 78,\n         userId: \"mock-user-id\",\n         courseId: \"1\",\n         educatorId: \"edu_123\",\n         description: \"Payment for course\",\n         metadata: {\n           stripePaymentId: \"pi_3R2CexBLtTuFPq2g2fXSZ0sh\",\n           paymentMethod: \"card\",\n           last4: null,\n           processingTime: 2049\n         },\n     +   transferId: String\n       }\n     })\n\nArgument `transferId` is missing.","service":"payment-service","timestamp":"2025-03-13 16:22:57"}
{"level":"info","message":"::ffff:127.0.0.1 - - [13/Mar/2025:14:22:57 +0000] \"POST /api/payments/ HTTP/1.1\" 400 1078 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-13 16:22:57"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-13 16:23:57"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-13 16:23:58"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-13 16:24:28"}
{"level":"info","message":"Payment split: Amount: $100, Platform: $19, Educator: $78","service":"payment-service","timestamp":"2025-03-13 16:24:29"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-13 16:24:31"}
{"data":{"action":"ENROLL_USER","courseId":"1","transactionId":"3c647a76-d45e-472b-8efd-9219f3cb8a26","userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"mock-user-id\",\"action\":\"ENROLL_USER\",\"courseId\":\"1\",\"transactionId\":\"3c647a76-d45e-472b-8efd-9219f3cb8a26\"}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"118","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:122:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-13 16:24:31"}
{"data":{"action":"RECORD_PURCHASE","amount":100,"courseId":"1","educatorEarnings":78,"userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"courseId\":\"1\",\"action\":\"RECORD_PURCHASE\",\"userId\":\"mock-user-id\",\"amount\":100,\"educatorEarnings\":78}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"102","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3002/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3002","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3002\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyCourseService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:41:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:130:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify course service: connect ECONNREFUSED ::1:3002","service":"payment-service","timestamp":"2025-03-13 16:24:31"}
{"data":{"action":"NEW_EARNINGS","data":{"amount":78,"courseId":"1","totalPendingEarnings":78,"transactionId":"3c647a76-d45e-472b-8efd-9219f3cb8a26"},"userId":"edu_123"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"edu_123\",\"action\":\"NEW_EARNINGS\",\"data\":{\"courseId\":\"1\",\"transactionId\":\"3c647a76-d45e-472b-8efd-9219f3cb8a26\",\"amount\":78,\"totalPendingEarnings\":78}}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"161","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:139:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-13 16:24:31"}
{"action":"PAYMENT_PROCESSED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_PROCESSED by mock-user-id - Payment of 100 USD processed for course 1","metadata":{"stripeChargeId":"pi_3R2CgTBLtTuFPq2g4L7G12Wg"},"service":"payment-service","timestamp":"2025-03-13 16:24:31","transactionId":"3c647a76-d45e-472b-8efd-9219f3cb8a26"}
{"level":"info","message":"::ffff:127.0.0.1 - - [13/Mar/2025:14:24:31 +0000] \"POST /api/payments/ HTTP/1.1\" 200 1160 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-13 16:24:31"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-13 16:29:17"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-13 16:29:17"}
{"level":"info","message":"Database connection closed","service":"payment-service","timestamp":"2025-03-13 16:29:46"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-13 16:31:42"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-13 16:31:42"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-13 16:31:48"}
{"error":{"isOperational":true,"status":"fail","statusCode":400},"level":"error","message":"Payment processing error: User already enrolled in this course","service":"payment-service","timestamp":"2025-03-13 16:31:48"}
{"action":"PAYMENT_FAILED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_FAILED by mock-user-id - Payment of 100 USD failed for course 1","metadata":{"error":"User already enrolled in this course"},"service":"payment-service","timestamp":"2025-03-13 16:31:48","transactionId":null}
{"level":"error","message":"Error processing payment: Payment processing failed: User already enrolled in this course","service":"payment-service","timestamp":"2025-03-13 16:31:48"}
{"level":"info","message":"::ffff:127.0.0.1 - - [13/Mar/2025:14:31:48 +0000] \"POST /api/payments/ HTTP/1.1\" 400 93 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-13 16:31:48"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-13 16:32:00"}
{"level":"info","message":"Payment split: Amount: $100, Platform: $19, Educator: $78","service":"payment-service","timestamp":"2025-03-13 16:32:00"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-13 16:32:02"}
{"data":{"action":"ENROLL_USER","courseId":"2","transactionId":"10d58fe2-0552-4565-babf-b9a774fe9f1e","userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"mock-user-id\",\"action\":\"ENROLL_USER\",\"courseId\":\"2\",\"transactionId\":\"10d58fe2-0552-4565-babf-b9a774fe9f1e\"}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"118","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:122:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-13 16:32:02"}
{"data":{"action":"RECORD_PURCHASE","amount":100,"courseId":"2","educatorEarnings":78,"userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"courseId\":\"2\",\"action\":\"RECORD_PURCHASE\",\"userId\":\"mock-user-id\",\"amount\":100,\"educatorEarnings\":78}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"102","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3002/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3002","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3002\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyCourseService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:41:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:130:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify course service: connect ECONNREFUSED ::1:3002","service":"payment-service","timestamp":"2025-03-13 16:32:02"}
{"data":{"action":"NEW_EARNINGS","data":{"amount":78,"courseId":"2","totalPendingEarnings":156,"transactionId":"10d58fe2-0552-4565-babf-b9a774fe9f1e"},"userId":"edu_123"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"edu_123\",\"action\":\"NEW_EARNINGS\",\"data\":{\"courseId\":\"2\",\"transactionId\":\"10d58fe2-0552-4565-babf-b9a774fe9f1e\",\"amount\":78,\"totalPendingEarnings\":156}}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"162","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:139:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-13 16:32:02"}
{"action":"PAYMENT_PROCESSED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_PROCESSED by mock-user-id - Payment of 100 USD processed for course 2","metadata":{"stripeChargeId":"pi_3R2CnkBLtTuFPq2g2PAU4PCH"},"service":"payment-service","timestamp":"2025-03-13 16:32:02","transactionId":"10d58fe2-0552-4565-babf-b9a774fe9f1e"}
{"level":"info","message":"::ffff:127.0.0.1 - - [13/Mar/2025:14:32:02 +0000] \"POST /api/payments/ HTTP/1.1\" 200 1160 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-13 16:32:02"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-13 18:46:44"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-13 18:46:44"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-13 18:47:24"}
{"level":"info","message":"Payment split: Amount: $100, Platform: $19, Educator: $78","service":"payment-service","timestamp":"2025-03-13 18:47:25"}
{"error":{},"level":"error","message":"Payment processing error: transferId is not defined","service":"payment-service","timestamp":"2025-03-13 18:47:27"}
{"level":"error","message":"Error processing payment: \nInvalid `prisma.transaction.create()` invocation in\nC:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:164:32\n\n  161 \n  162 // Record failed transaction if we have enough information\n  163 if (courseId && amount && user?.id) {\n→ 164   await prisma.transaction.create({\n          data: {\n            amount: 100,\n            currency: \"USD\",\n            status: \"FAILED\",\n            type: \"PAYMENT\",\n            platformCommission: 0,\n            educatorEarnings: 0,\n            userId: \"mock-user-id\",\n            courseId: \"1\",\n            educatorId: \"edu_123\",\n            transferId: \"null\",\n            ~~~~~~~~~~\n            description: \"Payment for course\",\n            metadata: {\n              error: \"transferId is not defined\"\n            },\n        ?   id?: String,\n        ?   stripeChargeId?: String | Null,\n        ?   refundId?: String | Null,\n        ?   createdAt?: DateTime,\n        ?   updatedAt?: DateTime,\n        ?   invoice?: InvoiceCreateNestedOneWithoutTransactionInput,\n        ?   auditLogs?: AuditLogCreateNestedManyWithoutTransactionInput,\n        ?   payout?: PayoutCreateNestedOneWithoutTransactionsInput\n          }\n        })\n\nUnknown argument `transferId`. Available options are marked with ?.","service":"payment-service","timestamp":"2025-03-13 18:47:27"}
{"level":"info","message":"::ffff:127.0.0.1 - - [13/Mar/2025:16:47:27 +0000] \"POST /api/payments/ HTTP/1.1\" 500 1369 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-13 18:47:27"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-13 18:48:53"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-13 18:48:53"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-13 18:48:57"}
{"level":"info","message":"Payment split: Amount: $100, Platform: $19, Educator: $78","service":"payment-service","timestamp":"2025-03-13 18:48:57"}
{"data":{"action":"ENROLL_USER","courseId":"1","transactionId":"923a3ad3-c97a-4c05-a9b4-7ae3375a92ad","userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"mock-user-id\",\"action\":\"ENROLL_USER\",\"courseId\":\"1\",\"transactionId\":\"923a3ad3-c97a-4c05-a9b4-7ae3375a92ad\"}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"118","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:116:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-13 18:49:00"}
{"data":{"action":"RECORD_PURCHASE","amount":100,"courseId":"1","educatorEarnings":78,"userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"courseId\":\"1\",\"action\":\"RECORD_PURCHASE\",\"userId\":\"mock-user-id\",\"amount\":100,\"educatorEarnings\":78}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"102","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3002/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3002","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3002\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyCourseService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:41:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:124:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify course service: connect ECONNREFUSED ::1:3002","service":"payment-service","timestamp":"2025-03-13 18:49:00"}
{"data":{"action":"NEW_EARNINGS","data":{"amount":78,"courseId":"1","totalPendingEarnings":78,"transactionId":"923a3ad3-c97a-4c05-a9b4-7ae3375a92ad"},"userId":"edu_123"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"edu_123\",\"action\":\"NEW_EARNINGS\",\"data\":{\"courseId\":\"1\",\"transactionId\":\"923a3ad3-c97a-4c05-a9b4-7ae3375a92ad\",\"amount\":78,\"totalPendingEarnings\":78}}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"161","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:133:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-13 18:49:00"}
{"action":"PAYMENT_PROCESSED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_PROCESSED by mock-user-id - Payment of 100 USD processed for course 1","metadata":{"stripeChargeId":"pi_3R2EwHBLtTuFPq2g0bkKE7Cf"},"service":"payment-service","timestamp":"2025-03-13 18:49:00","transactionId":"923a3ad3-c97a-4c05-a9b4-7ae3375a92ad"}
{"level":"info","message":"::ffff:127.0.0.1 - - [13/Mar/2025:16:49:00 +0000] \"POST /api/payments/ HTTP/1.1\" 200 1140 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-13 18:49:00"}
{"level":"info","message":"POST /api/payments/refund","service":"payment-service","timestamp":"2025-03-13 18:49:47"}
{"error":{"code":"resource_missing","doc_url":"https://stripe.com/docs/error-codes/resource-missing","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"340","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=k24S3bPFDZAA0Nuh85qY6zcQP4iGq_MHAW1w6OiCT3eeQNyqaZAwcdijcrivqdfi8D7wxhNoRF7A0ZZs","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Thu, 13 Mar 2025 16:49:47 GMT","idempotency-key":"26248553-4127-45c6-8ad0-204e0775e732","original-request":"req_BKKNCNJhNUOExu","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_BKKNCNJhNUOExu","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"param":"id","raw":{"code":"resource_missing","doc_url":"https://stripe.com/docs/error-codes/resource-missing","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"340","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=k24S3bPFDZAA0Nuh85qY6zcQP4iGq_MHAW1w6OiCT3eeQNyqaZAwcdijcrivqdfi8D7wxhNoRF7A0ZZs","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Thu, 13 Mar 2025 16:49:47 GMT","idempotency-key":"26248553-4127-45c6-8ad0-204e0775e732","original-request":"req_BKKNCNJhNUOExu","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_BKKNCNJhNUOExu","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"No such charge: 'pi_3R2EwHBLtTuFPq2g0bkKE7Cf'","param":"id","requestId":"req_BKKNCNJhNUOExu","request_log_url":"https://dashboard.stripe.com/test/logs/req_BKKNCNJhNUOExu?t=1741884587","statusCode":404,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_BKKNCNJhNUOExu","statusCode":404,"type":"StripeInvalidRequestError"},"level":"error","message":"Refund processing error: No such charge: 'pi_3R2EwHBLtTuFPq2g0bkKE7Cf'","service":"payment-service","timestamp":"2025-03-13 18:49:48"}
{"level":"error","message":"Error processing refund: Refund processing failed: No such charge: 'pi_3R2EwHBLtTuFPq2g0bkKE7Cf'","service":"payment-service","timestamp":"2025-03-13 18:49:48"}
{"level":"info","message":"::ffff:127.0.0.1 - - [13/Mar/2025:16:49:48 +0000] \"POST /api/payments/refund HTTP/1.1\" 400 101 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-13 18:49:48"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-13 18:57:11"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-13 18:57:11"}
{"level":"info","message":"POST /api/payments/refund","service":"payment-service","timestamp":"2025-03-13 18:57:19"}
{"error":{},"level":"error","message":"Refund processing error: Stripe: Argument \"id\" must be a string, but got: undefined (on API request to `POST /v1/transfers/{id}/reversals`)","service":"payment-service","timestamp":"2025-03-13 18:57:21"}
{"level":"error","message":"Error processing refund: Refund processing failed: Stripe: Argument \"id\" must be a string, but got: undefined (on API request to `POST /v1/transfers/{id}/reversals`)","service":"payment-service","timestamp":"2025-03-13 18:57:21"}
{"level":"info","message":"::ffff:127.0.0.1 - - [13/Mar/2025:16:57:21 +0000] \"POST /api/payments/refund HTTP/1.1\" 400 172 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-13 18:57:21"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-13 18:58:02"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-13 18:58:02"}
{"level":"info","message":"POST /api/payments/refund","service":"payment-service","timestamp":"2025-03-13 18:58:23"}
{"error":{"code":"charge_already_refunded","doc_url":"https://stripe.com/docs/error-codes/charge-already-refunded","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"351","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=vyBcxbBwVc8by7R_j6lsA0HlDEbZg9tddKtYIlBs18qkMzlDtRkwVEQCpCtvFIT3_x0QFHv3M0CsifFd","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Thu, 13 Mar 2025 16:59:50 GMT","idempotency-key":"bd11ce4a-861c-4902-a092-c530188ab449","original-request":"req_NSQVNa6Ou6MScl","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_NSQVNa6Ou6MScl","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"raw":{"code":"charge_already_refunded","doc_url":"https://stripe.com/docs/error-codes/charge-already-refunded","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"351","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=vyBcxbBwVc8by7R_j6lsA0HlDEbZg9tddKtYIlBs18qkMzlDtRkwVEQCpCtvFIT3_x0QFHv3M0CsifFd","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Thu, 13 Mar 2025 16:59:50 GMT","idempotency-key":"bd11ce4a-861c-4902-a092-c530188ab449","original-request":"req_NSQVNa6Ou6MScl","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_NSQVNa6Ou6MScl","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"Charge ch_3R2EwHBLtTuFPq2g0bxeUkGv has already been refunded.","requestId":"req_NSQVNa6Ou6MScl","request_log_url":"https://dashboard.stripe.com/test/logs/req_NSQVNa6Ou6MScl?t=1741885189","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_NSQVNa6Ou6MScl","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Refund processing error: Charge ch_3R2EwHBLtTuFPq2g0bxeUkGv has already been refunded.","service":"payment-service","timestamp":"2025-03-13 19:00:40"}
{"level":"error","message":"Error processing refund: Refund processing failed: Charge ch_3R2EwHBLtTuFPq2g0bxeUkGv has already been refunded.","service":"payment-service","timestamp":"2025-03-13 19:00:40"}
{"level":"info","message":"::ffff:127.0.0.1 - - [13/Mar/2025:17:00:40 +0000] \"POST /api/payments/refund HTTP/1.1\" 400 117 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-13 19:00:40"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-13 19:00:40"}
{"level":"info","message":"Payment split: Amount: $100, Platform: $19, Educator: $78","service":"payment-service","timestamp":"2025-03-13 19:00:40"}
{"data":{"action":"ENROLL_USER","courseId":"2","transactionId":"e5acb8bd-2efd-416a-a02f-cb9c4a95298b","userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"mock-user-id\",\"action\":\"ENROLL_USER\",\"courseId\":\"2\",\"transactionId\":\"e5acb8bd-2efd-416a-a02f-cb9c4a95298b\"}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"118","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:116:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-13 19:00:41"}
{"data":{"action":"RECORD_PURCHASE","amount":100,"courseId":"2","educatorEarnings":78,"userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"courseId\":\"2\",\"action\":\"RECORD_PURCHASE\",\"userId\":\"mock-user-id\",\"amount\":100,\"educatorEarnings\":78}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"102","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3002/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3002","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3002\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyCourseService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:41:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:124:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify course service: connect ECONNREFUSED ::1:3002","service":"payment-service","timestamp":"2025-03-13 19:00:41"}
{"data":{"action":"NEW_EARNINGS","data":{"amount":78,"courseId":"2","totalPendingEarnings":156,"transactionId":"e5acb8bd-2efd-416a-a02f-cb9c4a95298b"},"userId":"edu_123"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"edu_123\",\"action\":\"NEW_EARNINGS\",\"data\":{\"courseId\":\"2\",\"transactionId\":\"e5acb8bd-2efd-416a-a02f-cb9c4a95298b\",\"amount\":78,\"totalPendingEarnings\":156}}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"162","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:133:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-13 19:00:41"}
{"action":"PAYMENT_PROCESSED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_PROCESSED by mock-user-id - Payment of 100 USD processed for course 2","metadata":{"stripeChargeId":"pi_3R2F7bBLtTuFPq2g3LoZuEEq"},"service":"payment-service","timestamp":"2025-03-13 19:00:41","transactionId":"e5acb8bd-2efd-416a-a02f-cb9c4a95298b"}
{"level":"info","message":"::ffff:127.0.0.1 - - [13/Mar/2025:17:00:41 +0000] \"POST /api/payments/ HTTP/1.1\" 200 1140 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-13 19:00:41"}
{"level":"info","message":"POST /api/payments/refund","service":"payment-service","timestamp":"2025-03-13 19:01:38"}
{"error":{},"level":"error","message":"Refund processing error: Stripe: Argument \"id\" must be a string, but got: undefined (on API request to `POST /v1/transfers/{id}/reversals`)","service":"payment-service","timestamp":"2025-03-13 19:01:40"}
{"level":"error","message":"Error processing refund: Refund processing failed: Stripe: Argument \"id\" must be a string, but got: undefined (on API request to `POST /v1/transfers/{id}/reversals`)","service":"payment-service","timestamp":"2025-03-13 19:01:40"}
{"level":"info","message":"::ffff:127.0.0.1 - - [13/Mar/2025:17:01:40 +0000] \"POST /api/payments/refund HTTP/1.1\" 400 172 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-13 19:01:40"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-13 19:02:42"}
{"level":"info","message":"Payment split: Amount: $100, Platform: $19, Educator: $78","service":"payment-service","timestamp":"2025-03-13 19:02:42"}
{"data":{"action":"ENROLL_USER","courseId":"3","transactionId":"0f9052de-972b-4310-b7c0-46af0dd1137a","userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"mock-user-id\",\"action\":\"ENROLL_USER\",\"courseId\":\"3\",\"transactionId\":\"0f9052de-972b-4310-b7c0-46af0dd1137a\"}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"118","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:116:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-13 19:02:43"}
{"data":{"action":"RECORD_PURCHASE","amount":100,"courseId":"3","educatorEarnings":78,"userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"courseId\":\"3\",\"action\":\"RECORD_PURCHASE\",\"userId\":\"mock-user-id\",\"amount\":100,\"educatorEarnings\":78}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"102","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3002/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3002","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3002\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyCourseService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:41:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:124:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify course service: connect ECONNREFUSED ::1:3002","service":"payment-service","timestamp":"2025-03-13 19:02:43"}
{"data":{"action":"NEW_EARNINGS","data":{"amount":78,"courseId":"3","totalPendingEarnings":234,"transactionId":"0f9052de-972b-4310-b7c0-46af0dd1137a"},"userId":"edu_123"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"edu_123\",\"action\":\"NEW_EARNINGS\",\"data\":{\"courseId\":\"3\",\"transactionId\":\"0f9052de-972b-4310-b7c0-46af0dd1137a\",\"amount\":78,\"totalPendingEarnings\":234}}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"162","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:133:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-13 19:02:43"}
{"action":"PAYMENT_PROCESSED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_PROCESSED by mock-user-id - Payment of 100 USD processed for course 3","metadata":{"stripeChargeId":"pi_3R2F9ZBLtTuFPq2g0Kueu7uP"},"service":"payment-service","timestamp":"2025-03-13 19:02:43","transactionId":"0f9052de-972b-4310-b7c0-46af0dd1137a"}
{"level":"info","message":"::ffff:127.0.0.1 - - [13/Mar/2025:17:02:43 +0000] \"POST /api/payments/ HTTP/1.1\" 200 1140 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-13 19:02:43"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-13 19:05:19"}
{"level":"info","message":"Payment split: Amount: $100, Platform: $19, Educator: $78","service":"payment-service","timestamp":"2025-03-13 19:05:19"}
{"data":{"action":"ENROLL_USER","courseId":"4","transactionId":"a8f9cf0c-58e0-45f9-9591-f30e0d174738","userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"mock-user-id\",\"action\":\"ENROLL_USER\",\"courseId\":\"4\",\"transactionId\":\"a8f9cf0c-58e0-45f9-9591-f30e0d174738\"}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"118","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:116:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-13 19:05:21"}
{"data":{"action":"RECORD_PURCHASE","amount":100,"courseId":"4","educatorEarnings":78,"userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"courseId\":\"4\",\"action\":\"RECORD_PURCHASE\",\"userId\":\"mock-user-id\",\"amount\":100,\"educatorEarnings\":78}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"102","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3002/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3002","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3002\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyCourseService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:41:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:124:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify course service: connect ECONNREFUSED ::1:3002","service":"payment-service","timestamp":"2025-03-13 19:05:21"}
{"data":{"action":"NEW_EARNINGS","data":{"amount":78,"courseId":"4","totalPendingEarnings":312,"transactionId":"a8f9cf0c-58e0-45f9-9591-f30e0d174738"},"userId":"edu_123"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"edu_123\",\"action\":\"NEW_EARNINGS\",\"data\":{\"courseId\":\"4\",\"transactionId\":\"a8f9cf0c-58e0-45f9-9591-f30e0d174738\",\"amount\":78,\"totalPendingEarnings\":312}}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"162","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:133:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-13 19:05:21"}
{"action":"PAYMENT_PROCESSED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_PROCESSED by mock-user-id - Payment of 100 USD processed for course 4","metadata":{"stripeChargeId":"pi_3R2FC7BLtTuFPq2g14e0Sw83"},"service":"payment-service","timestamp":"2025-03-13 19:05:21","transactionId":"a8f9cf0c-58e0-45f9-9591-f30e0d174738"}
{"level":"info","message":"::ffff:127.0.0.1 - - [13/Mar/2025:17:05:21 +0000] \"POST /api/payments/ HTTP/1.1\" 200 1140 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-13 19:05:21"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-13 19:06:58"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-13 19:07:02"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-13 19:07:03"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-13 19:07:06"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-13 19:07:06"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-13 19:07:26"}
{"level":"info","message":"Payment split: Amount: $100, Platform: $19, Educator: $78","service":"payment-service","timestamp":"2025-03-13 19:07:26"}
{"data":{"action":"ENROLL_USER","courseId":"5","transactionId":"2b430b6b-52c1-47ea-85f6-0ad7ae8f86be","userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"mock-user-id\",\"action\":\"ENROLL_USER\",\"courseId\":\"5\",\"transactionId\":\"2b430b6b-52c1-47ea-85f6-0ad7ae8f86be\"}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"118","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:121:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-13 19:07:29"}
{"data":{"action":"RECORD_PURCHASE","amount":100,"courseId":"5","educatorEarnings":78,"userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"courseId\":\"5\",\"action\":\"RECORD_PURCHASE\",\"userId\":\"mock-user-id\",\"amount\":100,\"educatorEarnings\":78}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"102","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3002/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3002","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3002\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyCourseService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:41:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:129:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify course service: connect ECONNREFUSED ::1:3002","service":"payment-service","timestamp":"2025-03-13 19:07:29"}
{"data":{"action":"NEW_EARNINGS","data":{"amount":78,"courseId":"5","totalPendingEarnings":390,"transactionId":"2b430b6b-52c1-47ea-85f6-0ad7ae8f86be"},"userId":"edu_123"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"edu_123\",\"action\":\"NEW_EARNINGS\",\"data\":{\"courseId\":\"5\",\"transactionId\":\"2b430b6b-52c1-47ea-85f6-0ad7ae8f86be\",\"amount\":78,\"totalPendingEarnings\":390}}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"162","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:138:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-13 19:07:29"}
{"action":"PAYMENT_PROCESSED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_PROCESSED by mock-user-id - Payment of 100 USD processed for course 5","metadata":{"stripeChargeId":"pi_3R2FEABLtTuFPq2g0qNVjk9G"},"service":"payment-service","timestamp":"2025-03-13 19:07:29","transactionId":"2b430b6b-52c1-47ea-85f6-0ad7ae8f86be"}
{"level":"info","message":"::ffff:127.0.0.1 - - [13/Mar/2025:17:07:29 +0000] \"POST /api/payments/ HTTP/1.1\" 200 1140 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-13 19:07:29"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-13 19:10:21"}
{"level":"info","message":"Payment split: Amount: $100, Platform: $19, Educator: $78","service":"payment-service","timestamp":"2025-03-13 19:10:21"}
{"data":{"action":"ENROLL_USER","courseId":"6","transactionId":"736c7cf7-2d61-41c7-af83-aaeb44d4c80d","userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"mock-user-id\",\"action\":\"ENROLL_USER\",\"courseId\":\"6\",\"transactionId\":\"736c7cf7-2d61-41c7-af83-aaeb44d4c80d\"}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"118","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:121:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-13 19:10:24"}
{"data":{"action":"RECORD_PURCHASE","amount":100,"courseId":"6","educatorEarnings":78,"userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"courseId\":\"6\",\"action\":\"RECORD_PURCHASE\",\"userId\":\"mock-user-id\",\"amount\":100,\"educatorEarnings\":78}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"102","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3002/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3002","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3002\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyCourseService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:41:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:129:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify course service: connect ECONNREFUSED ::1:3002","service":"payment-service","timestamp":"2025-03-13 19:10:24"}
{"data":{"action":"NEW_EARNINGS","data":{"amount":78,"courseId":"6","totalPendingEarnings":468,"transactionId":"736c7cf7-2d61-41c7-af83-aaeb44d4c80d"},"userId":"edu_123"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"edu_123\",\"action\":\"NEW_EARNINGS\",\"data\":{\"courseId\":\"6\",\"transactionId\":\"736c7cf7-2d61-41c7-af83-aaeb44d4c80d\",\"amount\":78,\"totalPendingEarnings\":468}}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"162","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:138:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-13 19:10:24"}
{"action":"PAYMENT_PROCESSED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_PROCESSED by mock-user-id - Payment of 100 USD processed for course 6","metadata":{"stripeChargeId":"pi_3R2FGzBLtTuFPq2g2rwPf5ps"},"service":"payment-service","timestamp":"2025-03-13 19:10:24","transactionId":"736c7cf7-2d61-41c7-af83-aaeb44d4c80d"}
{"level":"info","message":"::ffff:127.0.0.1 - - [13/Mar/2025:17:10:24 +0000] \"POST /api/payments/ HTTP/1.1\" 200 1140 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-13 19:10:24"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-13 19:11:25"}
{"level":"info","message":"Payment split: Amount: $100, Platform: $19, Educator: $78","service":"payment-service","timestamp":"2025-03-13 19:11:25"}
{"data":{"action":"ENROLL_USER","courseId":"7","transactionId":"13953a5c-9f80-4dd5-b924-98fd46370cde","userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"mock-user-id\",\"action\":\"ENROLL_USER\",\"courseId\":\"7\",\"transactionId\":\"13953a5c-9f80-4dd5-b924-98fd46370cde\"}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"118","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:121:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-13 19:11:28"}
{"data":{"action":"RECORD_PURCHASE","amount":100,"courseId":"7","educatorEarnings":78,"userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"courseId\":\"7\",\"action\":\"RECORD_PURCHASE\",\"userId\":\"mock-user-id\",\"amount\":100,\"educatorEarnings\":78}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"102","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3002/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3002","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3002\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyCourseService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:41:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:129:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify course service: connect ECONNREFUSED ::1:3002","service":"payment-service","timestamp":"2025-03-13 19:11:28"}
{"data":{"action":"NEW_EARNINGS","data":{"amount":78,"courseId":"7","totalPendingEarnings":546,"transactionId":"13953a5c-9f80-4dd5-b924-98fd46370cde"},"userId":"edu_123"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"edu_123\",\"action\":\"NEW_EARNINGS\",\"data\":{\"courseId\":\"7\",\"transactionId\":\"13953a5c-9f80-4dd5-b924-98fd46370cde\",\"amount\":78,\"totalPendingEarnings\":546}}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"162","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:138:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-13 19:11:28"}
{"action":"PAYMENT_PROCESSED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_PROCESSED by mock-user-id - Payment of 100 USD processed for course 7","metadata":{"stripeChargeId":"pi_3R2FI1BLtTuFPq2g2HkHHmd2"},"service":"payment-service","timestamp":"2025-03-13 19:11:28","transactionId":"13953a5c-9f80-4dd5-b924-98fd46370cde"}
{"level":"info","message":"::ffff:127.0.0.1 - - [13/Mar/2025:17:11:28 +0000] \"POST /api/payments/ HTTP/1.1\" 200 1140 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-13 19:11:28"}
{"level":"info","message":"POST /api/payments/refund","service":"payment-service","timestamp":"2025-03-13 19:12:21"}
{"error":{},"level":"error","message":"Refund processing error: Stripe: Argument \"id\" must be a string, but got: undefined (on API request to `POST /v1/transfers/{id}/reversals`)","service":"payment-service","timestamp":"2025-03-13 19:12:23"}
{"level":"error","message":"Error processing refund: Refund processing failed: Stripe: Argument \"id\" must be a string, but got: undefined (on API request to `POST /v1/transfers/{id}/reversals`)","service":"payment-service","timestamp":"2025-03-13 19:12:23"}
{"level":"info","message":"::ffff:127.0.0.1 - - [13/Mar/2025:17:12:23 +0000] \"POST /api/payments/refund HTTP/1.1\" 400 172 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-13 19:12:23"}
{"level":"info","message":"POST /api/payments/refund","service":"payment-service","timestamp":"2025-03-13 19:13:14"}
{"error":{"code":"charge_already_refunded","doc_url":"https://stripe.com/docs/error-codes/charge-already-refunded","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"351","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=bVfSrtXOwU_c5fx8ZMQ4cX6lep5U30KBzWd-uYRQwYTQok_-iu8Y-oRD4V_2HDrHdw4CTtGD8yo7LU4J","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Thu, 13 Mar 2025 17:13:14 GMT","idempotency-key":"711fb234-3d00-4f96-89e8-2b7594b5b6cb","original-request":"req_hH6oB0UbtqYL65","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_hH6oB0UbtqYL65","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"raw":{"code":"charge_already_refunded","doc_url":"https://stripe.com/docs/error-codes/charge-already-refunded","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"351","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=bVfSrtXOwU_c5fx8ZMQ4cX6lep5U30KBzWd-uYRQwYTQok_-iu8Y-oRD4V_2HDrHdw4CTtGD8yo7LU4J","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Thu, 13 Mar 2025 17:13:14 GMT","idempotency-key":"711fb234-3d00-4f96-89e8-2b7594b5b6cb","original-request":"req_hH6oB0UbtqYL65","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_hH6oB0UbtqYL65","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"Charge ch_3R2FI1BLtTuFPq2g29MNdtfO has already been refunded.","requestId":"req_hH6oB0UbtqYL65","request_log_url":"https://dashboard.stripe.com/test/logs/req_hH6oB0UbtqYL65?t=1741885993","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_hH6oB0UbtqYL65","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Refund processing error: Charge ch_3R2FI1BLtTuFPq2g29MNdtfO has already been refunded.","service":"payment-service","timestamp":"2025-03-13 19:13:14"}
{"level":"error","message":"Error processing refund: Refund processing failed: Charge ch_3R2FI1BLtTuFPq2g29MNdtfO has already been refunded.","service":"payment-service","timestamp":"2025-03-13 19:13:14"}
{"level":"info","message":"::ffff:127.0.0.1 - - [13/Mar/2025:17:13:14 +0000] \"POST /api/payments/refund HTTP/1.1\" 400 117 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-13 19:13:14"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-13 19:13:53"}
{"level":"info","message":"Payment split: Amount: $100, Platform: $19, Educator: $78","service":"payment-service","timestamp":"2025-03-13 19:13:53"}
{"data":{"action":"ENROLL_USER","courseId":"8","transactionId":"733bea95-e68b-4807-a724-f3114888b402","userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"mock-user-id\",\"action\":\"ENROLL_USER\",\"courseId\":\"8\",\"transactionId\":\"733bea95-e68b-4807-a724-f3114888b402\"}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"118","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:121:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-13 19:13:55"}
{"data":{"action":"RECORD_PURCHASE","amount":100,"courseId":"8","educatorEarnings":78,"userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"courseId\":\"8\",\"action\":\"RECORD_PURCHASE\",\"userId\":\"mock-user-id\",\"amount\":100,\"educatorEarnings\":78}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"102","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3002/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3002","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3002\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyCourseService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:41:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:129:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify course service: connect ECONNREFUSED ::1:3002","service":"payment-service","timestamp":"2025-03-13 19:13:55"}
{"data":{"action":"NEW_EARNINGS","data":{"amount":78,"courseId":"8","totalPendingEarnings":624,"transactionId":"733bea95-e68b-4807-a724-f3114888b402"},"userId":"edu_123"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"edu_123\",\"action\":\"NEW_EARNINGS\",\"data\":{\"courseId\":\"8\",\"transactionId\":\"733bea95-e68b-4807-a724-f3114888b402\",\"amount\":78,\"totalPendingEarnings\":624}}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"162","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:138:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-13 19:13:55"}
{"action":"PAYMENT_PROCESSED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_PROCESSED by mock-user-id - Payment of 100 USD processed for course 8","metadata":{"stripeChargeId":"pi_3R2FKOBLtTuFPq2g2fGIoAZZ"},"service":"payment-service","timestamp":"2025-03-13 19:13:55","transactionId":"733bea95-e68b-4807-a724-f3114888b402"}
{"level":"info","message":"::ffff:127.0.0.1 - - [13/Mar/2025:17:13:55 +0000] \"POST /api/payments/ HTTP/1.1\" 200 1140 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-13 19:13:55"}
{"level":"info","message":"POST /api/payments/refund","service":"payment-service","timestamp":"2025-03-13 19:14:13"}
{"error":{},"level":"error","message":"Refund processing error: Stripe: Argument \"id\" must be a string, but got: undefined (on API request to `POST /v1/transfers/{id}/reversals`)","service":"payment-service","timestamp":"2025-03-13 19:14:15"}
{"level":"error","message":"Error processing refund: Refund processing failed: Stripe: Argument \"id\" must be a string, but got: undefined (on API request to `POST /v1/transfers/{id}/reversals`)","service":"payment-service","timestamp":"2025-03-13 19:14:15"}
{"level":"info","message":"::ffff:127.0.0.1 - - [13/Mar/2025:17:14:15 +0000] \"POST /api/payments/refund HTTP/1.1\" 400 172 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-13 19:14:15"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-13 19:16:30"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-13 19:16:30"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-13 19:17:03"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-13 19:17:03"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-13 19:17:14"}
{"level":"info","message":"Payment split: Amount: $100, Platform: $19, Educator: $78","service":"payment-service","timestamp":"2025-03-13 19:17:15"}
{"data":{"action":"ENROLL_USER","courseId":"9","transactionId":"809e4785-8c2f-4537-a86f-e2e64a882573","userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"mock-user-id\",\"action\":\"ENROLL_USER\",\"courseId\":\"9\",\"transactionId\":\"809e4785-8c2f-4537-a86f-e2e64a882573\"}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"118","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:121:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-13 19:17:17"}
{"data":{"action":"RECORD_PURCHASE","amount":100,"courseId":"9","educatorEarnings":78,"userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"courseId\":\"9\",\"action\":\"RECORD_PURCHASE\",\"userId\":\"mock-user-id\",\"amount\":100,\"educatorEarnings\":78}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"102","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3002/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3002","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3002\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyCourseService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:41:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:129:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify course service: connect ECONNREFUSED ::1:3002","service":"payment-service","timestamp":"2025-03-13 19:17:17"}
{"data":{"action":"NEW_EARNINGS","data":{"amount":78,"courseId":"9","totalPendingEarnings":702,"transactionId":"809e4785-8c2f-4537-a86f-e2e64a882573"},"userId":"edu_123"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"edu_123\",\"action\":\"NEW_EARNINGS\",\"data\":{\"courseId\":\"9\",\"transactionId\":\"809e4785-8c2f-4537-a86f-e2e64a882573\",\"amount\":78,\"totalPendingEarnings\":702}}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"162","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:138:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-13 19:17:17"}
{"action":"PAYMENT_PROCESSED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_PROCESSED by mock-user-id - Payment of 100 USD processed for course 9","metadata":{"stripeChargeId":"pi_3R2FNeBLtTuFPq2g2dbD2qe2"},"service":"payment-service","timestamp":"2025-03-13 19:17:17","transactionId":"809e4785-8c2f-4537-a86f-e2e64a882573"}
{"level":"info","message":"::ffff:127.0.0.1 - - [13/Mar/2025:17:17:17 +0000] \"POST /api/payments/ HTTP/1.1\" 200 1140 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-13 19:17:17"}
{"level":"info","message":"POST /api/payments/refund","service":"payment-service","timestamp":"2025-03-13 19:18:08"}
{"data":{"action":"REMOVE_ENROLLMENT","courseId":"9","transactionId":"d9224faf-25e6-4c06-ad71-90aaf45f6517","userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"mock-user-id\",\"action\":\"REMOVE_ENROLLMENT\",\"courseId\":\"9\",\"transactionId\":\"d9224faf-25e6-4c06-ad71-90aaf45f6517\"}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"124","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processRefund (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:354:5)\n    at async processRefund (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:26:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-13 19:18:10"}
{"data":{"action":"RECORD_REFUND","amount":100,"courseId":"9","educatorEarnings":-78,"userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"courseId\":\"9\",\"action\":\"RECORD_REFUND\",\"userId\":\"mock-user-id\",\"amount\":100,\"educatorEarnings\":-78}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"101","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3002/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3002","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3002\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyCourseService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:41:5)\n    at async Object.processRefund (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:361:5)\n    at async processRefund (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:26:20)"},"level":"error","message":"Failed to notify course service: connect ECONNREFUSED ::1:3002","service":"payment-service","timestamp":"2025-03-13 19:18:10"}
{"data":{"action":"EARNINGS_REFUNDED","data":{"amount":78,"courseId":"9","reason":"requested_by_customer","totalPendingEarnings":546,"transactionId":"d9224faf-25e6-4c06-ad71-90aaf45f6517"},"userId":"edu_123"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"edu_123\",\"action\":\"EARNINGS_REFUNDED\",\"data\":{\"courseId\":\"9\",\"transactionId\":\"d9224faf-25e6-4c06-ad71-90aaf45f6517\",\"amount\":78,\"totalPendingEarnings\":546,\"reason\":\"requested_by_customer\"}}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"200","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processRefund (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:370:5)\n    at async processRefund (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:26:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-13 19:18:10"}
{"action":"REFUND_PROCESSED","actor":"mock-user-id","level":"info","message":"AUDIT: REFUND_PROCESSED by mock-user-id - Refund of 100 USD processed for transaction 809e4785-8c2f-4537-a86f-e2e64a882573","metadata":{"originalTransactionId":"809e4785-8c2f-4537-a86f-e2e64a882573","reason":"requested_by_customer"},"service":"payment-service","timestamp":"2025-03-13 19:18:10","transactionId":"d9224faf-25e6-4c06-ad71-90aaf45f6517"}
{"level":"info","message":"::ffff:127.0.0.1 - - [13/Mar/2025:17:18:11 +0000] \"POST /api/payments/refund HTTP/1.1\" 200 1279 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-13 19:18:11"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 13:44:05"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 13:44:05"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 13:50:50"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 13:50:50"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 13:50:54"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 13:50:54"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 13:51:01"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 13:51:01"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 13:51:08"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 13:51:08"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 13:51:29"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 13:51:29"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 13:51:33"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 13:51:33"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 13:51:43"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 13:51:43"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 13:51:49"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 13:51:49"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 13:52:11"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 13:52:11"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 13:52:19"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 13:52:19"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 13:52:24"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 13:52:25"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 13:52:32"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 13:52:32"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 13:52:40"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 13:52:40"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 13:52:49"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 13:52:57"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 13:52:57"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 13:53:12"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 13:53:13"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 13:53:52"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 13:53:52"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 13:54:12"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 13:54:13"}
{"level":"info","message":"POST /api/payments/total-earnings","service":"payment-service","timestamp":"2025-03-14 13:54:25"}
{"level":"info","message":"::ffff:127.0.0.1 - - [14/Mar/2025:11:54:25 +0000] \"POST /api/payments/total-earnings HTTP/1.1\" 404 167 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-14 13:54:25"}
{"level":"info","message":"POST /api/payments/total-earnings","service":"payment-service","timestamp":"2025-03-14 13:54:45"}
{"level":"info","message":"::ffff:127.0.0.1 - - [14/Mar/2025:11:54:45 +0000] \"POST /api/payments/total-earnings HTTP/1.1\" 404 167 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-14 13:54:45"}
{"level":"info","message":"GET /api/payments/total-earnings","service":"payment-service","timestamp":"2025-03-14 13:54:59"}
{"level":"info","message":"::ffff:127.0.0.1 - - [14/Mar/2025:11:54:59 +0000] \"GET /api/payments/total-earnings HTTP/1.1\" 404 166 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-14 13:54:59"}
{"level":"info","message":"GET /api/payments/total-earnings","service":"payment-service","timestamp":"2025-03-14 13:55:03"}
{"level":"info","message":"::ffff:127.0.0.1 - - [14/Mar/2025:11:55:03 +0000] \"GET /api/payments/total-earnings HTTP/1.1\" 404 166 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-14 13:55:03"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 13:55:49"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 13:55:49"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 13:55:52"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 13:55:52"}
{"level":"info","message":"GET /api/payments/total-earnings","service":"payment-service","timestamp":"2025-03-14 13:55:57"}
{"level":"info","message":"::ffff:127.0.0.1 - - [14/Mar/2025:11:55:57 +0000] \"GET /api/payments/total-earnings HTTP/1.1\" 404 166 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-14 13:55:57"}
{"level":"info","message":"GET /api/payments/809e4785-8c2f-4537-a86f-e2e64a882573","service":"payment-service","timestamp":"2025-03-14 13:56:33"}
{"level":"info","message":"::ffff:127.0.0.1 - - [14/Mar/2025:11:56:33 +0000] \"GET /api/payments/809e4785-8c2f-4537-a86f-e2e64a882573 HTTP/1.1\" 404 188 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-14 13:56:33"}
{"level":"info","message":"GET /api/payments/809e4785-8c2f-4537-a86f-e2e64a882573","service":"payment-service","timestamp":"2025-03-14 13:57:27"}
{"level":"info","message":"::ffff:127.0.0.1 - - [14/Mar/2025:11:57:27 +0000] \"GET /api/payments/809e4785-8c2f-4537-a86f-e2e64a882573 HTTP/1.1\" 404 188 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-14 13:57:27"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-14 13:57:50"}
{"level":"info","message":"::ffff:127.0.0.1 - - [14/Mar/2025:11:57:50 +0000] \"POST /api/payments/ HTTP/1.1\" 404 153 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-14 13:57:50"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 13:58:17"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 13:58:17"}
{"level":"info","message":"GET /api/payments/809e4785-8c2f-4537-a86f-e2e64a882573","service":"payment-service","timestamp":"2025-03-14 13:58:29"}
{"level":"info","message":"::ffff:127.0.0.1 - - [14/Mar/2025:11:58:29 +0000] \"GET /api/payments/809e4785-8c2f-4537-a86f-e2e64a882573 HTTP/1.1\" 200 1088 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-14 13:58:29"}
{"level":"info","message":"GET /api/payments/total-earnings","service":"payment-service","timestamp":"2025-03-14 13:58:43"}
{"level":"error","message":"Error fetching transaction: Transaction not found","service":"payment-service","timestamp":"2025-03-14 13:58:43"}
{"level":"info","message":"::ffff:127.0.0.1 - - [14/Mar/2025:11:58:43 +0000] \"GET /api/payments/total-earnings HTTP/1.1\" 404 51 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-14 13:58:43"}
{"level":"info","message":"GET /api/payments/total-earnings","service":"payment-service","timestamp":"2025-03-14 13:58:50"}
{"level":"error","message":"Error fetching transaction: Transaction not found","service":"payment-service","timestamp":"2025-03-14 13:58:50"}
{"level":"info","message":"::ffff:127.0.0.1 - - [14/Mar/2025:11:58:50 +0000] \"GET /api/payments/total-earnings HTTP/1.1\" 404 51 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-14 13:58:50"}
{"level":"info","message":"GET /api/payments/total-earnings","service":"payment-service","timestamp":"2025-03-14 13:59:09"}
{"level":"error","message":"Error fetching transaction: Transaction not found","service":"payment-service","timestamp":"2025-03-14 13:59:09"}
{"level":"info","message":"::ffff:127.0.0.1 - - [14/Mar/2025:11:59:09 +0000] \"GET /api/payments/total-earnings HTTP/1.1\" 404 51 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-14 13:59:09"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 13:59:41"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 13:59:42"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 13:59:48"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 13:59:48"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 13:59:50"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 13:59:50"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 13:59:55"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 13:59:55"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 14:00:02"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 14:00:02"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 14:00:11"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 14:00:12"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 14:00:16"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 14:00:16"}
{"level":"info","message":"GET /api/payments/total-earnings","service":"payment-service","timestamp":"2025-03-14 14:00:24"}
{"level":"info","message":"::ffff:127.0.0.1 - - [14/Mar/2025:12:00:24 +0000] \"GET /api/payments/total-earnings HTTP/1.1\" 500 88 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-14 14:00:24"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","isOperational":true,"level":"error","message":"Unhandled Rejection at:","service":"payment-service","status":"error","statusCode":500,"timestamp":"2025-03-14 14:00:24"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 14:01:21"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 14:01:21"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 14:01:32"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 14:01:32"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 14:01:40"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 14:01:40"}
{"level":"info","message":"GET /api/payments/total-earnings","service":"payment-service","timestamp":"2025-03-14 14:01:53"}
{"level":"info","message":"::ffff:127.0.0.1 - - [14/Mar/2025:12:01:53 +0000] \"GET /api/payments/total-earnings HTTP/1.1\" 500 125 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-14 14:01:53"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","isOperational":true,"level":"error","message":"Unhandled Rejection at:","service":"payment-service","status":"error","statusCode":500,"timestamp":"2025-03-14 14:01:53"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 14:02:42"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 14:02:42"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 14:03:42"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 14:03:42"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 14:04:53"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 14:04:53"}
{"level":"info","message":"GET /api/payments/total-earnings","service":"payment-service","timestamp":"2025-03-14 14:04:57"}
{"level":"info","message":"::ffff:127.0.0.1 - - [14/Mar/2025:12:04:57 +0000] \"GET /api/payments/total-earnings HTTP/1.1\" 200 25 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-14 14:04:57"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 14:06:19"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 14:06:19"}
{"level":"info","message":"GET /api/payments/total-earnings","service":"payment-service","timestamp":"2025-03-14 14:06:24"}
{"level":"info","message":"::ffff:127.0.0.1 - - [14/Mar/2025:12:06:24 +0000] \"GET /api/payments/total-earnings HTTP/1.1\" 200 27 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-14 14:06:24"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 14:08:05"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 14:08:06"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 14:08:10"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 14:08:10"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 14:08:30"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 14:08:31"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 14:08:46"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 14:08:46"}
{"level":"info","message":"POST /api/payouts/create-account","service":"payment-service","timestamp":"2025-03-14 14:09:59"}
{"level":"info","message":"::ffff:127.0.0.1 - - [14/Mar/2025:12:09:59 +0000] \"POST /api/payouts/create-account HTTP/1.1\" 404 166 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-14 14:09:59"}
{"level":"info","message":"POST /api/payments/create-account","service":"payment-service","timestamp":"2025-03-14 14:10:11"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-14 14:10:11"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 14:11:07"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 14:11:07"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 14:11:26"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 14:11:26"}
{"level":"info","message":"POST /api/payments/create-account","service":"payment-service","timestamp":"2025-03-14 14:11:34"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-14 14:11:34"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 14:12:21"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 14:12:21"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 14:12:28"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 14:12:29"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 14:12:40"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 14:12:40"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 14:12:51"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 14:12:51"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 14:12:56"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 14:12:56"}
{"level":"info","message":"POST /api/payments/create-account","service":"payment-service","timestamp":"2025-03-14 14:13:09"}
{"error":{"clientVersion":"6.4.1","code":"P2002","meta":{"modelName":"stripeAccount","target":["educatorId"]},"name":"PrismaClientKnownRequestError"},"level":"error","message":"Error creating Stripe account: \nInvalid `prisma.stripeAccount.create()` invocation in\nC:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:618:62\n\n  615   }\n  616 );\n  617 \n→ 618 const educatorStripeAccount = await prisma.stripeAccount.create(\nUnique constraint failed on the fields: (`educatorId`)","service":"payment-service","timestamp":"2025-03-14 14:13:20"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","isOperational":true,"level":"error","message":"Unhandled Rejection at:","service":"payment-service","status":"error","statusCode":500,"timestamp":"2025-03-14 14:13:20"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 14:15:45"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 14:15:45"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 14:15:50"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 14:15:50"}
{"level":"info","message":"POST /api/payments/create-account","service":"payment-service","timestamp":"2025-03-14 14:15:56"}
{"error":{"clientVersion":"6.4.1","code":"P2002","meta":{"modelName":"stripeAccount","target":["educatorId"]},"name":"PrismaClientKnownRequestError"},"level":"error","message":"Error creating Stripe account: \nInvalid `prisma.stripeAccount.create()` invocation in\nC:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:618:62\n\n  615   }\n  616 );\n  617 \n→ 618 const educatorStripeAccount = await prisma.stripeAccount.create(\nUnique constraint failed on the fields: (`educatorId`)","service":"payment-service","timestamp":"2025-03-14 14:16:03"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","isOperational":true,"level":"error","message":"Unhandled Rejection at:","service":"payment-service","status":"error","statusCode":500,"timestamp":"2025-03-14 14:16:03"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 14:17:18"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 14:17:18"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 14:18:03"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 14:18:03"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 14:19:22"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 14:19:22"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 14:19:38"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 14:19:38"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 14:19:41"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 14:19:41"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 14:19:57"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 14:19:57"}
{"level":"info","message":"POST /api/payments/create-account","service":"payment-service","timestamp":"2025-03-14 14:26:45"}
{"error":{"code":"parameter_unknown","doc_url":"https://stripe.com/docs/error-codes/parameter-unknown","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"343","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=nbt6LpS-A_6Vu7qGhmpV0_o63ws2P81RqrVOb7z6QeItto2DKX3zXhIYdxGoZSWTHOIDLy-yLMx7CYIr","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Fri, 14 Mar 2025 12:26:45 GMT","idempotency-key":"06e8437c-c6c1-4a42-8821-a8d9db1fa228","original-request":"req_4LIPPld0ojODK0","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_4LIPPld0ojODK0","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"param":"ssn_last_4","raw":{"code":"parameter_unknown","doc_url":"https://stripe.com/docs/error-codes/parameter-unknown","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"343","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=nbt6LpS-A_6Vu7qGhmpV0_o63ws2P81RqrVOb7z6QeItto2DKX3zXhIYdxGoZSWTHOIDLy-yLMx7CYIr","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Fri, 14 Mar 2025 12:26:45 GMT","idempotency-key":"06e8437c-c6c1-4a42-8821-a8d9db1fa228","original-request":"req_4LIPPld0ojODK0","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_4LIPPld0ojODK0","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"Received unknown parameter: ssn_last_4","param":"ssn_last_4","requestId":"req_4LIPPld0ojODK0","request_log_url":"https://dashboard.stripe.com/test/logs/req_4LIPPld0ojODK0?t=1741955205","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_4LIPPld0ojODK0","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Error creating Stripe account: Received unknown parameter: ssn_last_4","service":"payment-service","timestamp":"2025-03-14 14:26:47"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","isOperational":true,"level":"error","message":"Unhandled Rejection at:","service":"payment-service","status":"error","statusCode":500,"timestamp":"2025-03-14 14:26:47"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 14:27:26"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 14:27:26"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 14:27:34"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 14:27:34"}
{"level":"info","message":"POST /api/payments/create-account","service":"payment-service","timestamp":"2025-03-14 14:31:37"}
{"action":"STRIPE_ACCOUNT_CREATED","actor":"edu_123","level":"info","message":"AUDIT: STRIPE_ACCOUNT_CREATED by edu_123 - Stripe Connect account created for educator edu_123","metadata":{"accountId":"acct_1R2XOmBSQj761K0C"},"service":"payment-service","timestamp":"2025-03-14 14:31:46","transactionId":null}
{"level":"info","message":"::ffff:127.0.0.1 - - [14/Mar/2025:12:31:46 +0000] \"POST /api/payments/create-account HTTP/1.1\" 201 109 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-14 14:31:46"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-14 14:35:28"}
{"level":"info","message":"Payment split: Amount: $100, Platform: $19, Educator: $78","service":"payment-service","timestamp":"2025-03-14 14:35:28"}
{"data":{"action":"ENROLL_USER","courseId":"1","transactionId":"2737fb78-5559-47ec-87e3-f7cddf06903b","userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"mock-user-id\",\"action\":\"ENROLL_USER\",\"courseId\":\"1\",\"transactionId\":\"2737fb78-5559-47ec-87e3-f7cddf06903b\"}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"118","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:121:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:9:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-14 14:35:31"}
{"data":{"action":"RECORD_PURCHASE","amount":100,"courseId":"1","educatorEarnings":78,"userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"courseId\":\"1\",\"action\":\"RECORD_PURCHASE\",\"userId\":\"mock-user-id\",\"amount\":100,\"educatorEarnings\":78}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"102","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3002/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3002","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3002\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyCourseService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:41:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:129:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:9:20)"},"level":"error","message":"Failed to notify course service: connect ECONNREFUSED ::1:3002","service":"payment-service","timestamp":"2025-03-14 14:35:31"}
{"error":{},"level":"error","message":"Payment processing error: getTotalPendingEarnings is not defined","service":"payment-service","timestamp":"2025-03-14 14:35:31"}
{"action":"PAYMENT_FAILED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_FAILED by mock-user-id - Payment of 100 USD failed for course 1","metadata":{"error":"getTotalPendingEarnings is not defined"},"service":"payment-service","timestamp":"2025-03-14 14:35:31","transactionId":null}
{"level":"error","message":"Error processing payment: Payment processing failed: getTotalPendingEarnings is not defined","service":"payment-service","timestamp":"2025-03-14 14:35:31"}
{"level":"info","message":"::ffff:127.0.0.1 - - [14/Mar/2025:12:35:31 +0000] \"POST /api/payments/ HTTP/1.1\" 400 95 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-14 14:35:31"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 14:37:29"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 14:37:29"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 14:38:05"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 14:38:06"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 14:38:31"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 14:38:31"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 14:38:40"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 14:38:40"}
{"level":"info","message":"POST /api/payments/create-account","service":"payment-service","timestamp":"2025-03-14 14:40:21"}
{"error":{"clientVersion":"6.4.1","code":"P2002","meta":{"modelName":"stripeAccount","target":["educatorId"]},"name":"PrismaClientKnownRequestError"},"level":"error","message":"Error creating Stripe account: \nInvalid `prisma.stripeAccount.create()` invocation in\nC:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:613:62\n\n  610   }\n  611 );\n  612 \n→ 613 const educatorStripeAccount = await prisma.stripeAccount.create(\nUnique constraint failed on the fields: (`educatorId`)","service":"payment-service","timestamp":"2025-03-14 14:40:45"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","isOperational":true,"level":"error","message":"Unhandled Rejection at:","service":"payment-service","status":"error","statusCode":500,"timestamp":"2025-03-14 14:40:45"}
{"level":"info","message":"DELETE /api/payouts//delete-account","service":"payment-service","timestamp":"2025-03-14 14:41:15"}
{"level":"info","message":"::ffff:127.0.0.1 - - [14/Mar/2025:12:41:15 +0000] \"DELETE /api/payouts//delete-account HTTP/1.1\" 404 169 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-14 14:41:15"}
{"level":"info","message":"DELETE /api/payouts/delete-account","service":"payment-service","timestamp":"2025-03-14 14:41:59"}
{"level":"info","message":"::ffff:127.0.0.1 - - [14/Mar/2025:12:41:59 +0000] \"DELETE /api/payouts/delete-account HTTP/1.1\" 404 168 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-14 14:41:59"}
{"level":"info","message":"DELETE /api/payments/delete-account","service":"payment-service","timestamp":"2025-03-14 14:42:13"}
{"error":{"clientVersion":"6.4.1","name":"PrismaClientValidationError"},"level":"error","message":"Error deleting educator account: \nInvalid `prisma.stripeAccount.delete()` invocation in\nC:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:661:38\n\n  658 await stripe.accounts.del(account);\n  659 \n  660 // Delete the local Stripe account record\n→ 661 await prisma.stripeAccount.delete({\n        where: {\n          educatorId: \"edu_123\",\n      ?   id?: String,\n      ?   AND?: stripeAccountWhereInput | stripeAccountWhereInput[],\n      ?   OR?: stripeAccountWhereInput[],\n      ?   NOT?: stripeAccountWhereInput | stripeAccountWhereInput[],\n      ?   email?: StringFilter | String,\n      ?   stripeAccountId?: StringFilter | String,\n      ?   stripeBankAccount?: StringFilter | String,\n      ?   createdAt?: DateTimeFilter | DateTime,\n      ?   updatedAt?: DateTimeFilter | DateTime\n        }\n      })\n\nArgument `where` of type stripeAccountWhereUniqueInput needs at least one of `id` or `stripeAccount_educatorId_unique` arguments. Available options are marked with ?.","service":"payment-service","timestamp":"2025-03-14 14:42:15"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","isOperational":true,"level":"error","message":"Unhandled Rejection at:","service":"payment-service","status":"error","statusCode":500,"timestamp":"2025-03-14 14:42:15"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 14:43:19"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 14:43:19"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 14:43:34"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 14:43:34"}
{"level":"info","message":"DELETE /api/payments/delete-account","service":"payment-service","timestamp":"2025-03-14 14:43:39"}
{"error":{"code":"account_invalid","doc_url":"https://stripe.com/docs/error-codes/account-invalid","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"435","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=R1vs74kQJarnwW3aasp1uxh2Exlj7Jz0km4iO8Byy9XUOp4fAGhY0Zt3YZOOcEjcB7QrfmQWQmy9LHo6","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Fri, 14 Mar 2025 12:43:38 GMT","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"raw":{"code":"account_invalid","doc_url":"https://stripe.com/docs/error-codes/account-invalid","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"435","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=R1vs74kQJarnwW3aasp1uxh2Exlj7Jz0km4iO8Byy9XUOp4fAGhY0Zt3YZOOcEjcB7QrfmQWQmy9LHo6","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Fri, 14 Mar 2025 12:43:38 GMT","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"The provided key 'sk_test_*********************************************************************************************PTwh7s' does not have access to account 'acct_1R2XXEPbpYZzQMeg' (or that account does not exist). Application access may have been revoked.","statusCode":403,"type":"invalid_request_error"},"rawType":"invalid_request_error","statusCode":403,"type":"StripePermissionError"},"level":"error","message":"Error deleting educator account: The provided key 'sk_test_*********************************************************************************************PTwh7s' does not have access to account 'acct_1R2XXEPbpYZzQMeg' (or that account does not exist). Application access may have been revoked.","service":"payment-service","timestamp":"2025-03-14 14:43:39"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","isOperational":true,"level":"error","message":"Unhandled Rejection at:","service":"payment-service","status":"error","statusCode":500,"timestamp":"2025-03-14 14:43:39"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 14:44:14"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 14:44:15"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 14:45:21"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 14:45:21"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 14:47:05"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 14:47:05"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 14:48:27"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 14:48:28"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 14:48:31"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 14:48:32"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 14:48:48"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 14:48:48"}
{"level":"info","message":"GET /api/payments/total-earnings","service":"payment-service","timestamp":"2025-03-14 14:49:06"}
{"level":"info","message":"::ffff:127.0.0.1 - - [14/Mar/2025:12:49:06 +0000] \"GET /api/payments/total-earnings HTTP/1.1\" 200 26 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-14 14:49:06"}
{"level":"info","message":"POST /api/payments/refund","service":"payment-service","timestamp":"2025-03-14 15:01:34"}
{"error":{"isOperational":true,"status":"fail","statusCode":404},"level":"error","message":"Refund processing error: Transaction not found","service":"payment-service","timestamp":"2025-03-14 15:01:34"}
{"level":"error","message":"Error processing refund: Refund processing failed: Transaction not found","service":"payment-service","timestamp":"2025-03-14 15:01:34"}
{"level":"info","message":"::ffff:127.0.0.1 - - [14/Mar/2025:13:01:34 +0000] \"POST /api/payments/refund HTTP/1.1\" 400 77 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-14 15:01:34"}
{"level":"info","message":"POST /api/payments/refund","service":"payment-service","timestamp":"2025-03-14 15:02:06"}
{"data":{"action":"REMOVE_ENROLLMENT","courseId":"1","transactionId":"7c3d960f-7733-4c10-9a6b-c33614e5e52d","userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"mock-user-id\",\"action\":\"REMOVE_ENROLLMENT\",\"courseId\":\"1\",\"transactionId\":\"7c3d960f-7733-4c10-9a6b-c33614e5e52d\"}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"124","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processRefund (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:369:5)\n    at async processRefund (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:28:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-14 15:02:10"}
{"data":{"action":"RECORD_REFUND","amount":100,"courseId":"1","educatorEarnings":-78,"userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"courseId\":\"1\",\"action\":\"RECORD_REFUND\",\"userId\":\"mock-user-id\",\"amount\":100,\"educatorEarnings\":-78}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"101","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3002/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3002","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3002\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyCourseService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:41:5)\n    at async Object.processRefund (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:376:5)\n    at async processRefund (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:28:20)"},"level":"error","message":"Failed to notify course service: connect ECONNREFUSED ::1:3002","service":"payment-service","timestamp":"2025-03-14 15:02:10"}
{"data":{"action":"EARNINGS_REFUNDED","data":{"amount":78,"courseId":"1","reason":"requested_by_customer","transactionId":"7c3d960f-7733-4c10-9a6b-c33614e5e52d"},"userId":"edu_123"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"edu_123\",\"action\":\"EARNINGS_REFUNDED\",\"data\":{\"courseId\":\"1\",\"transactionId\":\"7c3d960f-7733-4c10-9a6b-c33614e5e52d\",\"amount\":78,\"reason\":\"requested_by_customer\"}}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"173","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processRefund (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:385:5)\n    at async processRefund (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:28:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-14 15:02:10"}
{"action":"REFUND_PROCESSED","actor":"mock-user-id","level":"info","message":"AUDIT: REFUND_PROCESSED by mock-user-id - Refund of 100 USD processed for transaction 2737fb78-5559-47ec-87e3-f7cddf06903b","metadata":{"originalTransactionId":"2737fb78-5559-47ec-87e3-f7cddf06903b","reason":"requested_by_customer"},"service":"payment-service","timestamp":"2025-03-14 15:02:10","transactionId":"7c3d960f-7733-4c10-9a6b-c33614e5e52d"}
{"level":"info","message":"::ffff:127.0.0.1 - - [14/Mar/2025:13:02:10 +0000] \"POST /api/payments/refund HTTP/1.1\" 200 1279 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-14 15:02:10"}
{"level":"info","message":"GET /api/payments/total-earnings","service":"payment-service","timestamp":"2025-03-14 15:03:39"}
{"level":"info","message":"::ffff:127.0.0.1 - - [14/Mar/2025:13:03:39 +0000] \"GET /api/payments/total-earnings HTTP/1.1\" 200 27 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-14 15:03:39"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 15:05:52"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 15:05:52"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 15:06:34"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 15:06:37"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 15:06:37"}
{"level":"info","message":"GET /api/payments/total-earnings","service":"payment-service","timestamp":"2025-03-14 15:06:52"}
{"level":"info","message":"::ffff:127.0.0.1 - - [14/Mar/2025:13:06:52 +0000] \"GET /api/payments/total-earnings HTTP/1.1\" 200 25 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-14 15:06:52"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 15:07:38"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 15:07:38"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 15:07:52"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 15:07:52"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 15:08:01"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 15:08:01"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 15:08:05"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 15:08:05"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 15:08:09"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 15:08:09"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 15:08:18"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 15:08:18"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 15:08:26"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 15:08:26"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 15:08:45"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 15:08:45"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 15:08:55"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 15:08:55"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 15:09:01"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 15:09:01"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 15:09:07"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 15:09:08"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 15:09:14"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 15:09:14"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 15:09:27"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 15:09:27"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 15:09:33"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 15:09:33"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 15:09:39"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 15:09:39"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 15:09:46"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 15:09:46"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 15:09:53"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 15:09:53"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 15:10:07"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 15:10:07"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 15:10:49"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 15:10:50"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 15:11:09"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 15:11:09"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 15:11:18"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 15:11:18"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 15:11:31"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 15:11:31"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 15:11:35"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 15:11:35"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 15:11:39"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 15:11:39"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 15:11:51"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 15:11:52"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 15:11:57"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 15:11:57"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 15:12:20"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 15:12:20"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 15:12:27"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 15:12:27"}
{"level":"info","message":"GET /api/payments/current-balance","service":"payment-service","timestamp":"2025-03-14 15:16:07"}
{"level":"info","message":"::ffff:127.0.0.1 - - [14/Mar/2025:13:16:07 +0000] \"GET /api/payments/current-balance HTTP/1.1\" 500 88 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-14 15:16:07"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","isOperational":true,"level":"error","message":"Unhandled Rejection at:","service":"payment-service","status":"error","statusCode":500,"timestamp":"2025-03-14 15:16:07"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 15:16:30"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 15:16:30"}
{"level":"info","message":"GET /api/payments/current-balance","service":"payment-service","timestamp":"2025-03-14 15:16:43"}
{"level":"info","message":"::ffff:127.0.0.1 - - [14/Mar/2025:13:16:44 +0000] \"GET /api/payments/current-balance HTTP/1.1\" 200 281 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-14 15:16:44"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 15:18:44"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 15:18:44"}
{"level":"info","message":"GET /api/payments/current-balance","service":"payment-service","timestamp":"2025-03-14 15:18:49"}
{"level":"info","message":"::ffff:127.0.0.1 - - [14/Mar/2025:13:18:51 +0000] \"GET /api/payments/current-balance HTTP/1.1\" 200 16 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-14 15:18:51"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 15:19:23"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 15:19:26"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 15:19:26"}
{"level":"info","message":"GET /api/payments/current-balance","service":"payment-service","timestamp":"2025-03-14 15:19:32"}
{"level":"info","message":"::ffff:127.0.0.1 - - [14/Mar/2025:13:19:32 +0000] \"GET /api/payments/current-balance HTTP/1.1\" 200 16 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-14 15:19:32"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 15:20:28"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 15:20:28"}
{"level":"info","message":"GET /api/payments/current-balance","service":"payment-service","timestamp":"2025-03-14 15:20:29"}
{"level":"info","message":"::ffff:127.0.0.1 - - [14/Mar/2025:13:20:30 +0000] \"GET /api/payments/current-balance HTTP/1.1\" 200 281 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-14 15:20:30"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 15:21:19"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 15:21:19"}
{"level":"info","message":"GET /api/payments/current-balance","service":"payment-service","timestamp":"2025-03-14 15:22:16"}
{"level":"info","message":"::ffff:127.0.0.1 - - [14/Mar/2025:13:22:17 +0000] \"GET /api/payments/current-balance HTTP/1.1\" 200 27 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-14 15:22:17"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 15:22:34"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 15:22:35"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 15:22:47"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 15:22:47"}
{"level":"info","message":"GET /api/payments/current-balance","service":"payment-service","timestamp":"2025-03-14 15:22:49"}
{"level":"info","message":"::ffff:127.0.0.1 - - [14/Mar/2025:13:22:50 +0000] \"GET /api/payments/current-balance HTTP/1.1\" 200 16 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-14 15:22:50"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 15:23:14"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 15:23:14"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 15:23:25"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 15:23:25"}
{"level":"info","message":"GET /api/payments/current-balance","service":"payment-service","timestamp":"2025-03-14 15:23:25"}
{"level":"info","message":"::ffff:127.0.0.1 - - [14/Mar/2025:13:23:26 +0000] \"GET /api/payments/current-balance HTTP/1.1\" 200 83 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-14 15:23:26"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-14 15:26:32"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-14 15:26:32"}
{"level":"info","message":"GET /api/payments/current-balance","service":"payment-service","timestamp":"2025-03-14 15:26:36"}
{"level":"info","message":"::ffff:127.0.0.1 - - [14/Mar/2025:13:26:38 +0000] \"GET /api/payments/current-balance HTTP/1.1\" 200 53 \"-\" \"PostmanRuntime/7.39.1\"","service":"payment-service","timestamp":"2025-03-14 15:26:38"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 14:12:32"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 14:12:33"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 14:51:55"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 14:51:55"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 14:52:05"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 14:52:06"}
{"level":"info","message":"GET /api/reports/financial%20","service":"payment-service","timestamp":"2025-03-16 14:52:55"}
{"level":"info","message":"::ffff:127.0.0.1 - - [16/Mar/2025:12:52:55 +0000] \"GET /api/reports/financial%20 HTTP/1.1\" 404 163 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-16 14:52:55"}
{"level":"info","message":"GET /api/reports/financial","service":"payment-service","timestamp":"2025-03-16 14:53:13"}
{"level":"error","message":"Error generating financial report: prisma.sql is not a function","service":"payment-service","timestamp":"2025-03-16 14:53:13"}
{"level":"info","message":"::ffff:127.0.0.1 - - [16/Mar/2025:12:53:13 +0000] \"GET /api/reports/financial HTTP/1.1\" 500 1582 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-16 14:53:13"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 14:54:48"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 14:54:48"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 14:56:14"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 14:56:14"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 14:57:34"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 14:57:34"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 14:58:00"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 14:58:00"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 14:58:08"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 14:58:08"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 14:59:25"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 14:59:25"}
{"level":"info","message":"GET /api/reports/financial","service":"payment-service","timestamp":"2025-03-16 14:59:29"}
{"level":"error","message":"Error generating financial report: prisma.sql is not a function","service":"payment-service","timestamp":"2025-03-16 14:59:29"}
{"level":"info","message":"::ffff:127.0.0.1 - - [16/Mar/2025:12:59:29 +0000] \"GET /api/reports/financial HTTP/1.1\" 500 1582 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-16 14:59:29"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:00:41"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:00:41"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:01:05"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:01:05"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:02:11"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:02:12"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:02:35"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:02:36"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:03:09"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:03:10"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:03:17"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:03:17"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:03:37"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:03:37"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:05:08"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:05:08"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:05:15"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:05:16"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:05:27"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:05:27"}
{"level":"info","message":"GET /api/reports/financial","service":"payment-service","timestamp":"2025-03-16 15:06:04"}
{"level":"error","message":"Error generating financial report: `$queryRaw` is a tag function, please use it like the following:\n```\nconst result = await prisma.$queryRaw`SELECT * FROM User WHERE id = ${1} OR email = ${'user@email.com'};`\n```\n\nOr read our docs at https://www.prisma.io/docs/concepts/components/prisma-client/raw-database-access#queryraw\n","service":"payment-service","timestamp":"2025-03-16 15:06:04"}
{"level":"info","message":"::ffff:127.0.0.1 - - [16/Mar/2025:13:06:04 +0000] \"GET /api/reports/financial HTTP/1.1\" 500 526 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-16 15:06:04"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:07:57"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:07:57"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:08:08"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:08:11"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:08:11"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:09:15"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:09:16"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:09:28"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:09:28"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:10:13"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:10:14"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:10:30"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:10:30"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:10:34"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:10:34"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:10:46"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:10:46"}
{"level":"info","message":"GET /api/reports/financial","service":"payment-service","timestamp":"2025-03-16 15:11:02"}
{"level":"error","message":"Error generating financial report: \nInvalid `prisma.$queryRaw()` invocation:\n\n\nRaw query failed. Code: `42601`. Message: `ERROR: syntax error at or near \"$1\"`","service":"payment-service","timestamp":"2025-03-16 15:11:02"}
{"level":"info","message":"::ffff:127.0.0.1 - - [16/Mar/2025:13:11:02 +0000] \"GET /api/reports/financial HTTP/1.1\" 500 442 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-16 15:11:02"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:14:09"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:14:09"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:15:38"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:15:38"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:16:12"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:16:17"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:16:17"}
{"level":"info","message":"GET /api/reports/financial","service":"payment-service","timestamp":"2025-03-16 15:16:37"}
{"level":"error","message":"Error generating financial report: \nInvalid `prisma.$queryRaw()` invocation:\n\n\nRaw query failed. Code: `42601`. Message: `ERROR: syntax error at or near \"$1\"`","service":"payment-service","timestamp":"2025-03-16 15:16:37"}
{"level":"info","message":"::ffff:127.0.0.1 - - [16/Mar/2025:13:16:37 +0000] \"GET /api/reports/financial HTTP/1.1\" 500 442 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-16 15:16:37"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:24:42"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:24:42"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:24:57"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:24:57"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:25:38"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:25:38"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:25:41"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:25:41"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:25:58"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:25:58"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:26:31"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:26:31"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:26:56"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:26:56"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:27:40"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:27:40"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:27:46"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:27:46"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:27:53"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:27:53"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:27:58"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:27:58"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:28:15"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:28:15"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:28:36"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:28:36"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:28:53"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:28:53"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:29:02"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:29:03"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:29:14"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:29:14"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:29:20"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:29:20"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:29:26"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:29:26"}
{"level":"info","message":"GET /api/reports/financial","service":"payment-service","timestamp":"2025-03-16 15:29:34"}
{"level":"info","message":"::ffff:127.0.0.1 - - [16/Mar/2025:13:29:35 +0000] \"GET /api/reports/financial HTTP/1.1\" 500 613 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-16 15:29:35"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:53:49"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:53:49"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:54:00"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:54:01"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:54:27"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:54:28"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:54:30"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:54:31"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:54:34"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:54:34"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:54:48"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:54:48"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:54:51"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:54:51"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:55:20"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:55:20"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:55:26"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:55:26"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:55:35"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:55:35"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:55:43"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:55:43"}
{"level":"info","message":"GET /api/reports/financial","service":"payment-service","timestamp":"2025-03-16 15:55:56"}
{"level":"info","message":"::ffff:127.0.0.1 - - [16/Mar/2025:13:55:56 +0000] \"GET /api/reports/financial HTTP/1.1\" 200 455 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-16 15:55:56"}
{"level":"info","message":"GET /api/reports/financial/pdf","service":"payment-service","timestamp":"2025-03-16 15:58:26"}
{"level":"info","message":"::ffff:127.0.0.1 - - [16/Mar/2025:13:58:26 +0000] \"GET /api/reports/financial/pdf HTTP/1.1\" 401 1568 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-16 15:58:26"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:59:16"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:59:16"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:59:26"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:59:26"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:59:41"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:59:41"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 15:59:56"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 15:59:56"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 16:00:36"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 16:00:36"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 16:00:52"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 16:00:52"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-16 16:05:34"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-16 16:05:34"}
{"level":"info","message":"GET /api/reports/financial/pdf","service":"payment-service","timestamp":"2025-03-16 16:05:43"}
{"level":"info","message":"::ffff:127.0.0.1 - - [16/Mar/2025:14:05:44 +0000] \"GET /api/reports/financial/pdf HTTP/1.1\" 200 1876 \"-\" \"PostmanRuntime/7.43.0\"","service":"payment-service","timestamp":"2025-03-16 16:05:44"}
{"level":"error","message":"Failed to load configurations from database: Cannot read properties of undefined (reading 'findMany')","service":"payment-service","timestamp":"2025-03-18 11:40:31"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-18 11:40:31"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-18 11:40:31"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-18 11:40:31"}
{"level":"info","message":"Database connection closed","service":"payment-service","timestamp":"2025-03-18 11:40:39"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-18 11:41:04"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-18 11:41:05"}
{"level":"info","message":"Loaded 0 configurations from database","service":"payment-service","timestamp":"2025-03-18 11:41:05"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-18 11:41:05"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-18 11:45:18"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-18 11:45:18"}
{"level":"info","message":"Loaded 0 configurations from database","service":"payment-service","timestamp":"2025-03-18 11:45:18"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-18 11:45:18"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-18 11:46:28"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-18 11:46:28"}
{"level":"info","message":"Loaded 0 configurations from database","service":"payment-service","timestamp":"2025-03-18 11:46:29"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-18 11:46:29"}
{"level":"info","message":"OPTIONS /api/payments","service":"payment-service","timestamp":"2025-03-18 11:46:44"}
{"level":"info","message":"OPTIONS /api/payments","service":"payment-service","timestamp":"2025-03-18 11:48:01"}
{"level":"info","message":"OPTIONS /api/payments","service":"payment-service","timestamp":"2025-03-18 11:49:45"}
{"level":"info","message":"OPTIONS /api/payments","service":"payment-service","timestamp":"2025-03-18 11:51:32"}
{"level":"info","message":"GET /api/payments","service":"payment-service","timestamp":"2025-03-18 11:52:16"}
{"level":"info","message":"::ffff:127.0.0.1 - - [18/Mar/2025:09:52:16 +0000] \"GET /api/payments HTTP/1.1\" 404 151 \"-\" \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:136.0) Gecko/20100101 Firefox/136.0\"","service":"payment-service","timestamp":"2025-03-18 11:52:16"}
{"level":"info","message":"OPTIONS /api/payments","service":"payment-service","timestamp":"2025-03-18 11:54:40"}
{"level":"info","message":"OPTIONS /api/payments","service":"payment-service","timestamp":"2025-03-18 11:55:00"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-18 11:56:01"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-18 11:56:02"}
{"level":"info","message":"Loaded 0 configurations from database","service":"payment-service","timestamp":"2025-03-18 11:56:02"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-18 11:56:02"}
{"level":"info","message":"OPTIONS /api/payments","service":"payment-service","timestamp":"2025-03-18 11:56:44"}
{"level":"info","message":"POST /api/payments","service":"payment-service","timestamp":"2025-03-18 11:56:44"}
{"level":"info","message":"Payment split: Amount: $99.99, Platform: $19, Educator: $78","service":"payment-service","timestamp":"2025-03-18 11:56:44"}
{"data":{"action":"ENROLL_USER","courseId":"course_1","transactionId":"53d03692-22c3-44b8-85b3-c4424cb0edf2","userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"mock-user-id\",\"action\":\"ENROLL_USER\",\"courseId\":\"course_1\",\"transactionId\":\"53d03692-22c3-44b8-85b3-c4424cb0edf2\"}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"125","Content-Type":"application/json","User-Agent":"axios/1.8.1","X-Service-Auth":"your_internal_api_key"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:121:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:10:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-18 11:56:47"}
{"data":{"action":"RECORD_PURCHASE","amount":99.99,"courseId":"course_1","educatorEarnings":78,"userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"courseId\":\"course_1\",\"action\":\"RECORD_PURCHASE\",\"userId\":\"mock-user-id\",\"amount\":99.99,\"educatorEarnings\":78}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"111","Content-Type":"application/json","User-Agent":"axios/1.8.1","X-Service-Auth":"your_internal_api_key"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3002/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3002","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3002\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyCourseService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:41:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:129:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:10:20)"},"level":"error","message":"Failed to notify course service: connect ECONNREFUSED ::1:3002","service":"payment-service","timestamp":"2025-03-18 11:56:47"}
{"data":{"action":"NEW_EARNINGS","data":{"amount":78,"courseId":"course_1","totalPendingEarnings":{},"transactionId":"53d03692-22c3-44b8-85b3-c4424cb0edf2"},"userId":"edu_123"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"edu_123\",\"action\":\"NEW_EARNINGS\",\"data\":{\"courseId\":\"course_1\",\"transactionId\":\"53d03692-22c3-44b8-85b3-c4424cb0edf2\",\"amount\":78,\"totalPendingEarnings\":{}}}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"168","Content-Type":"application/json","User-Agent":"axios/1.8.1","X-Service-Auth":"your_internal_api_key"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:138:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:10:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-18 11:56:47"}
{"action":"PAYMENT_PROCESSED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_PROCESSED by mock-user-id - Payment of 99.99 USD processed for course course_1","metadata":{"stripeChargeId":"pi_3R3wt4BLtTuFPq2g1BpceuFB"},"service":"payment-service","timestamp":"2025-03-18 11:56:47","transactionId":"53d03692-22c3-44b8-85b3-c4424cb0edf2"}
{"level":"info","message":"::ffff:127.0.0.1 - - [18/Mar/2025:09:56:47 +0000] \"POST /api/payments HTTP/1.1\" 200 1173 \"http://127.0.0.1:5500/\" \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:136.0) Gecko/20100101 Firefox/136.0\"","service":"payment-service","timestamp":"2025-03-18 11:56:47"}
{"level":"info","message":"Database connection closed","service":"payment-service","timestamp":"2025-03-18 14:46:41"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-20 14:00:58"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-20 14:00:58"}
{"level":"info","message":"Loaded 0 configurations from database","service":"payment-service","timestamp":"2025-03-20 14:00:58"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-20 14:00:58"}
{"level":"info","message":"GET /api/config/payment","service":"payment-service","timestamp":"2025-03-20 14:11:44"}
{"level":"info","message":"::ffff:127.0.0.1 - - [20/Mar/2025:12:11:44 +0000] \"GET /api/config/payment HTTP/1.1\" 403 1536 \"-\" \"PostmanRuntime/7.43.2\"","service":"payment-service","timestamp":"2025-03-20 14:11:44"}
{"level":"info","message":"GET /api/config/payment","service":"payment-service","timestamp":"2025-03-20 14:17:13"}
{"level":"info","message":"::ffff:127.0.0.1 - - [20/Mar/2025:12:17:13 +0000] \"GET /api/config/payment HTTP/1.1\" 403 1536 \"-\" \"PostmanRuntime/7.43.2\"","service":"payment-service","timestamp":"2025-03-20 14:17:13"}
{"level":"info","message":"GET /api/config/payment","service":"payment-service","timestamp":"2025-03-20 14:18:19"}
{"level":"info","message":"::ffff:127.0.0.1 - - [20/Mar/2025:12:18:19 +0000] \"GET /api/config/payment HTTP/1.1\" 403 1536 \"-\" \"PostmanRuntime/7.43.2\"","service":"payment-service","timestamp":"2025-03-20 14:18:19"}
{"level":"info","message":"GET /api/config","service":"payment-service","timestamp":"2025-03-20 14:22:02"}
{"level":"info","message":"::1 - - [20/Mar/2025:12:22:02 +0000] \"GET /api/config HTTP/1.1\" 403 1554 \"-\" \"axios/1.8.3\"","service":"payment-service","timestamp":"2025-03-20 14:22:02"}
{"level":"info","message":"GET /api/config","service":"payment-service","timestamp":"2025-03-20 14:24:25"}
{"level":"info","message":"::1 - - [20/Mar/2025:12:24:25 +0000] \"GET /api/config HTTP/1.1\" 403 1554 \"-\" \"axios/1.8.3\"","service":"payment-service","timestamp":"2025-03-20 14:24:25"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-20 14:25:58"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-20 14:25:58"}
{"level":"info","message":"Loaded 0 configurations from database","service":"payment-service","timestamp":"2025-03-20 14:25:58"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-20 14:25:58"}
{"level":"info","message":"GET /api/config","service":"payment-service","timestamp":"2025-03-20 14:26:17"}
{"level":"info","message":"::1 - - [20/Mar/2025:12:26:17 +0000] \"GET /api/config HTTP/1.1\" 403 1554 \"-\" \"axios/1.8.3\"","service":"payment-service","timestamp":"2025-03-20 14:26:17"}
{"level":"info","message":"GET /api/config","service":"payment-service","timestamp":"2025-03-20 14:28:47"}
{"level":"info","message":"::1 - - [20/Mar/2025:12:28:47 +0000] \"GET /api/config HTTP/1.1\" 403 1554 \"-\" \"axios/1.8.3\"","service":"payment-service","timestamp":"2025-03-20 14:28:47"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-20 14:32:04"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-20 14:32:04"}
{"level":"info","message":"Loaded 0 configurations from database","service":"payment-service","timestamp":"2025-03-20 14:32:04"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-20 14:32:04"}
{"level":"info","message":"Database connection closed","service":"payment-service","timestamp":"2025-03-20 14:32:41"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-20 14:34:15"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-20 14:34:15"}
{"level":"info","message":"Loaded 0 configurations from database","service":"payment-service","timestamp":"2025-03-20 14:34:15"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-20 14:34:15"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-20 14:35:48"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-20 14:35:48"}
{"level":"info","message":"Loaded 0 configurations from database","service":"payment-service","timestamp":"2025-03-20 14:35:48"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-20 14:35:48"}
{"level":"info","message":"GET /api/config","service":"payment-service","timestamp":"2025-03-20 14:36:02"}
{"level":"info","message":"::1 - - [20/Mar/2025:12:36:02 +0000] \"GET /api/config HTTP/1.1\" 200 5712 \"-\" \"axios/1.8.3\"","service":"payment-service","timestamp":"2025-03-20 14:36:02"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-20 14:39:46"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-20 14:39:47"}
{"level":"info","message":"Loaded 0 configurations from database","service":"payment-service","timestamp":"2025-03-20 14:39:47"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-20 14:39:47"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-20 14:40:35"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-20 14:40:35"}
{"level":"info","message":"Loaded 0 configurations from database","service":"payment-service","timestamp":"2025-03-20 14:40:36"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-20 14:40:36"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-20 14:40:36"}
{"level":"info","message":"GET /api/config","service":"payment-service","timestamp":"2025-03-20 14:41:11"}
{"level":"info","message":"::1 - - [20/Mar/2025:12:41:11 +0000] \"GET /api/config HTTP/1.1\" 200 722 \"-\" \"axios/1.8.3\"","service":"payment-service","timestamp":"2025-03-20 14:41:11"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-20 14:52:51"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-20 14:52:51"}
{"level":"info","message":"Loaded 0 configurations from database","service":"payment-service","timestamp":"2025-03-20 14:52:51"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-20 14:52:51"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-20 14:52:51"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-20 14:53:01"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-20 14:53:01"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-20 14:53:01"}
{"level":"info","message":"Loaded 0 configurations from database","service":"payment-service","timestamp":"2025-03-20 14:53:01"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-20 14:53:01"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-20 14:53:15"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-20 14:53:15"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-20 14:53:19"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-20 14:53:19"}
{"level":"info","message":"Loaded 0 configurations from database","service":"payment-service","timestamp":"2025-03-20 14:53:19"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-20 14:53:19"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-20 14:53:19"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-20 14:54:36"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-20 14:54:36"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-20 14:54:36"}
{"level":"info","message":"Loaded 0 configurations from database","service":"payment-service","timestamp":"2025-03-20 14:54:36"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-20 14:54:36"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-20 14:54:45"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-20 14:54:45"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-20 14:54:46"}
{"level":"info","message":"Loaded 0 configurations from database","service":"payment-service","timestamp":"2025-03-20 14:54:46"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-20 14:54:46"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-20 14:54:56"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-20 14:54:56"}
{"level":"info","message":"Loaded 0 configurations from database","service":"payment-service","timestamp":"2025-03-20 14:54:56"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-20 14:54:56"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-20 14:54:56"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-20 14:55:00"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-20 14:55:01"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-20 14:55:01"}
{"level":"info","message":"Loaded 0 configurations from database","service":"payment-service","timestamp":"2025-03-20 14:55:01"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-20 14:55:01"}
{"level":"info","message":"PUT /api/config/INTERNAL_API_KEY","service":"payment-service","timestamp":"2025-03-20 15:03:15"}
{"level":"info","message":"Configuration updated: INTERNAL_API_KEY","service":"payment-service","timestamp":"2025-03-20 15:03:16"}
{"level":"info","message":"Updated .env file with new value for INTERNAL_API_KEY","service":"payment-service","timestamp":"2025-03-20 15:03:16"}
{"level":"info","message":"::1 - - [20/Mar/2025:13:03:16 +0000] \"PUT /api/config/INTERNAL_API_KEY HTTP/1.1\" 200 132 \"-\" \"axios/1.8.3\"","service":"payment-service","timestamp":"2025-03-20 15:03:16"}
{"level":"info","message":"GET /api/payouts/educators/edu_123/pending","service":"payment-service","timestamp":"2025-03-20 15:11:32"}
{"level":"info","message":"::1 - - [20/Mar/2025:13:11:32 +0000] \"GET /api/payouts/educators/edu_123/pending HTTP/1.1\" 404 176 \"-\" \"PostmanRuntime/7.43.2\"","service":"payment-service","timestamp":"2025-03-20 15:11:32"}
{"level":"info","message":"GET /api/payouts/educators/edu_123/pending","service":"payment-service","timestamp":"2025-03-20 15:12:10"}
{"level":"info","message":"::ffff:127.0.0.1 - - [20/Mar/2025:13:12:10 +0000] \"GET /api/payouts/educators/edu_123/pending HTTP/1.1\" 404 176 \"-\" \"PostmanRuntime/7.43.2\"","service":"payment-service","timestamp":"2025-03-20 15:12:10"}
{"level":"info","message":"GET /api/payments/total-earnings","service":"payment-service","timestamp":"2025-03-20 15:13:11"}
{"level":"info","message":"::ffff:127.0.0.1 - - [20/Mar/2025:13:13:11 +0000] \"GET /api/payments/total-earnings HTTP/1.1\" 200 26 \"-\" \"PostmanRuntime/7.43.2\"","service":"payment-service","timestamp":"2025-03-20 15:13:11"}
{"level":"info","message":"GET /api/payments/current-balance","service":"payment-service","timestamp":"2025-03-20 15:13:40"}
{"level":"info","message":"::ffff:127.0.0.1 - - [20/Mar/2025:13:13:41 +0000] \"GET /api/payments/current-balance HTTP/1.1\" 200 54 \"-\" \"PostmanRuntime/7.43.2\"","service":"payment-service","timestamp":"2025-03-20 15:13:41"}
{"level":"info","message":"GET /api/payments/current-balance","service":"payment-service","timestamp":"2025-03-20 15:14:11"}
{"level":"info","message":"::ffff:127.0.0.1 - - [20/Mar/2025:13:14:12 +0000] \"GET /api/payments/current-balance HTTP/1.1\" 200 54 \"-\" \"PostmanRuntime/7.43.2\"","service":"payment-service","timestamp":"2025-03-20 15:14:12"}
{"level":"info","message":"GET /api/payments/current-balance","service":"payment-service","timestamp":"2025-03-20 15:14:19"}
{"level":"info","message":"::ffff:127.0.0.1 - - [20/Mar/2025:13:14:19 +0000] \"GET /api/payments/current-balance HTTP/1.1\" 200 54 \"-\" \"PostmanRuntime/7.43.2\"","service":"payment-service","timestamp":"2025-03-20 15:14:19"}
{"level":"info","message":"GET /api/payments/current-balance","service":"payment-service","timestamp":"2025-03-20 15:14:21"}
{"level":"info","message":"::ffff:127.0.0.1 - - [20/Mar/2025:13:14:21 +0000] \"GET /api/payments/current-balance HTTP/1.1\" 200 54 \"-\" \"PostmanRuntime/7.43.2\"","service":"payment-service","timestamp":"2025-03-20 15:14:21"}
{"level":"info","message":"GET /api/payments/current-balance","service":"payment-service","timestamp":"2025-03-20 15:14:23"}
{"level":"info","message":"::ffff:127.0.0.1 - - [20/Mar/2025:13:14:23 +0000] \"GET /api/payments/current-balance HTTP/1.1\" 200 54 \"-\" \"PostmanRuntime/7.43.2\"","service":"payment-service","timestamp":"2025-03-20 15:14:23"}
{"level":"info","message":"GET /api/payments/14b4ec76-7c78-4833-a608-6ade135734df","service":"payment-service","timestamp":"2025-03-20 15:15:05"}
{"level":"error","message":"Error fetching transaction: Transaction not found","service":"payment-service","timestamp":"2025-03-20 15:15:05"}
{"level":"info","message":"::ffff:127.0.0.1 - - [20/Mar/2025:13:15:05 +0000] \"GET /api/payments/14b4ec76-7c78-4833-a608-6ade135734df HTTP/1.1\" 404 51 \"-\" \"PostmanRuntime/7.43.2\"","service":"payment-service","timestamp":"2025-03-20 15:15:05"}
{"level":"info","message":"GET /api/payments/","service":"payment-service","timestamp":"2025-03-20 15:15:14"}
{"level":"info","message":"::ffff:127.0.0.1 - - [20/Mar/2025:13:15:14 +0000] \"GET /api/payments/ HTTP/1.1\" 404 152 \"-\" \"PostmanRuntime/7.43.2\"","service":"payment-service","timestamp":"2025-03-20 15:15:14"}
{"level":"info","message":"GET /api/payments/4bd46fd7-d432-4125-825f-43b3f65b7c95","service":"payment-service","timestamp":"2025-03-20 15:15:57"}
{"level":"error","message":"Error fetching transaction: Transaction not found","service":"payment-service","timestamp":"2025-03-20 15:15:57"}
{"level":"info","message":"::ffff:127.0.0.1 - - [20/Mar/2025:13:15:57 +0000] \"GET /api/payments/4bd46fd7-d432-4125-825f-43b3f65b7c95 HTTP/1.1\" 404 51 \"-\" \"PostmanRuntime/7.43.2\"","service":"payment-service","timestamp":"2025-03-20 15:15:57"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-20 15:16:21"}
{"level":"info","message":"Payment split: Amount: $100, Platform: $19, Educator: $78","service":"payment-service","timestamp":"2025-03-20 15:16:21"}
{"data":{"action":"ENROLL_USER","courseId":"6","transactionId":"0e678950-cdea-4f1d-9c58-682429da7d91","userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"mock-user-id\",\"action\":\"ENROLL_USER\",\"courseId\":\"6\",\"transactionId\":\"0e678950-cdea-4f1d-9c58-682429da7d91\"}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"118","Content-Type":"application/json","User-Agent":"axios/1.8.1","X-Service-Auth":"TESTO"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:121:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:10:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-20 15:16:24"}
{"data":{"action":"RECORD_PURCHASE","amount":100,"courseId":"6","educatorEarnings":78,"userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"courseId\":\"6\",\"action\":\"RECORD_PURCHASE\",\"userId\":\"mock-user-id\",\"amount\":100,\"educatorEarnings\":78}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"102","Content-Type":"application/json","User-Agent":"axios/1.8.1","X-Service-Auth":"TESTO"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3002/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3002","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3002\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyCourseService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:41:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:129:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:10:20)"},"level":"error","message":"Failed to notify course service: connect ECONNREFUSED ::1:3002","service":"payment-service","timestamp":"2025-03-20 15:16:24"}
{"data":{"action":"NEW_EARNINGS","data":{"amount":78,"courseId":"6","totalPendingEarnings":{},"transactionId":"0e678950-cdea-4f1d-9c58-682429da7d91"},"userId":"edu_123"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"edu_123\",\"action\":\"NEW_EARNINGS\",\"data\":{\"courseId\":\"6\",\"transactionId\":\"0e678950-cdea-4f1d-9c58-682429da7d91\",\"amount\":78,\"totalPendingEarnings\":{}}}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"161","Content-Type":"application/json","User-Agent":"axios/1.8.1","X-Service-Auth":"TESTO"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:138:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:10:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-20 15:16:24"}
{"action":"PAYMENT_PROCESSED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_PROCESSED by mock-user-id - Payment of 100 USD processed for course 6","metadata":{"stripeChargeId":"pi_3R4ixNBLtTuFPq2g0wADIH6x"},"service":"payment-service","timestamp":"2025-03-20 15:16:24","transactionId":"0e678950-cdea-4f1d-9c58-682429da7d91"}
{"level":"info","message":"::ffff:127.0.0.1 - - [20/Mar/2025:13:16:24 +0000] \"POST /api/payments/ HTTP/1.1\" 200 1124 \"-\" \"PostmanRuntime/7.43.2\"","service":"payment-service","timestamp":"2025-03-20 15:16:24"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-20 15:19:13"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-20 15:19:13"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-20 15:19:13"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-20 15:19:13"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-20 15:19:13"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-20 15:19:20"}
{"error":{"isOperational":true,"status":"fail","statusCode":400},"level":"error","message":"Payment processing error: User already enrolled in this course","service":"payment-service","timestamp":"2025-03-20 15:19:20"}
{"action":"PAYMENT_FAILED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_FAILED by mock-user-id - Payment of 100 USD failed for course 6","metadata":{"error":"User already enrolled in this course"},"service":"payment-service","timestamp":"2025-03-20 15:19:20","transactionId":null}
{"level":"error","message":"Error processing payment: Payment processing failed: User already enrolled in this course","service":"payment-service","timestamp":"2025-03-20 15:19:20"}
{"level":"info","message":"::ffff:127.0.0.1 - - [20/Mar/2025:13:19:20 +0000] \"POST /api/payments/ HTTP/1.1\" 400 93 \"-\" \"PostmanRuntime/7.43.2\"","service":"payment-service","timestamp":"2025-03-20 15:19:20"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-20 15:19:32"}
{"level":"info","message":"Payment split: Amount: $100, Platform: $19, Educator: $78","service":"payment-service","timestamp":"2025-03-20 15:19:32"}
{"action":"PAYMENT_PROCESSED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_PROCESSED by mock-user-id - Payment of 100 USD processed for course 7","metadata":{"stripeChargeId":"pi_3R4j0SBLtTuFPq2g1Qv8o5Ni"},"service":"payment-service","timestamp":"2025-03-20 15:19:34","transactionId":"b0afb5ec-5b6f-4018-a0b5-e914e93f9288"}
{"level":"info","message":"::ffff:127.0.0.1 - - [20/Mar/2025:13:19:34 +0000] \"POST /api/payments/ HTTP/1.1\" 200 1124 \"-\" \"PostmanRuntime/7.43.2\"","service":"payment-service","timestamp":"2025-03-20 15:19:34"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-20 15:21:53"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-20 15:21:53"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-20 15:21:53"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-20 15:21:53"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-20 15:21:53"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-20 15:22:08"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-20 15:22:08"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-20 15:22:09"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-20 15:22:09"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-20 15:22:09"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-20 15:27:43"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-20 15:27:43"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-20 15:27:43"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-20 15:27:43"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-20 15:27:43"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-20 15:28:12"}
{"error":{"clientVersion":"6.4.1","name":"PrismaClientValidationError"},"level":"error","message":"Payment processing error: \nInvalid `tx.invoice.create()` invocation in\nC:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:267:46\n\n  264 });\n  265 \n  266 // Create invoice\n→ 267 const invoiceRecord = await tx.invoice.create({\n        data: {\n          transactionId: \"8b99898b-6b53-46cf-a1b9-97cd86dd8d59\",\n          invoiceNumber: \"INV-77295403\",\n          subtotal: 100,\n          total: 100,\n          status: \"PAID\",\n          paidAt: new Date(\"2025-03-20T13:28:15.403Z\"),\n          issuedAt: new Date(\"2025-03-20T13:28:15.403Z\"),\n          ~~~~~~~~\n          billingInfo: \"{\\\"name\\\":\\\"Mock User\\\",\\\"email\\\":\\\"mock@example.com\\\"}\",\n          notes: \"Payment for course: Payment for course\",\n      ?   id?: String,\n      ?   discount?: Float,\n      ?   tax?: Float,\n      ?   issueDate?: DateTime,\n      ?   dueDate?: DateTime | Null,\n      ?   createdAt?: DateTime,\n      ?   updatedAt?: DateTime\n        }\n      })\n\nUnknown argument `issuedAt`. Did you mean `issueDate`? Available options are marked with ?.","service":"payment-service","timestamp":"2025-03-20 15:28:15"}
{"level":"error","message":"Error processing payment: Payment processing failed: \nInvalid `tx.invoice.create()` invocation in\nC:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:267:46\n\n  264 });\n  265 \n  266 // Create invoice\n→ 267 const invoiceRecord = await tx.invoice.create({\n        data: {\n          transactionId: \"8b99898b-6b53-46cf-a1b9-97cd86dd8d59\",\n          invoiceNumber: \"INV-77295403\",\n          subtotal: 100,\n          total: 100,\n          status: \"PAID\",\n          paidAt: new Date(\"2025-03-20T13:28:15.403Z\"),\n          issuedAt: new Date(\"2025-03-20T13:28:15.403Z\"),\n          ~~~~~~~~\n          billingInfo: \"{\\\"name\\\":\\\"Mock User\\\",\\\"email\\\":\\\"mock@example.com\\\"}\",\n          notes: \"Payment for course: Payment for course\",\n      ?   id?: String,\n      ?   discount?: Float,\n      ?   tax?: Float,\n      ?   issueDate?: DateTime,\n      ?   dueDate?: DateTime | Null,\n      ?   createdAt?: DateTime,\n      ?   updatedAt?: DateTime\n        }\n      })\n\nUnknown argument `issuedAt`. Did you mean `issueDate`? Available options are marked with ?.","service":"payment-service","timestamp":"2025-03-20 15:28:15"}
{"level":"info","message":"::ffff:127.0.0.1 - - [20/Mar/2025:13:28:15 +0000] \"POST /api/payments/ HTTP/1.1\" 400 1155 \"-\" \"PostmanRuntime/7.43.2\"","service":"payment-service","timestamp":"2025-03-20 15:28:15"}
{"action":"PAYMENT_FAILED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_FAILED by mock-user-id - Payment of 100 USD failed for course 8","metadata":{"error":"\nInvalid `tx.invoice.create()` invocation in\nC:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:267:46\n\n  264 });\n  265 \n  266 // Create invoice\n→ 267 const invoiceRecord = await tx.invoice.create({\n        data: {\n          transactionId: \"8b99898b-6b53-46cf-a1b9-97cd86dd8d59\",\n          invoiceNumber: \"INV-77295403\",\n          subtotal: 100,\n          total: 100,\n          status: \"PAID\",\n          paidAt: new Date(\"2025-03-20T13:28:15.403Z\"),\n          issuedAt: new Date(\"2025-03-20T13:28:15.403Z\"),\n          ~~~~~~~~\n          billingInfo: \"{\\\"name\\\":\\\"Mock User\\\",\\\"email\\\":\\\"mock@example.com\\\"}\",\n          notes: \"Payment for course: Payment for course\",\n      ?   id?: String,\n      ?   discount?: Float,\n      ?   tax?: Float,\n      ?   issueDate?: DateTime,\n      ?   dueDate?: DateTime | Null,\n      ?   createdAt?: DateTime,\n      ?   updatedAt?: DateTime\n        }\n      })\n\nUnknown argument `issuedAt`. Did you mean `issueDate`? Available options are marked with ?."},"service":"payment-service","timestamp":"2025-03-20 15:28:15","transactionId":null}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-20 15:28:48"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-20 15:28:48"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-20 15:28:49"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-20 15:28:49"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-20 15:28:49"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-20 15:29:57"}
{"level":"info","message":"::ffff:127.0.0.1 - - [20/Mar/2025:13:30:00 +0000] \"POST /api/payments/ HTTP/1.1\" 200 1118 \"-\" \"PostmanRuntime/7.43.2\"","service":"payment-service","timestamp":"2025-03-20 15:30:00"}
{"action":"PAYMENT_PROCESSED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_PROCESSED by mock-user-id - Payment of 100 USD processed for course 8","metadata":{"stripeChargeId":"pi_3R4jAYBLtTuFPq2g1GWDudC6"},"service":"payment-service","timestamp":"2025-03-20 15:30:00","transactionId":"54681e50-bd69-4822-b84d-7f7b649be036"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-20 15:30:53"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-20 15:30:53"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-20 15:30:53"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-20 15:30:53"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-20 15:30:53"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-20 15:32:15"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-20 15:32:15"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-20 15:32:15"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-20 15:32:15"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-20 15:32:15"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-20 15:32:40"}
{"level":"info","message":"::ffff:127.0.0.1 - - [20/Mar/2025:13:32:43 +0000] \"POST /api/payments/ HTTP/1.1\" 200 105 \"-\" \"PostmanRuntime/7.43.2\"","service":"payment-service","timestamp":"2025-03-20 15:32:43"}
{"action":"PAYMENT_PROCESSED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_PROCESSED by mock-user-id - Payment of 100 USD processed for course 9","metadata":{"stripeChargeId":"pi_3R4jDBBLtTuFPq2g4Kk285US"},"service":"payment-service","timestamp":"2025-03-20 15:32:43","transactionId":"bc9b3517-f8ca-4e76-808a-9c49b77c304d"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-20 15:35:20"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-20 15:35:20"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-20 15:35:20"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-20 15:35:20"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-20 15:35:20"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-20 15:35:31"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-20 15:35:31"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-20 15:35:32"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-20 15:35:32"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-20 15:35:32"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-20 15:36:48"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-20 15:36:48"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-20 15:36:48"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-20 15:36:48"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-20 15:36:48"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-20 15:36:55"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-20 15:36:55"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-20 15:36:55"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-20 15:36:55"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-20 15:36:55"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-20 15:37:12"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-20 15:37:12"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-20 15:37:12"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-20 15:37:12"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-20 15:37:12"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-20 15:37:31"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-20 15:37:31"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-20 15:37:31"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-20 15:37:32"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-20 15:37:32"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-20 15:37:56"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-20 15:37:56"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-20 15:37:56"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-20 15:37:56"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-20 15:37:56"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-20 15:38:08"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-20 15:38:08"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-20 15:38:08"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-20 15:38:08"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-20 15:38:08"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-20 15:38:58"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-20 15:38:58"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-20 15:38:58"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-20 15:38:58"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-20 15:38:58"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-20 15:39:15"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-20 15:39:15"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-20 15:39:16"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-20 15:39:16"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-20 15:39:16"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-20 15:42:53"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-20 15:42:53"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-20 15:42:53"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-20 15:42:53"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-20 15:42:53"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-20 15:43:39"}
{"error":{},"level":"error","message":"Payment processing error: duplicateCheck is not defined","service":"payment-service","timestamp":"2025-03-20 15:43:39"}
{"level":"error","message":"Error processing payment: Payment processing failed: duplicateCheck is not defined","service":"payment-service","timestamp":"2025-03-20 15:43:39"}
{"level":"info","message":"::ffff:127.0.0.1 - - [20/Mar/2025:13:43:39 +0000] \"POST /api/payments/ HTTP/1.1\" 400 86 \"-\" \"PostmanRuntime/7.43.2\"","service":"payment-service","timestamp":"2025-03-20 15:43:39"}
{"action":"PAYMENT_FAILED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_FAILED by mock-user-id - Payment of 100 USD failed for course 10","metadata":{"error":"duplicateCheck is not defined"},"service":"payment-service","timestamp":"2025-03-20 15:43:40","transactionId":null}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-20 15:44:17"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-20 15:44:17"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-20 15:44:17"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-20 15:44:17"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-20 15:44:17"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-20 15:44:18"}
{"error":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"311","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=rrqccb9hxgABTdKuDVDZKeqMQYRgs8p0p-ycAiRa0UDT3RpkHeGPrgn6KYdgagEtiAMGvx7eL3VhEk8A","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Thu, 20 Mar 2025 13:44:19 GMT","idempotency-key":"payment_10_mock-user-id_1742478258759","original-request":"req_gLqrrKSWwtFU1x","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_gLqrrKSWwtFU1x","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-account":"acct_1R2XOmBSQj761K0C","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"param":"transfer_data[destination]","raw":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"311","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=rrqccb9hxgABTdKuDVDZKeqMQYRgs8p0p-ycAiRa0UDT3RpkHeGPrgn6KYdgagEtiAMGvx7eL3VhEk8A","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Thu, 20 Mar 2025 13:44:19 GMT","idempotency-key":"payment_10_mock-user-id_1742478258759","original-request":"req_gLqrrKSWwtFU1x","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_gLqrrKSWwtFU1x","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-account":"acct_1R2XOmBSQj761K0C","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"The 'transfer_data[destination]' param cannot be set to your own account.","param":"transfer_data[destination]","requestId":"req_gLqrrKSWwtFU1x","request_log_url":"https://dashboard.stripe.com/acct_1R2XOmBSQj761K0C/test/logs/req_gLqrrKSWwtFU1x?t=1742478259","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_gLqrrKSWwtFU1x","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Payment processing error: The 'transfer_data[destination]' param cannot be set to your own account.","service":"payment-service","timestamp":"2025-03-20 15:44:19"}
{"level":"error","message":"Error processing payment: Payment processing failed: The 'transfer_data[destination]' param cannot be set to your own account.","service":"payment-service","timestamp":"2025-03-20 15:44:19"}
{"level":"info","message":"::ffff:127.0.0.1 - - [20/Mar/2025:13:44:19 +0000] \"POST /api/payments/ HTTP/1.1\" 400 130 \"-\" \"PostmanRuntime/7.43.2\"","service":"payment-service","timestamp":"2025-03-20 15:44:19"}
{"action":"PAYMENT_FAILED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_FAILED by mock-user-id - Payment of 100 USD failed for course 10","metadata":{"error":"The 'transfer_data[destination]' param cannot be set to your own account."},"service":"payment-service","timestamp":"2025-03-20 15:44:19","transactionId":null}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-20 15:45:24"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-20 15:45:24"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-20 15:45:25"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-20 15:45:25"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-20 15:45:25"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-20 15:46:39"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-20 15:46:39"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-20 15:46:40"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-20 15:46:40"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-20 15:46:40"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-20 15:47:59"}
{"level":"info","message":"::ffff:127.0.0.1 - - [20/Mar/2025:13:48:01 +0000] \"POST /api/payments/ HTTP/1.1\" 200 105 \"-\" \"PostmanRuntime/7.43.2\"","service":"payment-service","timestamp":"2025-03-20 15:48:01"}
{"action":"PAYMENT_PROCESSED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_PROCESSED by mock-user-id - Payment of 100 USD processed for course 10","metadata":{"stripeChargeId":"pi_3R4jS0BLtTuFPq2g32MVT3SK"},"service":"payment-service","timestamp":"2025-03-20 15:48:01","transactionId":"d1646352-3e5c-45e9-9da5-75cabe5e5f6b"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-20 15:53:59"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-20 15:53:59"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-20 15:53:59"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-20 15:53:59"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-20 15:53:59"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-20 15:54:22"}
{"level":"info","message":"::ffff:127.0.0.1 - - [20/Mar/2025:13:54:24 +0000] \"POST /api/payments/ HTTP/1.1\" 200 151 \"-\" \"PostmanRuntime/7.43.2\"","service":"payment-service","timestamp":"2025-03-20 15:54:24"}
{"action":"PAYMENT_PROCESSED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_PROCESSED by mock-user-id - Payment of 100 USD processed for course 10","metadata":{"stripeChargeId":"pi_3R4jYBBLtTuFPq2g2KOlKnbo"},"service":"payment-service","timestamp":"2025-03-20 15:54:24","transactionId":"82d086cc-baa6-416e-b3ca-91840cf03c6b"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-20 15:55:14"}
{"level":"info","message":"::ffff:127.0.0.1 - - [20/Mar/2025:13:55:16 +0000] \"POST /api/payments/ HTTP/1.1\" 200 151 \"-\" \"PostmanRuntime/7.43.2\"","service":"payment-service","timestamp":"2025-03-20 15:55:16"}
{"action":"PAYMENT_PROCESSED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_PROCESSED by mock-user-id - Payment of 100 USD processed for course 10","metadata":{"stripeChargeId":"pi_3R4jZ0BLtTuFPq2g0NRXuFRU"},"service":"payment-service","timestamp":"2025-03-20 15:55:16","transactionId":"b9ed7e29-2230-419a-8df1-f01c949bdeb1"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-20 15:55:24"}
{"level":"info","message":"::ffff:127.0.0.1 - - [20/Mar/2025:13:55:26 +0000] \"POST /api/payments/ HTTP/1.1\" 200 151 \"-\" \"PostmanRuntime/7.43.2\"","service":"payment-service","timestamp":"2025-03-20 15:55:26"}
{"action":"PAYMENT_PROCESSED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_PROCESSED by mock-user-id - Payment of 100 USD processed for course 10","metadata":{"stripeChargeId":"pi_3R4jZABLtTuFPq2g4SjxoDLX"},"service":"payment-service","timestamp":"2025-03-20 15:55:26","transactionId":"e186d9cc-7dbe-4ded-82ea-993b35718819"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-20 15:55:28"}
{"level":"info","message":"::ffff:127.0.0.1 - - [20/Mar/2025:13:55:29 +0000] \"POST /api/payments/ HTTP/1.1\" 200 150 \"-\" \"PostmanRuntime/7.43.2\"","service":"payment-service","timestamp":"2025-03-20 15:55:29"}
{"action":"PAYMENT_PROCESSED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_PROCESSED by mock-user-id - Payment of 100 USD processed for course 10","metadata":{"stripeChargeId":"pi_3R4jZEBLtTuFPq2g4YYNTODQ"},"service":"payment-service","timestamp":"2025-03-20 15:55:29","transactionId":"1ebfd550-45e3-4d54-bc93-2a6d3f499e80"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-20 15:56:24"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-20 15:56:24"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-20 15:56:25"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-20 15:56:25"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-20 15:56:25"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-20 15:58:04"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-20 15:58:04"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-20 15:58:05"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-20 15:58:05"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-20 15:58:05"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-20 15:58:19"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-20 15:58:19"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-20 15:58:19"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-20 15:58:19"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-20 15:58:19"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-20 15:58:38"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-20 15:58:38"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-20 15:58:38"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-20 15:58:38"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-20 15:58:38"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-20 15:58:42"}
{"error":{},"level":"error","message":"Payment processing error: object is not iterable (cannot read property Symbol(Symbol.iterator))","service":"payment-service","timestamp":"2025-03-20 15:58:42"}
{"level":"error","message":"Error processing payment: Payment processing failed: object is not iterable (cannot read property Symbol(Symbol.iterator))","service":"payment-service","timestamp":"2025-03-20 15:58:42"}
{"level":"info","message":"::ffff:127.0.0.1 - - [20/Mar/2025:13:58:42 +0000] \"POST /api/payments/ HTTP/1.1\" 400 126 \"-\" \"PostmanRuntime/7.43.2\"","service":"payment-service","timestamp":"2025-03-20 15:58:42"}
{"action":"PAYMENT_FAILED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_FAILED by mock-user-id - Payment of 100 USD failed for course 10","metadata":{"error":"object is not iterable (cannot read property Symbol(Symbol.iterator))"},"service":"payment-service","timestamp":"2025-03-20 15:58:42","transactionId":null}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-20 16:00:11"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-20 16:00:11"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-20 16:00:11"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-20 16:00:11"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-20 16:00:11"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-20 16:00:18"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-20 16:00:18"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-20 16:00:18"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-20 16:00:18"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-20 16:00:18"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-20 16:01:02"}
{"error":{},"level":"error","message":"Payment processing error: educatorAccount is not defined","service":"payment-service","timestamp":"2025-03-20 16:01:02"}
{"level":"error","message":"Error processing payment: Payment processing failed: educatorAccount is not defined","service":"payment-service","timestamp":"2025-03-20 16:01:02"}
{"level":"info","message":"::ffff:127.0.0.1 - - [20/Mar/2025:14:01:02 +0000] \"POST /api/payments/ HTTP/1.1\" 400 87 \"-\" \"PostmanRuntime/7.43.2\"","service":"payment-service","timestamp":"2025-03-20 16:01:02"}
{"action":"PAYMENT_FAILED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_FAILED by mock-user-id - Payment of 100 USD failed for course 10","metadata":{"error":"educatorAccount is not defined"},"service":"payment-service","timestamp":"2025-03-20 16:01:02","transactionId":null}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-20 16:01:38"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-20 16:01:38"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-20 16:01:38"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-20 16:01:38"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-20 16:01:38"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-20 16:01:52"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-20 16:01:52"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-20 16:01:55"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-20 16:01:55"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-20 16:01:55"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-20 16:01:55"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-20 16:01:55"}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-20 16:02:36"}
{"error":{"isOperational":true,"status":"fail","statusCode":400},"level":"error","message":"Payment processing error: User already enrolled in this course","service":"payment-service","timestamp":"2025-03-20 16:02:37"}
{"level":"error","message":"Error processing payment: Payment processing failed: User already enrolled in this course","service":"payment-service","timestamp":"2025-03-20 16:02:37"}
{"level":"info","message":"::ffff:127.0.0.1 - - [20/Mar/2025:14:02:37 +0000] \"POST /api/payments/ HTTP/1.1\" 400 93 \"-\" \"PostmanRuntime/7.43.2\"","service":"payment-service","timestamp":"2025-03-20 16:02:37"}
{"action":"PAYMENT_FAILED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_FAILED by mock-user-id - Payment of 100 USD failed for course 10","metadata":{"error":"User already enrolled in this course"},"service":"payment-service","timestamp":"2025-03-20 16:02:37","transactionId":null}
{"level":"info","message":"POST /api/payments/","service":"payment-service","timestamp":"2025-03-20 16:02:46"}
{"error":{"isOperational":true,"status":"fail","statusCode":400},"level":"error","message":"Payment processing error: User already enrolled in this course","service":"payment-service","timestamp":"2025-03-20 16:02:46"}
{"level":"error","message":"Error processing payment: Payment processing failed: User already enrolled in this course","service":"payment-service","timestamp":"2025-03-20 16:02:46"}
{"level":"info","message":"::ffff:127.0.0.1 - - [20/Mar/2025:14:02:46 +0000] \"POST /api/payments/ HTTP/1.1\" 400 93 \"-\" \"PostmanRuntime/7.43.2\"","service":"payment-service","timestamp":"2025-03-20 16:02:46"}
{"action":"PAYMENT_FAILED","actor":"mock-user-id","level":"info","message":"AUDIT: PAYMENT_FAILED by mock-user-id - Payment of 100 USD failed for course 10","metadata":{"error":"User already enrolled in this course"},"service":"payment-service","timestamp":"2025-03-20 16:02:46","transactionId":null}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-20 16:32:37"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-20 16:32:37"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-20 16:32:38"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-20 16:32:38"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-20 16:32:38"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-22 13:59:53"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-22 13:59:53"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-22 13:59:53"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-22 13:59:53"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-22 13:59:53"}
{"level":"info","message":"GET /api/config","service":"payment-service","timestamp":"2025-03-22 14:00:53"}
{"level":"info","message":"::1 - - [22/Mar/2025:12:00:53 +0000] \"GET /api/config HTTP/1.1\" 200 706 \"-\" \"axios/1.8.3\"","service":"payment-service","timestamp":"2025-03-22 14:00:53"}
{"level":"info","message":"PUT /api/config/STRIPE_WEBHOOK_SECRET","service":"payment-service","timestamp":"2025-03-22 14:02:20"}
{"level":"warn","message":"Attempted to modify protected config key: STRIPE_WEBHOOK_SECRET","service":"payment-service","timestamp":"2025-03-22 14:02:21"}
{"level":"error","message":"Failed to update configuration: Cannot modify protected configuration key: STRIPE_WEBHOOK_SECRET","service":"payment-service","timestamp":"2025-03-22 14:02:21"}
{"level":"error","message":"Error updating configuration: Cannot modify protected configuration key: STRIPE_WEBHOOK_SECRET","service":"payment-service","timestamp":"2025-03-22 14:02:21"}
{"level":"info","message":"::1 - - [22/Mar/2025:12:02:21 +0000] \"PUT /api/config/STRIPE_WEBHOOK_SECRET HTTP/1.1\" 500 1582 \"-\" \"axios/1.8.3\"","service":"payment-service","timestamp":"2025-03-22 14:02:21"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-22 14:06:14"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-22 14:06:14"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-22 14:06:14"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-22 14:06:14"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-22 14:06:14"}
{"level":"info","message":"GET /api/statistics/financial-analysis","service":"payment-service","timestamp":"2025-03-22 14:18:40"}
{"error":{},"level":"error","message":"Error fetching financial analysis: prisma.raw is not a function","service":"payment-service","timestamp":"2025-03-22 14:18:40"}
{"level":"info","message":"::ffff:127.0.0.1 - - [22/Mar/2025:12:18:40 +0000] \"GET /api/statistics/financial-analysis HTTP/1.1\" 500 1579 \"-\" \"PostmanRuntime/7.43.2\"","service":"payment-service","timestamp":"2025-03-22 14:18:40"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-22 14:20:20"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-22 14:20:20"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-22 14:20:21"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-22 14:20:21"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-22 14:20:21"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-22 14:20:27"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-22 14:20:27"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-22 14:20:27"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-22 14:20:27"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-22 14:20:27"}
{"level":"info","message":"GET /api/statistics/financial-analysis","service":"payment-service","timestamp":"2025-03-22 14:23:10"}
{"error":{},"level":"error","message":"Error fetching financial analysis: prisma.sql is not a function","service":"payment-service","timestamp":"2025-03-22 14:23:10"}
{"level":"info","message":"::ffff:127.0.0.1 - - [22/Mar/2025:12:23:10 +0000] \"GET /api/statistics/financial-analysis HTTP/1.1\" 500 1579 \"-\" \"PostmanRuntime/7.43.2\"","service":"payment-service","timestamp":"2025-03-22 14:23:10"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-22 14:23:29"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-22 14:23:29"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-22 14:23:29"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-22 14:23:30"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-22 14:23:30"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-22 14:23:48"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-22 14:23:48"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-22 14:23:48"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-22 14:23:48"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-22 14:23:48"}
{"level":"info","message":"GET /api/statistics/financial-analysis","service":"payment-service","timestamp":"2025-03-22 14:24:08"}
{"error":{},"level":"error","message":"Error fetching financial analysis: $queryRaw is not defined","service":"payment-service","timestamp":"2025-03-22 14:24:08"}
{"level":"info","message":"::ffff:127.0.0.1 - - [22/Mar/2025:12:24:08 +0000] \"GET /api/statistics/financial-analysis HTTP/1.1\" 500 1579 \"-\" \"PostmanRuntime/7.43.2\"","service":"payment-service","timestamp":"2025-03-22 14:24:08"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-22 14:25:43"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-22 14:25:43"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-22 14:25:44"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-22 14:25:44"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-22 14:25:44"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-22 14:25:57"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-22 14:25:57"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-22 14:25:57"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-22 14:25:57"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-22 14:25:57"}
{"level":"info","message":"GET /api/statistics/financial-analysis","service":"payment-service","timestamp":"2025-03-22 14:26:25"}
{"error":{},"level":"error","message":"Error fetching financial analysis: $queryRaw is not defined","service":"payment-service","timestamp":"2025-03-22 14:26:25"}
{"level":"info","message":"::ffff:127.0.0.1 - - [22/Mar/2025:12:26:25 +0000] \"GET /api/statistics/financial-analysis HTTP/1.1\" 500 1579 \"-\" \"PostmanRuntime/7.43.2\"","service":"payment-service","timestamp":"2025-03-22 14:26:25"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-22 14:29:25"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-22 14:29:25"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-22 14:29:25"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-22 14:29:25"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-22 14:29:25"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-22 14:30:19"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-22 14:30:19"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-22 14:30:19"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-22 14:30:19"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-22 14:30:19"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-22 14:30:32"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-22 14:30:32"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-22 14:30:32"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-22 14:30:32"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-22 14:30:32"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-22 14:30:42"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-22 14:30:42"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-22 14:30:42"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-22 14:30:42"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-22 14:30:42"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-22 14:31:48"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-22 14:31:48"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-22 14:31:48"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-22 14:31:48"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-22 14:31:48"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-22 14:31:56"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-22 14:31:56"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-22 14:31:56"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-22 14:31:56"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-22 14:31:56"}
{"level":"info","message":"GET /api/statistics/financial-analysis","service":"payment-service","timestamp":"2025-03-22 14:32:00"}
{"error":{"clientVersion":"6.4.1","code":"P2010","meta":{"code":"42804","message":"ERROR: argument of WHERE must be type boolean, not type jsonb"},"name":"PrismaClientKnownRequestError"},"level":"error","message":"Error fetching financial analysis: \nInvalid `prisma.$queryRaw()` invocation:\n\n\nRaw query failed. Code: `42804`. Message: `ERROR: argument of WHERE must be type boolean, not type jsonb`","service":"payment-service","timestamp":"2025-03-22 14:32:00"}
{"level":"info","message":"::ffff:127.0.0.1 - - [22/Mar/2025:12:32:00 +0000] \"GET /api/statistics/financial-analysis HTTP/1.1\" 500 439 \"-\" \"PostmanRuntime/7.43.2\"","service":"payment-service","timestamp":"2025-03-22 14:32:00"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-22 14:33:47"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-22 14:33:47"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-22 14:33:47"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-22 14:33:47"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-22 14:33:47"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-22 14:34:34"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-22 14:34:34"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-22 14:34:35"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-22 14:34:35"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-22 14:34:35"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-22 14:34:39"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-22 14:34:39"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-22 14:34:40"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-22 14:34:40"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-22 14:34:40"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-22 14:35:07"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-22 14:35:07"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-22 14:35:07"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-22 14:35:07"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-22 14:35:07"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-22 14:35:37"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-22 14:35:37"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-22 14:35:38"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-22 14:35:38"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-22 14:35:38"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-22 14:37:01"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-22 14:37:01"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-22 14:37:01"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-22 14:37:01"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-22 14:37:01"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-22 14:37:40"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-22 14:37:40"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-22 14:37:41"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-22 14:37:41"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-22 14:37:41"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-22 14:39:46"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-22 14:39:46"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-22 14:39:47"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-22 14:39:47"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-22 14:39:47"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-22 14:45:56"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-22 14:45:56"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-22 14:45:56"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-22 14:45:56"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-22 14:45:56"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-22 14:51:29"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-22 14:51:29"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-22 14:51:29"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-22 14:51:29"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-22 14:51:29"}
{"level":"info","message":"GET /api/statistics/transaction-volumes","service":"payment-service","timestamp":"2025-03-22 14:52:18"}
{"level":"info","message":"::ffff:127.0.0.1 - - [22/Mar/2025:12:52:19 +0000] \"GET /api/statistics/transaction-volumes HTTP/1.1\" 200 258 \"-\" \"PostmanRuntime/7.43.2\"","service":"payment-service","timestamp":"2025-03-22 14:52:19"}
{"level":"info","message":"GET /api/statistics/financial-analysis","service":"payment-service","timestamp":"2025-03-22 14:55:22"}
{"error":{"clientVersion":"6.4.1","code":"P2010","meta":{"code":"42803","message":"ERROR: column \"Transaction.createdAt\" must appear in the GROUP BY clause or be used in an aggregate function"},"name":"PrismaClientKnownRequestError"},"level":"error","message":"Error fetching financial analysis: \nInvalid `prisma.$queryRaw()` invocation:\n\n\nRaw query failed. Code: `42803`. Message: `ERROR: column \"Transaction.createdAt\" must appear in the GROUP BY clause or be used in an aggregate function`","service":"payment-service","timestamp":"2025-03-22 14:55:22"}
{"level":"info","message":"::ffff:127.0.0.1 - - [22/Mar/2025:12:55:22 +0000] \"GET /api/statistics/financial-analysis HTTP/1.1\" 500 439 \"-\" \"PostmanRuntime/7.43.2\"","service":"payment-service","timestamp":"2025-03-22 14:55:22"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-22 14:58:16"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-22 14:58:16"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-22 14:58:16"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-22 14:58:16"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-22 14:58:16"}
{"level":"info","message":"GET /api/statistics/financial-analysis","service":"payment-service","timestamp":"2025-03-22 14:58:38"}
{"level":"info","message":"::ffff:127.0.0.1 - - [22/Mar/2025:12:58:38 +0000] \"GET /api/statistics/financial-analysis HTTP/1.1\" 200 417 \"-\" \"PostmanRuntime/7.43.2\"","service":"payment-service","timestamp":"2025-03-22 14:58:38"}
{"level":"info","message":"GET /api/statistics/performance-metrics","service":"payment-service","timestamp":"2025-03-22 15:01:45"}
{"level":"info","message":"::ffff:127.0.0.1 - - [22/Mar/2025:13:01:45 +0000] \"GET /api/statistics/performance-metrics HTTP/1.1\" 200 439 \"-\" \"PostmanRuntime/7.43.2\"","service":"payment-service","timestamp":"2025-03-22 15:01:45"}
{"level":"info","message":"GET /api/statistics/payment-operations","service":"payment-service","timestamp":"2025-03-22 15:02:56"}
{"level":"info","message":"::ffff:127.0.0.1 - - [22/Mar/2025:13:02:56 +0000] \"GET /api/statistics/payment-operations HTTP/1.1\" 200 198 \"-\" \"PostmanRuntime/7.43.2\"","service":"payment-service","timestamp":"2025-03-22 15:02:56"}
{"level":"info","message":"GET /api/statistics/dashboard","service":"payment-service","timestamp":"2025-03-22 15:04:13"}
{"level":"info","message":"::ffff:127.0.0.1 - - [22/Mar/2025:13:04:13 +0000] \"GET /api/statistics/dashboard HTTP/1.1\" 200 1368 \"-\" \"PostmanRuntime/7.43.2\"","service":"payment-service","timestamp":"2025-03-22 15:04:13"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-22 15:05:43"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-22 15:05:43"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-22 15:05:43"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-22 15:05:43"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-22 15:05:43"}
{"level":"info","message":"Configuration loaded from .env file","service":"payment-service","timestamp":"2025-03-22 15:18:22"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-22 15:18:22"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-22 15:18:23"}
{"level":"info","message":"Loaded 1 configurations from database","service":"payment-service","timestamp":"2025-03-22 15:18:23"}
{"level":"info","message":"Configuration service initialized","service":"payment-service","timestamp":"2025-03-22 15:18:23"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-03-27 14:39:48"}
{"level":"info","message":"Database connection established","service":"payment-service","timestamp":"2025-03-27 14:39:50"}
{"level":"info","message":"Database connection closed","service":"payment-service","timestamp":"2025-03-27 14:39:58"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-04-17 10:55:43"}
{"clientVersion":"6.4.1","errorCode":"P1001","level":"error","message":"Database connection error: Can't reach database server at `db:5432`\n\nPlease make sure your database server is running at `db:5432`.","name":"PrismaClientInitializationError","service":"payment-service","stack":"PrismaClientInitializationError: Can't reach database server at `db:5432`\n\nPlease make sure your database server is running at `db:5432`.\n    at t (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\@prisma\\client\\runtime\\library.js:112:2473)","timestamp":"2025-04-17 10:55:46"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-04-17 11:00:27"}
{"clientVersion":"6.4.1","errorCode":"P1001","level":"error","message":"Database connection error: Can't reach database server at `db:5432`\n\nPlease make sure your database server is running at `db:5432`.","name":"PrismaClientInitializationError","service":"payment-service","stack":"PrismaClientInitializationError: Can't reach database server at `db:5432`\n\nPlease make sure your database server is running at `db:5432`.\n    at t (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\@prisma\\client\\runtime\\library.js:112:2473)","timestamp":"2025-04-17 11:00:29"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-04-17 11:09:34"}
{"clientVersion":"6.4.1","errorCode":"P1001","level":"error","message":"Database connection error: Can't reach database server at `db:5432`\n\nPlease make sure your database server is running at `db:5432`.","name":"PrismaClientInitializationError","service":"payment-service","stack":"PrismaClientInitializationError: Can't reach database server at `db:5432`\n\nPlease make sure your database server is running at `db:5432`.\n    at t (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\@prisma\\client\\runtime\\library.js:112:2473)","timestamp":"2025-04-17 11:09:36"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-04-17 11:15:39"}
{"clientVersion":"6.4.1","errorCode":"P1001","level":"error","message":"Database connection error: Can't reach database server at `db:5432`\n\nPlease make sure your database server is running at `db:5432`.","name":"PrismaClientInitializationError","service":"payment-service","stack":"PrismaClientInitializationError: Can't reach database server at `db:5432`\n\nPlease make sure your database server is running at `db:5432`.\n    at t (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\@prisma\\client\\runtime\\library.js:112:2473)","timestamp":"2025-04-17 11:15:41"}
{"level":"info","message":"Payment service running on port 3003","service":"payment-service","timestamp":"2025-04-17 20:19:11"}
{"clientVersion":"6.4.1","errorCode":"P1001","level":"error","message":"Database connection error: Can't reach database server at `db:5432`\n\nPlease make sure your database server is running at `db:5432`.","name":"PrismaClientInitializationError","service":"payment-service","stack":"PrismaClientInitializationError: Can't reach database server at `db:5432`\n\nPlease make sure your database server is running at `db:5432`.\n    at t (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\@prisma\\client\\runtime\\library.js:112:2473)","timestamp":"2025-04-17 20:19:13"}
