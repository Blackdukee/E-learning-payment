{"error":{"clientVersion":"6.4.1","errorCode":"P1012","name":"PrismaClientInitializationError"},"level":"error","message":"Failed to connect to the database: \u001b[1;91merror\u001b[0m: \u001b[1mError validating datasource `db`: the URL must start with the protocol `postgresql://` or `postgres://`.\u001b[0m\n  \u001b[1;94m-->\u001b[0m  \u001b[4mschema.prisma:9\u001b[0m\n\u001b[1;94m   | \u001b[0m\n\u001b[1;94m 8 | \u001b[0m  provider = \"postgresql\"\n\u001b[1;94m 9 | \u001b[0m  url      = \u001b[1;91menv(\"DATABASE_URL\")\u001b[0m\n\u001b[1;94m   | \u001b[0m\n\nValidation Error Count: 1","service":"payment-service","timestamp":"2025-03-05 12:40:42"}
{"error":{"clientVersion":"6.4.1","errorCode":"P1012","name":"PrismaClientInitializationError"},"level":"error","message":"Failed to connect to the database: \u001b[1;91merror\u001b[0m: \u001b[1mError validating datasource `db`: the URL must start with the protocol `postgresql://` or `postgres://`.\u001b[0m\n  \u001b[1;94m-->\u001b[0m  \u001b[4mschema.prisma:9\u001b[0m\n\u001b[1;94m   | \u001b[0m\n\u001b[1;94m 8 | \u001b[0m  provider = \"postgresql\"\n\u001b[1;94m 9 | \u001b[0m  url      = \u001b[1;91menv(\"DATABASE_URL\")\u001b[0m\n\u001b[1;94m   | \u001b[0m\n\nValidation Error Count: 1","service":"payment-service","timestamp":"2025-03-05 12:43:29"}
{"error":{"clientVersion":"6.4.1","errorCode":"P1012","name":"PrismaClientInitializationError"},"level":"error","message":"Failed to connect to the database: \u001b[1;91merror\u001b[0m: \u001b[1mError validating datasource `db`: the URL must start with the protocol `postgresql://` or `postgres://`.\u001b[0m\n  \u001b[1;94m-->\u001b[0m  \u001b[4mschema.prisma:9\u001b[0m\n\u001b[1;94m   | \u001b[0m\n\u001b[1;94m 8 | \u001b[0m  provider = \"postgresql\"\n\u001b[1;94m 9 | \u001b[0m  url      = \u001b[1;91menv(\"DATABASE_URL\")\u001b[0m\n\u001b[1;94m   | \u001b[0m\n\nValidation Error Count: 1","service":"payment-service","timestamp":"2025-03-05 12:44:12"}
{"error":{"clientVersion":"6.4.1","errorCode":"P1012","name":"PrismaClientInitializationError"},"level":"error","message":"Failed to connect to the database: \u001b[1;91merror\u001b[0m: \u001b[1mError validating datasource `db`: the URL must start with the protocol `postgresql://` or `postgres://`.\u001b[0m\n  \u001b[1;94m-->\u001b[0m  \u001b[4mschema.prisma:9\u001b[0m\n\u001b[1;94m   | \u001b[0m\n\u001b[1;94m 8 | \u001b[0m  provider = \"postgresql\"\n\u001b[1;94m 9 | \u001b[0m  url      = \u001b[1;91menv(\"DATABASE_URL\")\u001b[0m\n\u001b[1;94m   | \u001b[0m\n\nValidation Error Count: 1","service":"payment-service","timestamp":"2025-03-05 12:57:14"}
{"error":{"clientVersion":"6.4.1","errorCode":"P1012","name":"PrismaClientInitializationError"},"level":"error","message":"Failed to connect to the database: \u001b[1;91merror\u001b[0m: \u001b[1mError validating datasource `db`: the URL must start with the protocol `postgresql://` or `postgres://`.\u001b[0m\n  \u001b[1;94m-->\u001b[0m  \u001b[4mschema.prisma:9\u001b[0m\n\u001b[1;94m   | \u001b[0m\n\u001b[1;94m 8 | \u001b[0m  provider = \"postgresql\"\n\u001b[1;94m 9 | \u001b[0m  url      = \u001b[1;91menv(\"DATABASE_URL\")\u001b[0m\n\u001b[1;94m   | \u001b[0m\n\nValidation Error Count: 1","service":"payment-service","timestamp":"2025-03-05 12:57:14"}
{"error":{"clientVersion":"6.4.1","errorCode":"P1012","name":"PrismaClientInitializationError"},"level":"error","message":"Failed to connect to the database: \u001b[1;91merror\u001b[0m: \u001b[1mError validating datasource `db`: the URL must start with the protocol `postgresql://` or `postgres://`.\u001b[0m\n  \u001b[1;94m-->\u001b[0m  \u001b[4mschema.prisma:9\u001b[0m\n\u001b[1;94m   | \u001b[0m\n\u001b[1;94m 8 | \u001b[0m  provider = \"postgresql\"\n\u001b[1;94m 9 | \u001b[0m  url      = \u001b[1;91menv(\"DATABASE_URL\")\u001b[0m\n\u001b[1;94m   | \u001b[0m\n\nValidation Error Count: 1","service":"payment-service","timestamp":"2025-03-05 13:00:52"}
{"error":{"clientVersion":"6.4.1","errorCode":"P1012","name":"PrismaClientInitializationError"},"level":"error","message":"Failed to connect to the database: \u001b[1;91merror\u001b[0m: \u001b[1mError validating datasource `db`: the URL must start with the protocol `postgresql://` or `postgres://`.\u001b[0m\n  \u001b[1;94m-->\u001b[0m  \u001b[4mschema.prisma:9\u001b[0m\n\u001b[1;94m   | \u001b[0m\n\u001b[1;94m 8 | \u001b[0m  provider = \"postgresql\"\n\u001b[1;94m 9 | \u001b[0m  url      = \u001b[1;91menv(\"DATABASE_URL\")\u001b[0m\n\u001b[1;94m   | \u001b[0m\n\nValidation Error Count: 1","service":"payment-service","timestamp":"2025-03-05 13:00:52"}
{"error":{"clientVersion":"6.4.1","errorCode":"P1012","name":"PrismaClientInitializationError"},"level":"error","message":"Failed to connect to the database: \u001b[1;91merror\u001b[0m: \u001b[1mError validating datasource `db`: the URL must start with the protocol `postgresql://` or `postgres://`.\u001b[0m\n  \u001b[1;94m-->\u001b[0m  \u001b[4mschema.prisma:9\u001b[0m\n\u001b[1;94m   | \u001b[0m\n\u001b[1;94m 8 | \u001b[0m  provider = \"postgresql\"\n\u001b[1;94m 9 | \u001b[0m  url      = \u001b[1;91menv(\"DATABASE_URL\")\u001b[0m\n\u001b[1;94m   | \u001b[0m\n\nValidation Error Count: 1","service":"payment-service","timestamp":"2025-03-05 13:01:37"}
{"error":{"clientVersion":"6.4.1","errorCode":"P1012","name":"PrismaClientInitializationError"},"level":"error","message":"Failed to connect to the database: \u001b[1;91merror\u001b[0m: \u001b[1mError validating datasource `db`: the URL must start with the protocol `postgresql://` or `postgres://`.\u001b[0m\n  \u001b[1;94m-->\u001b[0m  \u001b[4mschema.prisma:9\u001b[0m\n\u001b[1;94m   | \u001b[0m\n\u001b[1;94m 8 | \u001b[0m  provider = \"postgresql\"\n\u001b[1;94m 9 | \u001b[0m  url      = \u001b[1;91menv(\"DATABASE_URL\")\u001b[0m\n\u001b[1;94m   | \u001b[0m\n\nValidation Error Count: 1","service":"payment-service","timestamp":"2025-03-05 13:01:38"}
{"level":"error","message":"Auth service unavailable: connect ECONNREFUSED ::1:5000","service":"payment-service","timestamp":"2025-03-05 13:40:56"}
{"body":{"amount":99.99,"courseId":"course123","educatorId":"educator456","paymentMethodId":"pm_card_visa"},"error":"Error: Authentication service unavailable\n    at validateToken (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\middleware\\auth.js:40:21)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","level":"error","message":"503 - Authentication service unavailable","method":"POST","params":{},"path":"/api/payments","query":{},"service":"payment-service","timestamp":"2025-03-05 13:40:56"}
{"level":"error","message":"Auth service unavailable: connect ECONNREFUSED ::1:5000","service":"payment-service","timestamp":"2025-03-05 13:46:58"}
{"body":{"amount":99.99,"courseId":"course123","educatorId":"educator456","paymentMethodId":"pm_card_visa"},"error":"Error: Authentication service unavailable\n    at validateToken (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\middleware\\auth.js:40:21)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","level":"error","message":"503 - Authentication service unavailable","method":"POST","params":{},"path":"/api/payments","query":{},"service":"payment-service","timestamp":"2025-03-05 13:46:58"}
{"level":"error","message":"Auth service unavailable: connect ECONNREFUSED ::1:5000","service":"payment-service","timestamp":"2025-03-05 13:47:13"}
{"body":{"amount":99.99,"courseId":"course123","educatorId":"educator456","paymentMethodId":"pm_card_visa"},"error":"Error: Authentication service unavailable\n    at validateToken (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\middleware\\auth.js:40:21)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","level":"error","message":"503 - Authentication service unavailable","method":"POST","params":{},"path":"/api/payments","query":{},"service":"payment-service","timestamp":"2025-03-05 13:47:13"}
{"level":"error","message":"Auth service unavailable: connect ECONNREFUSED ::1:5000","service":"payment-service","timestamp":"2025-03-05 13:48:11"}
{"body":{"amount":99.99,"courseId":"course123","educatorId":"educator456","paymentMethodId":"pm_card_visa"},"error":"Error: Authentication service unavailable\n    at validateToken (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\middleware\\auth.js:40:21)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","level":"error","message":"503 - Authentication service unavailable","method":"POST","params":{},"path":"/api/payments","query":{},"service":"payment-service","timestamp":"2025-03-05 13:48:11"}
{"level":"error","message":"Auth service unavailable: connect ECONNREFUSED ::1:5000","service":"payment-service","timestamp":"2025-03-05 13:48:23"}
{"body":{"amount":99.99,"courseId":"course123","educatorId":"educator456","paymentMethodId":"pm_card_visa"},"error":"Error: Authentication service unavailable\n    at validateToken (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\middleware\\auth.js:40:21)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","level":"error","message":"503 - Authentication service unavailable","method":"POST","params":{},"path":"/api/payments","query":{},"service":"payment-service","timestamp":"2025-03-05 13:48:23"}
{"level":"error","message":"Auth service unavailable: connect ECONNREFUSED ::1:5000","service":"payment-service","timestamp":"2025-03-05 13:48:55"}
{"error":{"clientVersion":"6.4.1","errorCode":"P1012","name":"PrismaClientInitializationError"},"level":"error","message":"Failed to connect to the database: \u001b[1;91merror\u001b[0m: \u001b[1mError validating datasource `db`: the URL must start with the protocol `postgresql://` or `postgres://`.\u001b[0m\n  \u001b[1;94m-->\u001b[0m  \u001b[4mschema.prisma:9\u001b[0m\n\u001b[1;94m   | \u001b[0m\n\u001b[1;94m 8 | \u001b[0m  provider = \"postgresql\"\n\u001b[1;94m 9 | \u001b[0m  url      = \u001b[1;91menv(\"DATABASE_URL\")\u001b[0m\n\u001b[1;94m   | \u001b[0m\n\nValidation Error Count: 1","service":"payment-service","timestamp":"2025-03-07 15:18:56"}
{"error":{"clientVersion":"6.4.1","errorCode":"P1012","name":"PrismaClientInitializationError"},"level":"error","message":"Failed to connect to the database: \u001b[1;91merror\u001b[0m: \u001b[1mError validating datasource `db`: the URL must start with the protocol `postgresql://` or `postgres://`.\u001b[0m\n  \u001b[1;94m-->\u001b[0m  \u001b[4mschema.prisma:9\u001b[0m\n\u001b[1;94m   | \u001b[0m\n\u001b[1;94m 8 | \u001b[0m  provider = \"postgresql\"\n\u001b[1;94m 9 | \u001b[0m  url      = \u001b[1;91menv(\"DATABASE_URL\")\u001b[0m\n\u001b[1;94m   | \u001b[0m\n\nValidation Error Count: 1","service":"payment-service","timestamp":"2025-03-07 15:18:58"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:45:10"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:45:34"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:46:57"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:32"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:33"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:33"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:36"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:38"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:38"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:38"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:38"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:38"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:39"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:39"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:39"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:39"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:39"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:39"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:39"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:39"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:39"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:39"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:39"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:39"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:39"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:39"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:39"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:40"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:41"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-09 15:58:42"}
{"data":{"action":"ENROLL_USER","courseId":"1","transactionId":"6721e6f4-7cf4-470a-8d0c-c5a34ca1b603","userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"mock-user-id\",\"action\":\"ENROLL_USER\",\"courseId\":\"1\",\"transactionId\":\"6721e6f4-7cf4-470a-8d0c-c5a34ca1b603\"}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"118","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:87:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-09 17:51:35"}
{"data":{"action":"RECORD_PURCHASE","amount":100,"courseId":"1","educatorEarnings":80,"userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"courseId\":\"1\",\"action\":\"RECORD_PURCHASE\",\"userId\":\"mock-user-id\",\"amount\":100,\"educatorEarnings\":80}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"102","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3002/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3002","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3002\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyCourseService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:41:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:95:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify course service: connect ECONNREFUSED ::1:3002","service":"payment-service","timestamp":"2025-03-09 17:51:35"}
{"data":{"action":"NEW_EARNINGS","data":{"amount":80,"courseId":"1","totalPendingEarnings":80,"transactionId":"6721e6f4-7cf4-470a-8d0c-c5a34ca1b603"},"userId":"1"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"1\",\"action\":\"NEW_EARNINGS\",\"data\":{\"courseId\":\"1\",\"transactionId\":\"6721e6f4-7cf4-470a-8d0c-c5a34ca1b603\",\"amount\":80,\"totalPendingEarnings\":80}}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"155","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:104:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-09 17:51:35"}
{"error":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"274","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=tMeDVGMLBnFFRMkPk1EngeaDRv9E-zTSxf-67qfZ9BpRY_XwN3LX5WMPHGUJULIUfiCBcnnlIC3c-zNH","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Sun, 09 Mar 2025 16:46:09 GMT","idempotency-key":"stripe-node-retry-af916aa8-8ce3-4b39-9f2f-bc1aea932328","original-request":"req_SoQEwaV93cgKcm","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_SoQEwaV93cgKcm","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"param":"reason","raw":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"274","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=tMeDVGMLBnFFRMkPk1EngeaDRv9E-zTSxf-67qfZ9BpRY_XwN3LX5WMPHGUJULIUfiCBcnnlIC3c-zNH","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Sun, 09 Mar 2025 16:46:09 GMT","idempotency-key":"stripe-node-retry-af916aa8-8ce3-4b39-9f2f-bc1aea932328","original-request":"req_SoQEwaV93cgKcm","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_SoQEwaV93cgKcm","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"Invalid reason: must be one of duplicate, fraudulent, or requested_by_customer","param":"reason","requestId":"req_SoQEwaV93cgKcm","request_log_url":"https://dashboard.stripe.com/test/logs/req_SoQEwaV93cgKcm?t=1741538769","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_SoQEwaV93cgKcm","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Refund processing error: Invalid reason: must be one of duplicate, fraudulent, or requested_by_customer","service":"payment-service","timestamp":"2025-03-09 18:46:09"}
{"level":"error","message":"Error processing refund: Refund processing failed: Invalid reason: must be one of duplicate, fraudulent, or requested_by_customer","service":"payment-service","timestamp":"2025-03-09 18:46:09"}
{"error":{"clientVersion":"6.4.1","code":"P2002","meta":{"modelName":"Transaction","target":["userId","courseId"]},"name":"PrismaClientKnownRequestError"},"level":"error","message":"Refund processing error: \nInvalid `prisma.transaction.create()` invocation in\nC:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:260:56\n\n  257 const refundedEarnings = originalTransaction.educatorEarnings * refundRatio;\n  258 \n  259 // 4. Create a refund transaction record\n→ 260 const refundTransaction = await prisma.transaction.create(\nUnique constraint failed on the fields: (`userId`,`courseId`)","service":"payment-service","timestamp":"2025-03-09 18:47:30"}
{"level":"error","message":"Error processing refund: Refund processing failed: \nInvalid `prisma.transaction.create()` invocation in\nC:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:260:56\n\n  257 const refundedEarnings = originalTransaction.educatorEarnings * refundRatio;\n  258 \n  259 // 4. Create a refund transaction record\n→ 260 const refundTransaction = await prisma.transaction.create(\nUnique constraint failed on the fields: (`userId`,`courseId`)","service":"payment-service","timestamp":"2025-03-09 18:47:30"}
{"error":{"code":"charge_already_refunded","doc_url":"https://stripe.com/docs/error-codes/charge-already-refunded","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"351","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=uo5UHmSha5Q70VPI7X2ct8VOD4K3oPRRQjBwbxRIgNRwKIusQZS0yQuBqsyzdXCdABIXDd26ohp7Ty2H","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Sun, 09 Mar 2025 16:51:36 GMT","idempotency-key":"stripe-node-retry-b1e287e6-a4d1-41e0-98b5-c6cf925464ee","original-request":"req_r4Rt2m10kp4MUG","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_r4Rt2m10kp4MUG","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"raw":{"code":"charge_already_refunded","doc_url":"https://stripe.com/docs/error-codes/charge-already-refunded","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"351","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=uo5UHmSha5Q70VPI7X2ct8VOD4K3oPRRQjBwbxRIgNRwKIusQZS0yQuBqsyzdXCdABIXDd26ohp7Ty2H","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Sun, 09 Mar 2025 16:51:36 GMT","idempotency-key":"stripe-node-retry-b1e287e6-a4d1-41e0-98b5-c6cf925464ee","original-request":"req_r4Rt2m10kp4MUG","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_r4Rt2m10kp4MUG","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"Charge ch_3R0m8YDxY1cZtFZH2M6tXLfH has already been refunded.","requestId":"req_r4Rt2m10kp4MUG","request_log_url":"https://dashboard.stripe.com/test/logs/req_r4Rt2m10kp4MUG?t=1741539096","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_r4Rt2m10kp4MUG","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Refund processing error: Charge ch_3R0m8YDxY1cZtFZH2M6tXLfH has already been refunded.","service":"payment-service","timestamp":"2025-03-09 18:51:36"}
{"level":"error","message":"Error processing refund: Refund processing failed: Charge ch_3R0m8YDxY1cZtFZH2M6tXLfH has already been refunded.","service":"payment-service","timestamp":"2025-03-09 18:51:36"}
{"error":{"isOperational":true,"status":"fail","statusCode":400},"level":"error","message":"Payment processing error: User already enrolled in this course","service":"payment-service","timestamp":"2025-03-09 18:53:25"}
{"level":"error","message":"Error processing payment: \nInvalid `prisma.transaction.create()` invocation in\nC:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:135:32\n\n  132 \n  133 // Record failed transaction if we have enough information\n  134 if (courseId && amount && user?.id) {\n→ 135   await prisma.transaction.create(\nUnique constraint failed on the fields: (`userId`,`courseId`)","service":"payment-service","timestamp":"2025-03-09 18:53:25"}
{"error":{"isOperational":true,"status":"fail","statusCode":400},"level":"error","message":"Payment processing error: User already enrolled in this course","service":"payment-service","timestamp":"2025-03-09 18:56:10"}
{"level":"error","message":"Error processing payment: Payment processing failed: User already enrolled in this course","service":"payment-service","timestamp":"2025-03-09 18:56:10"}
{"error":{"isOperational":true,"status":"fail","statusCode":400},"level":"error","message":"Payment processing error: User already enrolled in this course","service":"payment-service","timestamp":"2025-03-09 19:00:26"}
{"level":"error","message":"Error processing payment: Payment processing failed: User already enrolled in this course","service":"payment-service","timestamp":"2025-03-09 19:00:26"}
{"error":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"281","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=qeQGEUD5towABJHRXLQskW2LSNND4U_mmsKF4YChWfmOPnwyXjrYkTQZ44BmRxJ8WpfQqzY3i-WVMlDf","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Mon, 10 Mar 2025 11:38:32 GMT","idempotency-key":"stripe-node-retry-b10f532a-d8ea-4d4f-b256-22e1228a3ab3","original-request":"req_tY2IkhgTxAK62H","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_tY2IkhgTxAK62H","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"param":"source","raw":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"281","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=qeQGEUD5towABJHRXLQskW2LSNND4U_mmsKF4YChWfmOPnwyXjrYkTQZ44BmRxJ8WpfQqzY3i-WVMlDf","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Mon, 10 Mar 2025 11:38:32 GMT","idempotency-key":"stripe-node-retry-b10f532a-d8ea-4d4f-b256-22e1228a3ab3","original-request":"req_tY2IkhgTxAK62H","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_tY2IkhgTxAK62H","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"You cannot create a charge with a PaymentMethod. Use the Payment Intents API instead.","param":"source","requestId":"req_tY2IkhgTxAK62H","request_log_url":"https://dashboard.stripe.com/test/logs/req_tY2IkhgTxAK62H?t=1741606712","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_tY2IkhgTxAK62H","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Payment processing error: You cannot create a charge with a PaymentMethod. Use the Payment Intents API instead.","service":"payment-service","timestamp":"2025-03-10 13:38:33"}
{"level":"error","message":"Error processing payment: Payment processing failed: You cannot create a charge with a PaymentMethod. Use the Payment Intents API instead.","service":"payment-service","timestamp":"2025-03-10 13:38:33"}
{"error":{"code":"parameter_missing","doc_url":"https://stripe.com/docs/error-codes/parameter-missing","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"310","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=aDi6Rz3Mg4fv8Q03f82FLunk2bjo7ExtGcXj_ur2FSHK7FeZyhvp0YoNBInNwBNLcEgQNmb85xjL1IHW","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Mon, 10 Mar 2025 11:43:38 GMT","idempotency-key":"stripe-node-retry-35f894fa-76c8-484d-9c7b-49316fdfb701","original-request":"req_6LglrLAcfqsduG","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_6LglrLAcfqsduG","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"raw":{"code":"parameter_missing","doc_url":"https://stripe.com/docs/error-codes/parameter-missing","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"310","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=aDi6Rz3Mg4fv8Q03f82FLunk2bjo7ExtGcXj_ur2FSHK7FeZyhvp0YoNBInNwBNLcEgQNmb85xjL1IHW","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Mon, 10 Mar 2025 11:43:38 GMT","idempotency-key":"stripe-node-retry-35f894fa-76c8-484d-9c7b-49316fdfb701","original-request":"req_6LglrLAcfqsduG","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_6LglrLAcfqsduG","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"Must provide source or customer.","requestId":"req_6LglrLAcfqsduG","request_log_url":"https://dashboard.stripe.com/test/logs/req_6LglrLAcfqsduG?t=1741607018","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_6LglrLAcfqsduG","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Payment processing error: Must provide source or customer.","service":"payment-service","timestamp":"2025-03-10 13:43:39"}
{"level":"error","message":"Error processing payment: Payment processing failed: Must provide source or customer.","service":"payment-service","timestamp":"2025-03-10 13:43:39"}
{"error":{"code":"parameter_missing","doc_url":"https://stripe.com/docs/error-codes/parameter-missing","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"310","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=4z5x926Ww4tKj_zRLghnm-Uh7PltYaT9BLdgPTj3VTq__EskAG543kGL7sWUJ48bFLmt-VCLIkBZKLPA","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Mon, 10 Mar 2025 11:45:50 GMT","idempotency-key":"stripe-node-retry-a31aa4ca-a74f-4dd8-af78-9590b7bcc74d","original-request":"req_Oza6Ff9kr1coFy","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_Oza6Ff9kr1coFy","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"raw":{"code":"parameter_missing","doc_url":"https://stripe.com/docs/error-codes/parameter-missing","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"310","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=4z5x926Ww4tKj_zRLghnm-Uh7PltYaT9BLdgPTj3VTq__EskAG543kGL7sWUJ48bFLmt-VCLIkBZKLPA","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Mon, 10 Mar 2025 11:45:50 GMT","idempotency-key":"stripe-node-retry-a31aa4ca-a74f-4dd8-af78-9590b7bcc74d","original-request":"req_Oza6Ff9kr1coFy","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_Oza6Ff9kr1coFy","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"Must provide source or customer.","requestId":"req_Oza6Ff9kr1coFy","request_log_url":"https://dashboard.stripe.com/test/logs/req_Oza6Ff9kr1coFy?t=1741607150","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_Oza6Ff9kr1coFy","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Payment processing error: Must provide source or customer.","service":"payment-service","timestamp":"2025-03-10 13:45:51"}
{"level":"error","message":"Error processing payment: Payment processing failed: Must provide source or customer.","service":"payment-service","timestamp":"2025-03-10 13:45:51"}
{"error":{"code":"parameter_unknown","doc_url":"https://stripe.com/docs/error-codes/parameter-unknown","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"337","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=zNVOhIV7jr9jpsMkDEpispz-4I2mGQkG8qf0ZzpCqwJpUj-N7l6vNEcKmnXcWrTZP30VFGOSStS9Biol","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Mon, 10 Mar 2025 11:48:45 GMT","idempotency-key":"stripe-node-retry-9e08d302-594a-485f-8fd0-4f1b91ef416f","original-request":"req_VNv2qIZh0cEWlx","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_VNv2qIZh0cEWlx","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"param":"confirm","raw":{"code":"parameter_unknown","doc_url":"https://stripe.com/docs/error-codes/parameter-unknown","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"337","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=zNVOhIV7jr9jpsMkDEpispz-4I2mGQkG8qf0ZzpCqwJpUj-N7l6vNEcKmnXcWrTZP30VFGOSStS9Biol","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Mon, 10 Mar 2025 11:48:45 GMT","idempotency-key":"stripe-node-retry-9e08d302-594a-485f-8fd0-4f1b91ef416f","original-request":"req_VNv2qIZh0cEWlx","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_VNv2qIZh0cEWlx","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"Received unknown parameter: confirm","param":"confirm","requestId":"req_VNv2qIZh0cEWlx","request_log_url":"https://dashboard.stripe.com/test/logs/req_VNv2qIZh0cEWlx?t=1741607325","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_VNv2qIZh0cEWlx","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Payment processing error: Received unknown parameter: confirm","service":"payment-service","timestamp":"2025-03-10 13:48:46"}
{"level":"error","message":"Error processing payment: Payment processing failed: Received unknown parameter: confirm","service":"payment-service","timestamp":"2025-03-10 13:48:46"}
{"data":{"action":"ENROLL_USER","courseId":"course_1","transactionId":"1db0e8c7-8ad5-4e59-b474-735f26c4befb","userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"mock-user-id\",\"action\":\"ENROLL_USER\",\"courseId\":\"course_1\",\"transactionId\":\"1db0e8c7-8ad5-4e59-b474-735f26c4befb\"}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"125","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:87:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-10 13:49:10"}
{"data":{"action":"RECORD_PURCHASE","amount":99.99,"courseId":"course_1","educatorEarnings":79.99199999999999,"userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"courseId\":\"course_1\",\"action\":\"RECORD_PURCHASE\",\"userId\":\"mock-user-id\",\"amount\":99.99,\"educatorEarnings\":79.99199999999999}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"126","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3002/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3002","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3002\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyCourseService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:41:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:95:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify course service: connect ECONNREFUSED ::1:3002","service":"payment-service","timestamp":"2025-03-10 13:49:10"}
{"data":{"action":"NEW_EARNINGS","data":{"amount":79.99199999999999,"courseId":"course_1","totalPendingEarnings":79.99199999999999,"transactionId":"1db0e8c7-8ad5-4e59-b474-735f26c4befb"},"userId":"edu_123"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"edu_123\",\"action\":\"NEW_EARNINGS\",\"data\":{\"courseId\":\"course_1\",\"transactionId\":\"1db0e8c7-8ad5-4e59-b474-735f26c4befb\",\"amount\":79.99199999999999,\"totalPendingEarnings\":79.99199999999999}}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"198","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:104:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-10 13:49:10"}
{"data":{"action":"REMOVE_ENROLLMENT","courseId":"course_1","transactionId":"1fd0ad40-abad-4cad-ba87-8227f9d14d38","userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"mock-user-id\",\"action\":\"REMOVE_ENROLLMENT\",\"courseId\":\"course_1\",\"transactionId\":\"1fd0ad40-abad-4cad-ba87-8227f9d14d38\"}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"131","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processRefund (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:299:5)\n    at async processRefund (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:26:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-10 14:28:34"}
{"data":{"action":"RECORD_REFUND","amount":99.99,"courseId":"course_1","educatorEarnings":-79.99199999999999,"userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"courseId\":\"course_1\",\"action\":\"RECORD_REFUND\",\"userId\":\"mock-user-id\",\"amount\":99.99,\"educatorEarnings\":-79.99199999999999}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"125","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3002/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3002","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3002\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyCourseService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:41:5)\n    at async Object.processRefund (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:306:5)\n    at async processRefund (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:26:20)"},"level":"error","message":"Failed to notify course service: connect ECONNREFUSED ::1:3002","service":"payment-service","timestamp":"2025-03-10 14:28:34"}
{"data":{"action":"EARNINGS_REFUNDED","data":{"amount":79.99199999999999,"courseId":"course_1","reason":"requested_by_customer","totalPendingEarnings":-79.99199999999999,"transactionId":"1fd0ad40-abad-4cad-ba87-8227f9d14d38"},"userId":"edu_123"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"edu_123\",\"action\":\"EARNINGS_REFUNDED\",\"data\":{\"courseId\":\"course_1\",\"transactionId\":\"1fd0ad40-abad-4cad-ba87-8227f9d14d38\",\"amount\":79.99199999999999,\"totalPendingEarnings\":-79.99199999999999,\"reason\":\"requested_by_customer\"}}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"237","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processRefund (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:315:5)\n    at async processRefund (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:26:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-10 14:28:34"}
{"error":{"clientVersion":"6.4.1","name":"PrismaClientValidationError"},"level":"error","message":"Error requesting payout: \nInvalid `prisma.payout.create()` invocation in\nC:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\payoutService.js:108:40\n\n  105 });\n  106 \n  107 // Create the payout record\n→ 108 const payout = await prisma.payout.create({\n        data: {\n          payoutNumber: \"PAYOUT-2025-000001\",\n          educatorId: \"edu_123\",\n          status: \"PENDING\",\n          processingFee: 2.5,\n          paymentMethod: \"bank_transfer\",\n          bankDetails: undefined,\n          periodStart: new Date(\"2025-03-10T12:28:34.197Z\"),\n          periodEnd: new Date(\"2025-03-10T12:50:50.929Z\"),\n          notes: undefined,\n          metadata: {\n            requestedBy: \"edu_123\",\n            ipAddress: \"::ffff:127.0.0.1\"\n          },\n      +   amount: Float\n        }\n      })\n\nArgument `amount` is missing.","service":"payment-service","timestamp":"2025-03-10 14:50:50"}
{"error":{"isOperational":true,"status":"fail","statusCode":400},"level":"error","message":"Error requesting payout: Insufficient balance. Available: $0","service":"payment-service","timestamp":"2025-03-10 15:26:59"}
{"error":{"isOperational":true,"status":"fail","statusCode":400},"level":"error","message":"Payment processing error: User already enrolled in this course","service":"payment-service","timestamp":"2025-03-10 15:29:48"}
{"level":"error","message":"Error processing payment: Payment processing failed: User already enrolled in this course","service":"payment-service","timestamp":"2025-03-10 15:29:48"}
{"data":{"action":"ENROLL_USER","courseId":"3","transactionId":"14b4ec76-7c78-4833-a608-6ade135734df","userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"mock-user-id\",\"action\":\"ENROLL_USER\",\"courseId\":\"3\",\"transactionId\":\"14b4ec76-7c78-4833-a608-6ade135734df\"}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"118","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:87:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-10 15:29:58"}
{"data":{"action":"RECORD_PURCHASE","amount":100,"courseId":"3","educatorEarnings":80,"userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"courseId\":\"3\",\"action\":\"RECORD_PURCHASE\",\"userId\":\"mock-user-id\",\"amount\":100,\"educatorEarnings\":80}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"102","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3002/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3002","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3002\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyCourseService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:41:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:95:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify course service: connect ECONNREFUSED ::1:3002","service":"payment-service","timestamp":"2025-03-10 15:29:58"}
{"data":{"action":"NEW_EARNINGS","data":{"amount":80,"courseId":"3","totalPendingEarnings":0.008000000000009777,"transactionId":"14b4ec76-7c78-4833-a608-6ade135734df"},"userId":"edu_123"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"edu_123\",\"action\":\"NEW_EARNINGS\",\"data\":{\"courseId\":\"3\",\"transactionId\":\"14b4ec76-7c78-4833-a608-6ade135734df\",\"amount\":80,\"totalPendingEarnings\":0.008000000000009777}}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"179","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:104:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-10 15:29:58"}
{"error":{"isOperational":true,"status":"fail","statusCode":400},"level":"error","message":"Error requesting payout: Insufficient balance. Available: $80","service":"payment-service","timestamp":"2025-03-10 15:30:34"}
{"error":{"isOperational":true,"status":"fail","statusCode":400},"level":"error","message":"Error requesting payout: You already have a pending payout request","service":"payment-service","timestamp":"2025-03-10 18:57:19"}
{"data":{"action":"PAYOUT_COMPLETED","data":{"amount":80,"payoutId":"e24e2007-cf19-4b36-add9-e517cbece67a","payoutNumber":"PAYOUT-2025-000001"},"userId":"edu_123"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"edu_123\",\"action\":\"PAYOUT_COMPLETED\",\"data\":{\"payoutId\":\"e24e2007-cf19-4b36-add9-e517cbece67a\",\"amount\":80,\"payoutNumber\":\"PAYOUT-2025-000001\"}}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"155","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayout (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\payoutService.js:285:7)\n    at async processPayout (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\payoutController.js:72:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-10 19:03:31"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-11 14:47:06"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-11 14:47:47"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-11 14:48:37"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-11 14:50:51"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-11 14:58:25"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-11 14:58:55"}
{"level":"error","message":"Stripe Connect is not configured properly","service":"payment-service","timestamp":"2025-03-11 15:02:07"}
{"error":{"isOperational":true,"status":"fail","statusCode":400},"level":"error","message":"Error creating Stripe account: Stripe Connect is not enabled for this account. Please set up Stripe Connect first: https://stripe.com/docs/connect","service":"payment-service","timestamp":"2025-03-11 15:02:07"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-11 15:02:07"}
{"level":"error","message":"Stripe Connect is not configured properly","service":"payment-service","timestamp":"2025-03-11 15:11:58"}
{"error":{"isOperational":true,"status":"fail","statusCode":400},"level":"error","message":"Error creating Stripe account: Stripe Connect is not enabled for this account. Please set up Stripe Connect first: https://stripe.com/docs/connect","service":"payment-service","timestamp":"2025-03-11 15:11:58"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-11 15:11:58"}
{"error":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"304","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=AEu-CUjZWg7d7FSneXyBUKechtzoAxtberqIdC7-06KWuZLVI8_xBo9ATKTL0wlsN__m7e8ltEiDjEZp","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Tue, 11 Mar 2025 13:23:48 GMT","idempotency-key":"d17307be-aca2-474a-8175-efefd6183543","original-request":"req_s7D6oejDGpFxLz","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_s7D6oejDGpFxLz","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"raw":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"304","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=AEu-CUjZWg7d7FSneXyBUKechtzoAxtberqIdC7-06KWuZLVI8_xBo9ATKTL0wlsN__m7e8ltEiDjEZp","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Tue, 11 Mar 2025 13:23:48 GMT","idempotency-key":"d17307be-aca2-474a-8175-efefd6183543","original-request":"req_s7D6oejDGpFxLz","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_s7D6oejDGpFxLz","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"You can only create new accounts if you've signed up for Connect, which you can learn how to do at https://stripe.com/docs/connect.","requestId":"req_s7D6oejDGpFxLz","request_log_url":"https://dashboard.stripe.com/test/logs/req_s7D6oejDGpFxLz?t=1741699428","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_s7D6oejDGpFxLz","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Error creating Stripe account: You can only create new accounts if you've signed up for Connect, which you can learn how to do at https://stripe.com/docs/connect.","service":"payment-service","timestamp":"2025-03-11 15:23:49"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-11 15:23:49"}
{"data":{"action":"ENROLL_USER","courseId":"4","transactionId":"a750e456-0098-4b74-8ce2-e7a8c69fb3c3","userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"mock-user-id\",\"action\":\"ENROLL_USER\",\"courseId\":\"4\",\"transactionId\":\"a750e456-0098-4b74-8ce2-e7a8c69fb3c3\"}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"118","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:102:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-11 15:24:25"}
{"data":{"action":"RECORD_PURCHASE","amount":100,"courseId":"4","educatorEarnings":80,"userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"courseId\":\"4\",\"action\":\"RECORD_PURCHASE\",\"userId\":\"mock-user-id\",\"amount\":100,\"educatorEarnings\":80}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"102","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3002/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3002","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3002\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyCourseService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:41:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:110:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify course service: connect ECONNREFUSED ::1:3002","service":"payment-service","timestamp":"2025-03-11 15:24:25"}
{"data":{"action":"NEW_EARNINGS","data":{"amount":80,"courseId":"4","totalPendingEarnings":80,"transactionId":"a750e456-0098-4b74-8ce2-e7a8c69fb3c3"},"userId":"edu_123"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"edu_123\",\"action\":\"NEW_EARNINGS\",\"data\":{\"courseId\":\"4\",\"transactionId\":\"a750e456-0098-4b74-8ce2-e7a8c69fb3c3\",\"amount\":80,\"totalPendingEarnings\":80}}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"161","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:119:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-11 15:24:25"}
{"error":{"isOperational":true,"status":"fail","statusCode":400},"level":"error","message":"Payment processing error: User already enrolled in this course","service":"payment-service","timestamp":"2025-03-11 15:26:26"}
{"level":"error","message":"Error processing payment: Payment processing failed: User already enrolled in this course","service":"payment-service","timestamp":"2025-03-11 15:26:26"}
{"error":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"304","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=9fEhwzG6z0-KOPyqfYlEbeSRAKNG5xBqxCtG8UMWA5BwlDLuSlPfJVjPnBetY6XoRmkghNxGlccELXS9","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Tue, 11 Mar 2025 13:27:00 GMT","idempotency-key":"5d31acba-f2f4-4e5b-bffc-0a36cc4cef1b","original-request":"req_zpc2YGkdIoI3L9","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_zpc2YGkdIoI3L9","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"raw":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"304","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=9fEhwzG6z0-KOPyqfYlEbeSRAKNG5xBqxCtG8UMWA5BwlDLuSlPfJVjPnBetY6XoRmkghNxGlccELXS9","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Tue, 11 Mar 2025 13:27:00 GMT","idempotency-key":"5d31acba-f2f4-4e5b-bffc-0a36cc4cef1b","original-request":"req_zpc2YGkdIoI3L9","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_zpc2YGkdIoI3L9","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"You can only create new accounts if you've signed up for Connect, which you can learn how to do at https://stripe.com/docs/connect.","requestId":"req_zpc2YGkdIoI3L9","request_log_url":"https://dashboard.stripe.com/test/logs/req_zpc2YGkdIoI3L9?t=1741699620","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_zpc2YGkdIoI3L9","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Error creating Stripe account: You can only create new accounts if you've signed up for Connect, which you can learn how to do at https://stripe.com/docs/connect.","service":"payment-service","timestamp":"2025-03-11 15:27:01"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-11 15:27:01"}
{"error":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"304","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=9fEhwzG6z0-KOPyqfYlEbeSRAKNG5xBqxCtG8UMWA5BwlDLuSlPfJVjPnBetY6XoRmkghNxGlccELXS9","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Tue, 11 Mar 2025 13:27:09 GMT","idempotency-key":"6c589b65-0bca-431f-8d3a-5b735baf891c","original-request":"req_xLf5q6stIfnRzB","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_xLf5q6stIfnRzB","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"raw":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"304","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=9fEhwzG6z0-KOPyqfYlEbeSRAKNG5xBqxCtG8UMWA5BwlDLuSlPfJVjPnBetY6XoRmkghNxGlccELXS9","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Tue, 11 Mar 2025 13:27:09 GMT","idempotency-key":"6c589b65-0bca-431f-8d3a-5b735baf891c","original-request":"req_xLf5q6stIfnRzB","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_xLf5q6stIfnRzB","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"You can only create new accounts if you've signed up for Connect, which you can learn how to do at https://stripe.com/docs/connect.","requestId":"req_xLf5q6stIfnRzB","request_log_url":"https://dashboard.stripe.com/test/logs/req_xLf5q6stIfnRzB?t=1741699629","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_xLf5q6stIfnRzB","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Error creating Stripe account: You can only create new accounts if you've signed up for Connect, which you can learn how to do at https://stripe.com/docs/connect.","service":"payment-service","timestamp":"2025-03-11 15:27:10"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-11 15:27:10"}
{"error":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"304","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=9fEhwzG6z0-KOPyqfYlEbeSRAKNG5xBqxCtG8UMWA5BwlDLuSlPfJVjPnBetY6XoRmkghNxGlccELXS9","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Tue, 11 Mar 2025 13:27:53 GMT","idempotency-key":"e4bf8ecf-242d-453b-8eb0-8e947a4f477b","original-request":"req_3pNssjKNon6WCr","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_3pNssjKNon6WCr","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"raw":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"304","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=9fEhwzG6z0-KOPyqfYlEbeSRAKNG5xBqxCtG8UMWA5BwlDLuSlPfJVjPnBetY6XoRmkghNxGlccELXS9","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Tue, 11 Mar 2025 13:27:53 GMT","idempotency-key":"e4bf8ecf-242d-453b-8eb0-8e947a4f477b","original-request":"req_3pNssjKNon6WCr","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_3pNssjKNon6WCr","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"You can only create new accounts if you've signed up for Connect, which you can learn how to do at https://stripe.com/docs/connect.","requestId":"req_3pNssjKNon6WCr","request_log_url":"https://dashboard.stripe.com/test/logs/req_3pNssjKNon6WCr?t=1741699673","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_3pNssjKNon6WCr","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Error creating Stripe account: You can only create new accounts if you've signed up for Connect, which you can learn how to do at https://stripe.com/docs/connect.","service":"payment-service","timestamp":"2025-03-11 16:16:32"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-11 16:16:34"}
{"error":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"324","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=reEbI6gkGHrlevNK6lQVXk_e-2xoSNwiPtckEe_S_tQiDzTWC0FP9kd0ytMCUQ_WeGxdFR5GBrsT4vUO","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Tue, 11 Mar 2025 14:18:53 GMT","idempotency-key":"30246009-67aa-4e53-ba1f-054db060bd6d","original-request":"req_1QvRptrZDSv5It","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_1QvRptrZDSv5It","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"raw":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"324","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=reEbI6gkGHrlevNK6lQVXk_e-2xoSNwiPtckEe_S_tQiDzTWC0FP9kd0ytMCUQ_WeGxdFR5GBrsT4vUO","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Tue, 11 Mar 2025 14:18:53 GMT","idempotency-key":"30246009-67aa-4e53-ba1f-054db060bd6d","original-request":"req_1QvRptrZDSv5It","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_1QvRptrZDSv5It","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"Connected accounts in US cannot be created by platforms in AE. Please contact us via https://support.stripe.com/contact if you need further assistance.","requestId":"req_1QvRptrZDSv5It","request_log_url":"https://dashboard.stripe.com/test/logs/req_1QvRptrZDSv5It?t=1741702733","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_1QvRptrZDSv5It","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Error creating Stripe account: Connected accounts in US cannot be created by platforms in AE. Please contact us via https://support.stripe.com/contact if you need further assistance.","service":"payment-service","timestamp":"2025-03-11 16:18:54"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-11 16:18:54"}
{"error":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"391","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=O0ydwDwSBMHm3sYl7Yx1mD4uuRBoo6iGFDzUiJwG3lfSlBJtVAIAQIFqeL-n1ZYFJz690QDVyOrtXrI-","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Tue, 11 Mar 2025 14:23:02 GMT","idempotency-key":"4b70cae3-1328-4088-912b-c45022d6bb4b","original-request":"req_0KfnD4qb7UgJHG","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_0KfnD4qb7UgJHG","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"raw":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"391","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=O0ydwDwSBMHm3sYl7Yx1mD4uuRBoo6iGFDzUiJwG3lfSlBJtVAIAQIFqeL-n1ZYFJz690QDVyOrtXrI-","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Tue, 11 Mar 2025 14:23:02 GMT","idempotency-key":"4b70cae3-1328-4088-912b-c45022d6bb4b","original-request":"req_0KfnD4qb7UgJHG","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_0KfnD4qb7UgJHG","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"Platforms in AE cannot create accounts where the platform is loss-liable, due to risk control measures. Please refer to our guide (https://support.stripe.com/questions/connect-availability-in-the-uae) for more details.","requestId":"req_0KfnD4qb7UgJHG","request_log_url":"https://dashboard.stripe.com/test/logs/req_0KfnD4qb7UgJHG?t=1741702982","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_0KfnD4qb7UgJHG","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Error creating Stripe account: Platforms in AE cannot create accounts where the platform is loss-liable, due to risk control measures. Please refer to our guide (https://support.stripe.com/questions/connect-availability-in-the-uae) for more details.","service":"payment-service","timestamp":"2025-03-11 16:23:03"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-11 16:23:03"}
{"error":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"391","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=ewiqq4a0MBftKcsUjB0eu6nFikDGNPkMuLxGK6hBFAs4gG78AKVA3xNKRLiswV4VXHOf2h3yb0qmuQLK","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Tue, 11 Mar 2025 14:24:42 GMT","idempotency-key":"fede27d1-6aae-4c97-a7c6-582e45d00c4f","original-request":"req_IeSaHyIBfKPsWg","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_IeSaHyIBfKPsWg","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"raw":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"391","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=ewiqq4a0MBftKcsUjB0eu6nFikDGNPkMuLxGK6hBFAs4gG78AKVA3xNKRLiswV4VXHOf2h3yb0qmuQLK","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Tue, 11 Mar 2025 14:24:42 GMT","idempotency-key":"fede27d1-6aae-4c97-a7c6-582e45d00c4f","original-request":"req_IeSaHyIBfKPsWg","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_IeSaHyIBfKPsWg","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"Platforms in AE cannot create accounts where the platform is loss-liable, due to risk control measures. Please refer to our guide (https://support.stripe.com/questions/connect-availability-in-the-uae) for more details.","requestId":"req_IeSaHyIBfKPsWg","request_log_url":"https://dashboard.stripe.com/test/logs/req_IeSaHyIBfKPsWg?t=1741703082","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_IeSaHyIBfKPsWg","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Error creating Stripe account: Platforms in AE cannot create accounts where the platform is loss-liable, due to risk control measures. Please refer to our guide (https://support.stripe.com/questions/connect-availability-in-the-uae) for more details.","service":"payment-service","timestamp":"2025-03-11 16:24:43"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-11 16:24:43"}
{"error":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"658","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=3Ec1oU5qpc3DidwBVZvCBrgzHdjbCpLPFAkp3c4HR83RiBipF9Ax5xx16wTjwUBTWkou3EZBXqwy_KbV","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Tue, 11 Mar 2025 14:52:17 GMT","idempotency-key":"38cb3918-ab84-416f-a28c-80e4cb816a3a","original-request":"req_0yojWltyuhSO4Y","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_0yojWltyuhSO4Y","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"param":"requested_capabilities","raw":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"658","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=3Ec1oU5qpc3DidwBVZvCBrgzHdjbCpLPFAkp3c4HR83RiBipF9Ax5xx16wTjwUBTWkou3EZBXqwy_KbV","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Tue, 11 Mar 2025 14:52:17 GMT","idempotency-key":"38cb3918-ab84-416f-a28c-80e4cb816a3a","original-request":"req_0yojWltyuhSO4Y","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_0yojWltyuhSO4Y","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"When requesting the `transfers` capability for accounts in AE, you must either specify the `recipient` service agreement, or request the `card_payments` capability along with `transfers`. To specify the `recipient` service agreement, see https://stripe.com/docs/connect/service-agreement-types#choosing-type-with-api. For more information on cross-border transfers, see https://stripe.com/docs/connect/account-capabilities#transfers-cross-border.","param":"requested_capabilities","requestId":"req_0yojWltyuhSO4Y","request_log_url":"https://dashboard.stripe.com/test/logs/req_0yojWltyuhSO4Y?t=1741704737","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_0yojWltyuhSO4Y","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Error creating Stripe account: When requesting the `transfers` capability for accounts in AE, you must either specify the `recipient` service agreement, or request the `card_payments` capability along with `transfers`. To specify the `recipient` service agreement, see https://stripe.com/docs/connect/service-agreement-types#choosing-type-with-api. For more information on cross-border transfers, see https://stripe.com/docs/connect/account-capabilities#transfers-cross-border.","service":"payment-service","timestamp":"2025-03-11 16:52:18"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-11 16:52:18"}
{"error":{},"level":"error","message":"Error creating Stripe account: Cannot read properties of undefined (reading 'create')","service":"payment-service","timestamp":"2025-03-11 16:56:42"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-11 16:56:42"}
{"error":{},"level":"error","message":"Error creating Stripe account: Cannot read properties of undefined (reading 'create')","service":"payment-service","timestamp":"2025-03-11 17:00:49"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-11 17:00:49"}
{"error":{},"level":"error","message":"Error creating Stripe account: Cannot read properties of undefined (reading 'create')","service":"payment-service","timestamp":"2025-03-11 17:02:42"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-11 17:02:42"}
{"error":{"code":"url_invalid","doc_url":"https://stripe.com/docs/error-codes/url-invalid","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"319","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=VfMgaN6Jy4Oq6AaaUvMRt1HPPs-BVf9_uS6spxA3s4uea4b4gOsWUOLD0SScwy7ob_-U6dU3xkPA3edn","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Tue, 11 Mar 2025 15:52:45 GMT","idempotency-key":"5fb32e08-842d-4b85-9e3b-1f201e26fdf7","original-request":"req_i3YFNI5I62ICuE","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_i3YFNI5I62ICuE","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"param":"business_profile[url]","raw":{"code":"url_invalid","doc_url":"https://stripe.com/docs/error-codes/url-invalid","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"319","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=VfMgaN6Jy4Oq6AaaUvMRt1HPPs-BVf9_uS6spxA3s4uea4b4gOsWUOLD0SScwy7ob_-U6dU3xkPA3edn","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Tue, 11 Mar 2025 15:52:45 GMT","idempotency-key":"5fb32e08-842d-4b85-9e3b-1f201e26fdf7","original-request":"req_i3YFNI5I62ICuE","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_i3YFNI5I62ICuE","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"Not a valid URL","param":"business_profile[url]","requestId":"req_i3YFNI5I62ICuE","request_log_url":"https://dashboard.stripe.com/test/logs/req_i3YFNI5I62ICuE?t=1741708365","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_i3YFNI5I62ICuE","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Error creating Stripe account: Not a valid URL","service":"payment-service","timestamp":"2025-03-11 17:52:46"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-11 17:52:46"}
{"error":{"code":"url_invalid","doc_url":"https://stripe.com/docs/error-codes/url-invalid","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"319","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=VfMgaN6Jy4Oq6AaaUvMRt1HPPs-BVf9_uS6spxA3s4uea4b4gOsWUOLD0SScwy7ob_-U6dU3xkPA3edn","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Tue, 11 Mar 2025 15:54:09 GMT","idempotency-key":"bd1fa0ec-bb28-430b-82e2-94dba3fe5d11","original-request":"req_rtpXDBOdOCVrku","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_rtpXDBOdOCVrku","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"param":"business_profile[url]","raw":{"code":"url_invalid","doc_url":"https://stripe.com/docs/error-codes/url-invalid","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"319","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=VfMgaN6Jy4Oq6AaaUvMRt1HPPs-BVf9_uS6spxA3s4uea4b4gOsWUOLD0SScwy7ob_-U6dU3xkPA3edn","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Tue, 11 Mar 2025 15:54:09 GMT","idempotency-key":"bd1fa0ec-bb28-430b-82e2-94dba3fe5d11","original-request":"req_rtpXDBOdOCVrku","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_rtpXDBOdOCVrku","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"Not a valid URL","param":"business_profile[url]","requestId":"req_rtpXDBOdOCVrku","request_log_url":"https://dashboard.stripe.com/test/logs/req_rtpXDBOdOCVrku?t=1741708449","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_rtpXDBOdOCVrku","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Error creating Stripe account: Not a valid URL","service":"payment-service","timestamp":"2025-03-11 17:54:10"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-11 17:54:10"}
{"error":{"code":"url_invalid","doc_url":"https://stripe.com/docs/error-codes/url-invalid","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"319","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=xNsagmISNjhBM4nC3EFk1jN-lPLjCSx6U2wVLY8bYJ8NIcQOh7jM2UK06TVrzOQQMBCLDGfg7qTubXzt","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Tue, 11 Mar 2025 15:54:35 GMT","idempotency-key":"5afa560f-0a48-4859-8803-f6ee45066616","original-request":"req_5hTqMCWP3n9QZ3","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_5hTqMCWP3n9QZ3","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"param":"business_profile[url]","raw":{"code":"url_invalid","doc_url":"https://stripe.com/docs/error-codes/url-invalid","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"319","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=xNsagmISNjhBM4nC3EFk1jN-lPLjCSx6U2wVLY8bYJ8NIcQOh7jM2UK06TVrzOQQMBCLDGfg7qTubXzt","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Tue, 11 Mar 2025 15:54:35 GMT","idempotency-key":"5afa560f-0a48-4859-8803-f6ee45066616","original-request":"req_5hTqMCWP3n9QZ3","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_5hTqMCWP3n9QZ3","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"Not a valid URL","param":"business_profile[url]","requestId":"req_5hTqMCWP3n9QZ3","request_log_url":"https://dashboard.stripe.com/test/logs/req_5hTqMCWP3n9QZ3?t=1741708475","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_5hTqMCWP3n9QZ3","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Error creating Stripe account: Not a valid URL","service":"payment-service","timestamp":"2025-03-11 17:54:35"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-11 17:54:35"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-12 14:18:39"}
{"error":{"isOperational":true,"status":"fail","statusCode":404},"level":"error","message":"Error deleting educator account: Educator Stripe account not found","service":"payment-service","timestamp":"2025-03-12 14:20:14"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-12 14:20:14"}
{"error":{"isOperational":true,"status":"fail","statusCode":404},"level":"error","message":"Error deleting educator account: Educator Stripe account not found","service":"payment-service","timestamp":"2025-03-12 14:21:28"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-12 14:21:28"}
{"error":{"isOperational":true,"status":"fail","statusCode":400},"level":"error","message":"Payment processing error: Error happened","service":"payment-service","timestamp":"2025-03-12 14:57:10"}
{"level":"error","message":"Error processing payment: Payment processing failed: Error happened","service":"payment-service","timestamp":"2025-03-12 14:57:10"}
{"error":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"330","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=EGKHVeS8NPnBUjIZHR9XT2uCkv9gNOnQ_QkZ5vUuu-glS60SIAhjxlBadquYBrVyGxeTc4Utm7QtiKAY","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Wed, 12 Mar 2025 12:58:40 GMT","idempotency-key":"ae407bb0-7bc4-413a-92ed-5d4ab1495b33","original-request":"req_mCSABGWmhZgloK","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_mCSABGWmhZgloK","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"raw":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"330","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=EGKHVeS8NPnBUjIZHR9XT2uCkv9gNOnQ_QkZ5vUuu-glS60SIAhjxlBadquYBrVyGxeTc4Utm7QtiKAY","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Wed, 12 Mar 2025 12:58:40 GMT","idempotency-key":"ae407bb0-7bc4-413a-92ed-5d4ab1495b33","original-request":"req_mCSABGWmhZgloK","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_mCSABGWmhZgloK","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"You cannot accept the Terms of Service on behalf of accounts where `controller[requirement_collection]=stripe`, which includes Standard and Express accounts.","requestId":"req_mCSABGWmhZgloK","request_log_url":"https://dashboard.stripe.com/test/logs/req_mCSABGWmhZgloK?t=1741784320","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_mCSABGWmhZgloK","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Error creating Stripe account: You cannot accept the Terms of Service on behalf of accounts where `controller[requirement_collection]=stripe`, which includes Standard and Express accounts.","service":"payment-service","timestamp":"2025-03-12 14:58:41"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-12 14:58:41"}
{"error":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"352","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=AI-AyViINQcT19JM3qLK3esSRDFyuJuCIguParCrX0sKMsnoG_4WAhD8cF7RNhm_ryl-WTX9D0EEcwXV","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Wed, 12 Mar 2025 13:08:11 GMT","idempotency-key":"ac8f918b-5aa5-4ab3-908b-d49a3847c9ea","original-request":"req_4W3igs5xj15rOG","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_4W3igs5xj15rOG","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-account":"acct_1R1p10PfYq6iycrh","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"raw":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"352","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=AI-AyViINQcT19JM3qLK3esSRDFyuJuCIguParCrX0sKMsnoG_4WAhD8cF7RNhm_ryl-WTX9D0EEcwXV","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Wed, 12 Mar 2025 13:08:11 GMT","idempotency-key":"ac8f918b-5aa5-4ab3-908b-d49a3847c9ea","original-request":"req_4W3igs5xj15rOG","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_4W3igs5xj15rOG","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-account":"acct_1R1p10PfYq6iycrh","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"You cannot accept the Terms of Service on behalf of accounts where `controller[requirement_collection]=stripe`, which includes Standard and Express accounts.","requestId":"req_4W3igs5xj15rOG","request_log_url":"https://dashboard.stripe.com/acct_1R1p10PfYq6iycrh/test/logs/req_4W3igs5xj15rOG?t=1741784890","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_4W3igs5xj15rOG","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Error creating Stripe account: You cannot accept the Terms of Service on behalf of accounts where `controller[requirement_collection]=stripe`, which includes Standard and Express accounts.","service":"payment-service","timestamp":"2025-03-12 15:08:12"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-12 15:08:12"}
{"error":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"352","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=Xt_1bBSrPfUKZWS49YeOO2ce1c4g_GcHyAVfuFjSQeFAcY_fisNYE3LCOLVWM0djQXtDtLxdMkfYcq-d","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Wed, 12 Mar 2025 13:10:02 GMT","idempotency-key":"41346e8f-8964-4d67-897c-37a1fd9948e6","original-request":"req_Va4U5xnXU7hqts","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_Va4U5xnXU7hqts","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-account":"acct_1R1p2dB1KKzvBTJW","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"raw":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"352","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=Xt_1bBSrPfUKZWS49YeOO2ce1c4g_GcHyAVfuFjSQeFAcY_fisNYE3LCOLVWM0djQXtDtLxdMkfYcq-d","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Wed, 12 Mar 2025 13:10:02 GMT","idempotency-key":"41346e8f-8964-4d67-897c-37a1fd9948e6","original-request":"req_Va4U5xnXU7hqts","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_Va4U5xnXU7hqts","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-account":"acct_1R1p2dB1KKzvBTJW","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"You cannot accept the Terms of Service on behalf of accounts where `controller[requirement_collection]=stripe`, which includes Standard and Express accounts.","requestId":"req_Va4U5xnXU7hqts","request_log_url":"https://dashboard.stripe.com/acct_1R1p2dB1KKzvBTJW/test/logs/req_Va4U5xnXU7hqts?t=1741785002","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_Va4U5xnXU7hqts","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Error creating Stripe account: You cannot accept the Terms of Service on behalf of accounts where `controller[requirement_collection]=stripe`, which includes Standard and Express accounts.","service":"payment-service","timestamp":"2025-03-12 15:11:12"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-12 15:11:18"}
{"error":{"code":"resource_missing","doc_url":"https://stripe.com/docs/error-codes/resource-missing","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"344","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=tGHAFLqXe-59qv_bKT1HxCHgtmSSVzRXceGDhAB4-MwFuEvoYj-MEh4I2-CruZtOz62Ho5UPZ9L1XcSv","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Wed, 12 Mar 2025 13:15:35 GMT","idempotency-key":"ca3b6088-36c8-4c37-8f6a-db88c1e7c06b","original-request":"req_eOBgDSYYfl0WUr","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_eOBgDSYYfl0WUr","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"param":"destination","raw":{"code":"resource_missing","doc_url":"https://stripe.com/docs/error-codes/resource-missing","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"344","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=tGHAFLqXe-59qv_bKT1HxCHgtmSSVzRXceGDhAB4-MwFuEvoYj-MEh4I2-CruZtOz62Ho5UPZ9L1XcSv","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Wed, 12 Mar 2025 13:15:35 GMT","idempotency-key":"ca3b6088-36c8-4c37-8f6a-db88c1e7c06b","original-request":"req_eOBgDSYYfl0WUr","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_eOBgDSYYfl0WUr","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"No such account: 'acct_1R1ovJPbFNshYDFw'","param":"destination","requestId":"req_eOBgDSYYfl0WUr","request_log_url":"https://dashboard.stripe.com/test/logs/req_eOBgDSYYfl0WUr?t=1741785335","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_eOBgDSYYfl0WUr","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Payment processing error: No such account: 'acct_1R1ovJPbFNshYDFw'","service":"payment-service","timestamp":"2025-03-12 15:15:36"}
{"level":"error","message":"Error processing payment: Payment processing failed: No such account: 'acct_1R1ovJPbFNshYDFw'","service":"payment-service","timestamp":"2025-03-12 15:15:36"}
{"error":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"253","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=BgXDUD3jHfznnjiOFYUDf2cdzJ2NzLZk-rUqsp7VKiC2K5j65S87e86WZkWbJYkxo-PM0Txk-_z0NNRR","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Wed, 12 Mar 2025 13:18:20 GMT","idempotency-key":"2d3e513d-9729-487a-8b58-bab9c62310fe","original-request":"req_2K959EsLKIEV3t","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_2K959EsLKIEV3t","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"raw":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"253","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=BgXDUD3jHfznnjiOFYUDf2cdzJ2NzLZk-rUqsp7VKiC2K5j65S87e86WZkWbJYkxo-PM0Txk-_z0NNRR","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Wed, 12 Mar 2025 13:18:20 GMT","idempotency-key":"2d3e513d-9729-487a-8b58-bab9c62310fe","original-request":"req_2K959EsLKIEV3t","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_2K959EsLKIEV3t","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"Only one of `application_fee_amount` and `destination[amount]` can be specified.","requestId":"req_2K959EsLKIEV3t","request_log_url":"https://dashboard.stripe.com/test/logs/req_2K959EsLKIEV3t?t=1741785500","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_2K959EsLKIEV3t","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Payment processing error: Only one of `application_fee_amount` and `destination[amount]` can be specified.","service":"payment-service","timestamp":"2025-03-12 15:18:21"}
{"level":"error","message":"Error processing payment: Payment processing failed: Only one of `application_fee_amount` and `destination[amount]` can be specified.","service":"payment-service","timestamp":"2025-03-12 15:18:21"}
{"error":{"code":"insufficient_capabilities_for_transfer","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"362","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=eTYAZ4oWcMvt1TQKoE7kQRS7Iyq7qZ9aRDz7Ci5M7L7q-qNcMX-nUgKgxxWHGPc6qOhzi_hof6SkBLyo","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Wed, 12 Mar 2025 13:20:18 GMT","idempotency-key":"29389b05-d152-4cfd-97f7-1ed9a2a27231","original-request":"req_3JaylMvLbaLHkP","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_3JaylMvLbaLHkP","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"raw":{"code":"insufficient_capabilities_for_transfer","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"362","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=eTYAZ4oWcMvt1TQKoE7kQRS7Iyq7qZ9aRDz7Ci5M7L7q-qNcMX-nUgKgxxWHGPc6qOhzi_hof6SkBLyo","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Wed, 12 Mar 2025 13:20:18 GMT","idempotency-key":"29389b05-d152-4cfd-97f7-1ed9a2a27231","original-request":"req_3JaylMvLbaLHkP","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_3JaylMvLbaLHkP","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"Your destination account needs to have at least one of the following capabilities enabled: transfers, crypto_transfers, legacy_payments","requestId":"req_3JaylMvLbaLHkP","request_log_url":"https://dashboard.stripe.com/test/logs/req_3JaylMvLbaLHkP?t=1741785618","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_3JaylMvLbaLHkP","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Payment processing error: Your destination account needs to have at least one of the following capabilities enabled: transfers, crypto_transfers, legacy_payments","service":"payment-service","timestamp":"2025-03-12 15:20:19"}
{"level":"error","message":"Error processing payment: Payment processing failed: Your destination account needs to have at least one of the following capabilities enabled: transfers, crypto_transfers, legacy_payments","service":"payment-service","timestamp":"2025-03-12 15:20:19"}
{"error":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"324","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=lMuWavtWO1Cc0hCXZK5qXE6CY0QzKQ0S_xpepFV3o9UWA967nENtRs5H1H58NPstioXFfp8UFU38Wugv","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Wed, 12 Mar 2025 13:32:02 GMT","idempotency-key":"5bb3eebe-2773-4c2e-8635-e0ad5aeca5a1","original-request":"req_MWX8kEFCKizPy2","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_MWX8kEFCKizPy2","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"raw":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"324","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=lMuWavtWO1Cc0hCXZK5qXE6CY0QzKQ0S_xpepFV3o9UWA967nENtRs5H1H58NPstioXFfp8UFU38Wugv","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Wed, 12 Mar 2025 13:32:02 GMT","idempotency-key":"5bb3eebe-2773-4c2e-8635-e0ad5aeca5a1","original-request":"req_MWX8kEFCKizPy2","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_MWX8kEFCKizPy2","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"Please review the responsibilities of collecting requirements for connected accounts at https://dashboard.stripe.com/settings/connect/platform-profile.","requestId":"req_MWX8kEFCKizPy2","request_log_url":"https://dashboard.stripe.com/test/logs/req_MWX8kEFCKizPy2?t=1741786321","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_MWX8kEFCKizPy2","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Error creating Stripe account: Please review the responsibilities of collecting requirements for connected accounts at https://dashboard.stripe.com/settings/connect/platform-profile.","service":"payment-service","timestamp":"2025-03-12 15:32:03"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-12 15:32:03"}
{"error":{"clientVersion":"6.4.1","code":"P2002","meta":{"modelName":"stripeAccount","target":["educatorId"]},"name":"PrismaClientKnownRequestError"},"level":"error","message":"Error creating Stripe account: \nInvalid `prisma.stripeAccount.create()` invocation in\nC:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\payoutService.js:601:62\n\n  598   }\n  599 );\n  600 \n→ 601 const educatorStripeAccount = await prisma.stripeAccount.create(\nUnique constraint failed on the fields: (`educatorId`)","service":"payment-service","timestamp":"2025-03-12 15:56:03"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-12 15:56:03"}
{"error":{"code":"url_invalid","doc_url":"https://stripe.com/docs/error-codes/url-invalid","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"319","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=rAEd74QYqOXKneapX4roiZAZ8Bou0USEUPf3PV_nrMbGhtHJpBjCUoMVdNOi1TmmdJ1ss3cevSMh-QjB","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Wed, 12 Mar 2025 14:08:20 GMT","idempotency-key":"1b22d605-14d2-45f2-9e26-acae562b373d","original-request":"req_pQWgvSrvCW6L7N","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_pQWgvSrvCW6L7N","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"param":"business_profile[url]","raw":{"code":"url_invalid","doc_url":"https://stripe.com/docs/error-codes/url-invalid","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"319","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=rAEd74QYqOXKneapX4roiZAZ8Bou0USEUPf3PV_nrMbGhtHJpBjCUoMVdNOi1TmmdJ1ss3cevSMh-QjB","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Wed, 12 Mar 2025 14:08:20 GMT","idempotency-key":"1b22d605-14d2-45f2-9e26-acae562b373d","original-request":"req_pQWgvSrvCW6L7N","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_pQWgvSrvCW6L7N","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"Not a valid URL","param":"business_profile[url]","requestId":"req_pQWgvSrvCW6L7N","request_log_url":"https://dashboard.stripe.com/test/logs/req_pQWgvSrvCW6L7N?t=1741788500","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_pQWgvSrvCW6L7N","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Error creating Stripe account: Not a valid URL","service":"payment-service","timestamp":"2025-03-12 16:08:21"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-12 16:08:21"}
{"error":{"code":"url_invalid","doc_url":"https://stripe.com/docs/error-codes/url-invalid","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"319","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=rAEd74QYqOXKneapX4roiZAZ8Bou0USEUPf3PV_nrMbGhtHJpBjCUoMVdNOi1TmmdJ1ss3cevSMh-QjB","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Wed, 12 Mar 2025 14:08:50 GMT","idempotency-key":"6cadd337-4568-42ec-a8a9-08780c363869","original-request":"req_ennWU3qG5sp49F","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_ennWU3qG5sp49F","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"param":"business_profile[url]","raw":{"code":"url_invalid","doc_url":"https://stripe.com/docs/error-codes/url-invalid","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"319","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=rAEd74QYqOXKneapX4roiZAZ8Bou0USEUPf3PV_nrMbGhtHJpBjCUoMVdNOi1TmmdJ1ss3cevSMh-QjB","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Wed, 12 Mar 2025 14:08:50 GMT","idempotency-key":"6cadd337-4568-42ec-a8a9-08780c363869","original-request":"req_ennWU3qG5sp49F","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_ennWU3qG5sp49F","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"Not a valid URL","param":"business_profile[url]","requestId":"req_ennWU3qG5sp49F","request_log_url":"https://dashboard.stripe.com/test/logs/req_ennWU3qG5sp49F?t=1741788530","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_ennWU3qG5sp49F","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Error creating Stripe account: Not a valid URL","service":"payment-service","timestamp":"2025-03-12 16:08:51"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-12 16:08:51"}
{"error":{"code":"parameter_unknown","doc_url":"https://stripe.com/docs/error-codes/parameter-unknown","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"381","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=lMuWavtWO1Cc0hCXZK5qXE6CY0QzKQ0S_xpepFV3o9UWA967nENtRs5H1H58NPstioXFfp8UFU38Wugv","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Wed, 12 Mar 2025 14:09:18 GMT","idempotency-key":"5d0dc5c8-346a-4d96-b28d-0dc82c98021c","original-request":"req_JrBPkhgJMiZbms","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_JrBPkhgJMiZbms","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"param":"business_profile[description]","raw":{"code":"parameter_unknown","doc_url":"https://stripe.com/docs/error-codes/parameter-unknown","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"381","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=lMuWavtWO1Cc0hCXZK5qXE6CY0QzKQ0S_xpepFV3o9UWA967nENtRs5H1H58NPstioXFfp8UFU38Wugv","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Wed, 12 Mar 2025 14:09:18 GMT","idempotency-key":"5d0dc5c8-346a-4d96-b28d-0dc82c98021c","original-request":"req_JrBPkhgJMiZbms","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_JrBPkhgJMiZbms","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"Received unknown parameter: business_profile[description]","param":"business_profile[description]","requestId":"req_JrBPkhgJMiZbms","request_log_url":"https://dashboard.stripe.com/test/logs/req_JrBPkhgJMiZbms?t=1741788557","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_JrBPkhgJMiZbms","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Error creating Stripe account: Received unknown parameter: business_profile[description]","service":"payment-service","timestamp":"2025-03-12 16:09:18"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-12 16:09:18"}
{"error":{"clientVersion":"6.4.1","code":"P2002","meta":{"modelName":"stripeAccount","target":["educatorId"]},"name":"PrismaClientKnownRequestError"},"level":"error","message":"Error creating Stripe account: \nInvalid `prisma.stripeAccount.create()` invocation in\nC:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\payoutService.js:630:62\n\n  627   }\n  628 );\n  629 \n→ 630 const educatorStripeAccount = await prisma.stripeAccount.create(\nUnique constraint failed on the fields: (`educatorId`)","service":"payment-service","timestamp":"2025-03-12 16:09:49"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-12 16:09:49"}
{"error":{"clientVersion":"6.4.1","code":"P2002","meta":{"modelName":"stripeAccount","target":["educatorId"]},"name":"PrismaClientKnownRequestError"},"level":"error","message":"Error creating Stripe account: \nInvalid `prisma.stripeAccount.create()` invocation in\nC:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\payoutService.js:631:62\n\n  628   }\n  629 );\n  630 \n→ 631 const educatorStripeAccount = await prisma.stripeAccount.create(\nUnique constraint failed on the fields: (`educatorId`)","service":"payment-service","timestamp":"2025-03-12 16:16:40"}
{"0":"r","1":"e","2":"a","3":"s","4":"o","5":"n","6":":","level":"error","message":"Unhandled Rejection at:","service":"payment-service","timestamp":"2025-03-12 16:16:40"}
{"data":{"action":"ENROLL_USER","courseId":"1","transactionId":"b3b39119-eb20-4a9c-be1d-590cfcfe7cf5","userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"mock-user-id\",\"action\":\"ENROLL_USER\",\"courseId\":\"1\",\"transactionId\":\"b3b39119-eb20-4a9c-be1d-590cfcfe7cf5\"}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"118","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:117:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-12 16:19:39"}
{"data":{"action":"RECORD_PURCHASE","amount":100,"courseId":"1","educatorEarnings":80,"userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"courseId\":\"1\",\"action\":\"RECORD_PURCHASE\",\"userId\":\"mock-user-id\",\"amount\":100,\"educatorEarnings\":80}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"102","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3002/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3002","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3002\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyCourseService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:41:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:125:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify course service: connect ECONNREFUSED ::1:3002","service":"payment-service","timestamp":"2025-03-12 16:19:39"}
{"data":{"action":"NEW_EARNINGS","data":{"amount":80,"courseId":"1","totalPendingEarnings":80,"transactionId":"b3b39119-eb20-4a9c-be1d-590cfcfe7cf5"},"userId":"edu_123"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"edu_123\",\"action\":\"NEW_EARNINGS\",\"data\":{\"courseId\":\"1\",\"transactionId\":\"b3b39119-eb20-4a9c-be1d-590cfcfe7cf5\",\"amount\":80,\"totalPendingEarnings\":80}}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"161","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:134:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-12 16:19:39"}
{"data":{"action":"ENROLL_USER","courseId":"2","transactionId":"4bd46fd7-d432-4125-825f-43b3f65b7c95","userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"mock-user-id\",\"action\":\"ENROLL_USER\",\"courseId\":\"2\",\"transactionId\":\"4bd46fd7-d432-4125-825f-43b3f65b7c95\"}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"118","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:117:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-12 16:22:44"}
{"data":{"action":"RECORD_PURCHASE","amount":100,"courseId":"2","educatorEarnings":80,"userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"courseId\":\"2\",\"action\":\"RECORD_PURCHASE\",\"userId\":\"mock-user-id\",\"amount\":100,\"educatorEarnings\":80}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"102","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3002/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3002","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3002\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyCourseService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:41:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:125:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify course service: connect ECONNREFUSED ::1:3002","service":"payment-service","timestamp":"2025-03-12 16:22:44"}
{"data":{"action":"NEW_EARNINGS","data":{"amount":80,"courseId":"2","totalPendingEarnings":160,"transactionId":"4bd46fd7-d432-4125-825f-43b3f65b7c95"},"userId":"edu_123"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"edu_123\",\"action\":\"NEW_EARNINGS\",\"data\":{\"courseId\":\"2\",\"transactionId\":\"4bd46fd7-d432-4125-825f-43b3f65b7c95\",\"amount\":80,\"totalPendingEarnings\":160}}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"162","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:134:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-12 16:22:44"}
{"level":"error","message":"Error calculating commission: commissionAmount is not defined","service":"payment-service","timestamp":"2025-03-12 16:53:44"}
{"error":{},"level":"error","message":"Payment processing error: platformCommission is not defined","service":"payment-service","timestamp":"2025-03-12 16:53:44"}
{"level":"error","message":"Error processing payment: Payment processing failed: platformCommission is not defined","service":"payment-service","timestamp":"2025-03-12 16:53:44"}
{"error":{"detail":{"code":"ETIMEDOUT"},"raw":{"detail":{"code":"ETIMEDOUT"},"message":"Request aborted due to timeout being reached (80000ms)"},"type":"StripeConnectionError"},"level":"error","message":"Payment processing error: Request aborted due to timeout being reached (80000ms)","service":"payment-service","timestamp":"2025-03-12 16:57:48"}
{"level":"error","message":"Error processing payment: Payment processing failed: Request aborted due to timeout being reached (80000ms)","service":"payment-service","timestamp":"2025-03-12 16:57:48"}
{"level":"error","message":"Error calculating commission: Assignment to constant variable.","service":"payment-service","timestamp":"2025-03-12 17:01:57"}
{"error":{"code":"resource_missing","doc_url":"https://stripe.com/docs/error-codes/resource-missing","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"548","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=zBEfSBedeHaOeTRG_-AEXJGQ7aNP3PiDyadowW36ioVpy3g7O5p5KzsgTcpp_OIOq6kJJ_QdWn1JoFDA","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Wed, 12 Mar 2025 15:02:16 GMT","idempotency-key":"02d14d00-6013-4a72-81c7-fc9351781541","original-request":"req_mlQg9ws9QNJ5if","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_mlQg9ws9QNJ5if","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"param":"payment_method","raw":{"code":"resource_missing","doc_url":"https://stripe.com/docs/error-codes/resource-missing","headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"548","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=zBEfSBedeHaOeTRG_-AEXJGQ7aNP3PiDyadowW36ioVpy3g7O5p5KzsgTcpp_OIOq6kJJ_QdWn1JoFDA","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Wed, 12 Mar 2025 15:02:16 GMT","idempotency-key":"02d14d00-6013-4a72-81c7-fc9351781541","original-request":"req_mlQg9ws9QNJ5if","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_mlQg9ws9QNJ5if","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"No such PaymentMethod: 'tok_visa'; It's possible this PaymentMethod exists on one of your connected accounts, in which case you should retry this request on that connected account. Learn more at https://stripe.com/docs/connect/authentication","param":"payment_method","requestId":"req_mlQg9ws9QNJ5if","request_log_url":"https://dashboard.stripe.com/test/logs/req_mlQg9ws9QNJ5if?t=1741791736","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_mlQg9ws9QNJ5if","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Payment processing error: No such PaymentMethod: 'tok_visa'; It's possible this PaymentMethod exists on one of your connected accounts, in which case you should retry this request on that connected account. Learn more at https://stripe.com/docs/connect/authentication","service":"payment-service","timestamp":"2025-03-12 17:02:17"}
{"level":"error","message":"Error processing payment: Payment processing failed: No such PaymentMethod: 'tok_visa'; It's possible this PaymentMethod exists on one of your connected accounts, in which case you should retry this request on that connected account. Learn more at https://stripe.com/docs/connect/authentication","service":"payment-service","timestamp":"2025-03-12 17:02:17"}
{"data":{"action":"ENROLL_USER","courseId":"3","transactionId":"7bcf181c-5cc4-420c-93df-29b35d71bcea","userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"mock-user-id\",\"action\":\"ENROLL_USER\",\"courseId\":\"3\",\"transactionId\":\"7bcf181c-5cc4-420c-93df-29b35d71bcea\"}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"118","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:116:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-12 17:03:18"}
{"data":{"action":"RECORD_PURCHASE","amount":100,"courseId":"3","educatorEarnings":78,"userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"courseId\":\"3\",\"action\":\"RECORD_PURCHASE\",\"userId\":\"mock-user-id\",\"amount\":100,\"educatorEarnings\":78}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"102","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3002/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3002","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3002\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyCourseService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:41:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:124:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify course service: connect ECONNREFUSED ::1:3002","service":"payment-service","timestamp":"2025-03-12 17:03:18"}
{"data":{"action":"NEW_EARNINGS","data":{"amount":78,"courseId":"3","totalPendingEarnings":238,"transactionId":"7bcf181c-5cc4-420c-93df-29b35d71bcea"},"userId":"edu_123"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"edu_123\",\"action\":\"NEW_EARNINGS\",\"data\":{\"courseId\":\"3\",\"transactionId\":\"7bcf181c-5cc4-420c-93df-29b35d71bcea\",\"amount\":78,\"totalPendingEarnings\":238}}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"162","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:133:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-12 17:03:18"}
{"error":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"2866","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=eTYAZ4oWcMvt1TQKoE7kQRS7Iyq7qZ9aRDz7Ci5M7L7q-qNcMX-nUgKgxxWHGPc6qOhzi_hof6SkBLyo","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Wed, 12 Mar 2025 15:07:44 GMT","idempotency-key":"bc46af27-7219-455a-8d10-d269071958ff","original-request":"req_paI4AHA8xIYVhV","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_paI4AHA8xIYVhV","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"payment_intent":{"amount":10000,"amount_capturable":0,"amount_details":{"tip":{}},"amount_received":0,"application":null,"application_fee_amount":1900,"automatic_payment_methods":{"allow_redirects":"always","enabled":true},"canceled_at":null,"cancellation_reason":null,"capture_method":"automatic","client_secret":"pi_3R1qsmBLtTuFPq2g4k4Nyrld_secret_MICcoXGGncQmNRWkkgTBtqjky","confirmation_method":"automatic","created":1741792064,"currency":"usd","customer":null,"description":"Payment for course","id":"pi_3R1qsmBLtTuFPq2g4k4Nyrld","invoice":null,"last_payment_error":null,"latest_charge":null,"livemode":false,"metadata":{"courseId":"6","educatorId":"edu_123","userId":"mock-user-id"},"next_action":null,"object":"payment_intent","on_behalf_of":null,"payment_method":"pm_1R1qsmBLtTuFPq2gLvtaMcD6","payment_method_configuration_details":{"id":"pmc_1R0nX4BLtTuFPq2gRzQqIDox","parent":null},"payment_method_options":{"affirm":{},"amazon_pay":{"express_checkout_element_session_id":null},"card":{"installments":null,"mandate_options":null,"network":null,"request_three_d_secure":"automatic"},"cashapp":{},"klarna":{"preferred_locale":null},"link":{"persistent_token":null}},"payment_method_types":["card","klarna","link","affirm","cashapp","amazon_pay"],"processing":null,"receipt_email":null,"review":null,"setup_future_usage":null,"shipping":null,"source":null,"statement_descriptor":null,"statement_descriptor_suffix":null,"status":"requires_confirmation","transfer_data":{"destination":"acct_1R1q5cPhf90cniis"},"transfer_group":null},"raw":{"headers":{"access-control-allow-credentials":"true","access-control-allow-methods":"GET, HEAD, PUT, PATCH, POST, DELETE","access-control-allow-origin":"*","access-control-expose-headers":"Request-Id, Stripe-Manage-Version, Stripe-Should-Retry, X-Stripe-External-Auth-Required, X-Stripe-Privileged-Session-Required","access-control-max-age":"300","cache-control":"no-cache, no-store","connection":"keep-alive","content-length":"2866","content-security-policy":"base-uri 'none'; default-src 'none'; form-action 'none'; frame-ancestors 'none'; img-src 'self'; script-src 'self' 'report-sample'; style-src 'self'; worker-src 'none'; upgrade-insecure-requests; report-uri https://q.stripe.com/csp-violation?q=eTYAZ4oWcMvt1TQKoE7kQRS7Iyq7qZ9aRDz7Ci5M7L7q-qNcMX-nUgKgxxWHGPc6qOhzi_hof6SkBLyo","content-type":"application/json","cross-origin-opener-policy-report-only":"same-origin; report-to=\"coop\"","date":"Wed, 12 Mar 2025 15:07:44 GMT","idempotency-key":"bc46af27-7219-455a-8d10-d269071958ff","original-request":"req_paI4AHA8xIYVhV","report-to":"{\"group\":\"coop\",\"max_age\":8640,\"endpoints\":[{\"url\":\"https://q.stripe.com/coop-report\"}],\"include_subdomains\":true}","reporting-endpoints":"coop=\"https://q.stripe.com/coop-report\"","request-id":"req_paI4AHA8xIYVhV","server":"nginx","strict-transport-security":"max-age=63072000; includeSubDomains; preload","stripe-should-retry":"false","stripe-version":"2023-10-16","vary":"Origin","x-stripe-priority-routing-enabled":"true","x-stripe-routing-context-priority-tier":"api-testmode","x-wc":"AB"},"message":"This PaymentIntent is configured to accept payment methods enabled in your Dashboard. Because some of these payment methods might redirect your customer off of your page, you must provide a `return_url`. If you don't want to accept redirect-based payment methods, set `automatic_payment_methods[enabled]` to `true` and `automatic_payment_methods[allow_redirects]` to `never` when creating Setup Intents and Payment Intents.","payment_intent":{"amount":10000,"amount_capturable":0,"amount_details":{"tip":{}},"amount_received":0,"application":null,"application_fee_amount":1900,"automatic_payment_methods":{"allow_redirects":"always","enabled":true},"canceled_at":null,"cancellation_reason":null,"capture_method":"automatic","client_secret":"pi_3R1qsmBLtTuFPq2g4k4Nyrld_secret_MICcoXGGncQmNRWkkgTBtqjky","confirmation_method":"automatic","created":1741792064,"currency":"usd","customer":null,"description":"Payment for course","id":"pi_3R1qsmBLtTuFPq2g4k4Nyrld","invoice":null,"last_payment_error":null,"latest_charge":null,"livemode":false,"metadata":{"courseId":"6","educatorId":"edu_123","userId":"mock-user-id"},"next_action":null,"object":"payment_intent","on_behalf_of":null,"payment_method":"pm_1R1qsmBLtTuFPq2gLvtaMcD6","payment_method_configuration_details":{"id":"pmc_1R0nX4BLtTuFPq2gRzQqIDox","parent":null},"payment_method_options":{"affirm":{},"amazon_pay":{"express_checkout_element_session_id":null},"card":{"installments":null,"mandate_options":null,"network":null,"request_three_d_secure":"automatic"},"cashapp":{},"klarna":{"preferred_locale":null},"link":{"persistent_token":null}},"payment_method_types":["card","klarna","link","affirm","cashapp","amazon_pay"],"processing":null,"receipt_email":null,"review":null,"setup_future_usage":null,"shipping":null,"source":null,"statement_descriptor":null,"statement_descriptor_suffix":null,"status":"requires_confirmation","transfer_data":{"destination":"acct_1R1q5cPhf90cniis"},"transfer_group":null},"requestId":"req_paI4AHA8xIYVhV","request_log_url":"https://dashboard.stripe.com/test/logs/req_paI4AHA8xIYVhV?t=1741792064","statusCode":400,"type":"invalid_request_error"},"rawType":"invalid_request_error","requestId":"req_paI4AHA8xIYVhV","statusCode":400,"type":"StripeInvalidRequestError"},"level":"error","message":"Payment processing error: This PaymentIntent is configured to accept payment methods enabled in your Dashboard. Because some of these payment methods might redirect your customer off of your page, you must provide a `return_url`. If you don't want to accept redirect-based payment methods, set `automatic_payment_methods[enabled]` to `true` and `automatic_payment_methods[allow_redirects]` to `never` when creating Setup Intents and Payment Intents.","service":"payment-service","timestamp":"2025-03-12 17:07:45"}
{"level":"error","message":"Error processing payment: Payment processing failed: This PaymentIntent is configured to accept payment methods enabled in your Dashboard. Because some of these payment methods might redirect your customer off of your page, you must provide a `return_url`. If you don't want to accept redirect-based payment methods, set `automatic_payment_methods[enabled]` to `true` and `automatic_payment_methods[allow_redirects]` to `never` when creating Setup Intents and Payment Intents.","service":"payment-service","timestamp":"2025-03-12 17:07:45"}
{"data":{"action":"ENROLL_USER","courseId":"6","transactionId":"3700b937-8b88-4752-aa21-acd8f9509c56","userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"mock-user-id\",\"action\":\"ENROLL_USER\",\"courseId\":\"6\",\"transactionId\":\"3700b937-8b88-4752-aa21-acd8f9509c56\"}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"118","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:122:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-12 17:11:39"}
{"data":{"action":"RECORD_PURCHASE","amount":100,"courseId":"6","educatorEarnings":78,"userId":"mock-user-id"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"courseId\":\"6\",\"action\":\"RECORD_PURCHASE\",\"userId\":\"mock-user-id\",\"amount\":100,\"educatorEarnings\":78}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"102","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3002/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3002","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3002\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyCourseService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:41:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:130:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify course service: connect ECONNREFUSED ::1:3002","service":"payment-service","timestamp":"2025-03-12 17:11:39"}
{"data":{"action":"NEW_EARNINGS","data":{"amount":78,"courseId":"6","totalPendingEarnings":78,"transactionId":"3700b937-8b88-4752-aa21-acd8f9509c56"},"userId":"edu_123"},"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"allowAbsoluteUrls":true,"data":"{\"userId\":\"edu_123\",\"action\":\"NEW_EARNINGS\",\"data\":{\"courseId\":\"6\",\"transactionId\":\"3700b937-8b88-4752-aa21-acd8f9509c56\",\"amount\":78,\"totalPendingEarnings\":78}}","env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","Content-Length":"161","Content-Type":"application/json","User-Agent":"axios/1.8.1"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost:3001/api/api/notifications","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"connect ECONNREFUSED ::1:3001","name":"Error","stack":"Error: connect ECONNREFUSED ::1:3001\n    at AxiosError.from (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:857:14)\n    at RedirectableRequest.handleRequestError (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:3169:25)\n    at RedirectableRequest.emit (node:events:524:28)\n    at eventHandlers.<computed> (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\follow-redirects\\index.js:49:24)\n    at ClientRequest.emit (node:events:524:28)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:512:5)\n    at Socket.emit (node:events:524:28)\n    at emitErrorNT (node:internal/streams/destroy:170:8)\n    at emitErrorCloseNT (node:internal/streams/destroy:129:3)\n    at Axios.request (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\node_modules\\axios\\dist\\node\\axios.cjs:4258:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async notifyUserService (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\utils\\serviceNotifier.js:14:5)\n    at async Object.processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\services\\paymentService.js:139:5)\n    at async processPayment (C:\\Users\\Brilliant\\Desktop\\Nodejs\\FinalProject\\payment-service\\src\\controllers\\paymentController.js:8:20)"},"level":"error","message":"Failed to notify user service: connect ECONNREFUSED ::1:3001","service":"payment-service","timestamp":"2025-03-12 17:11:40"}
